<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Node系列-fs · 花田半亩</title><meta name="description" content="Node系列-fs - 文顶顶"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/logo.jpeg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://weibo.com/u/3800117445/atom.xml" title="花田半亩"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/鲸鱼.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">文顶顶的BLOG</a></li><li class="nav-list-item"><a href="/tags/" target="_self" class="nav-list-link">标签</a></li><li class="nav-list-item"><a href="https://www.cnblogs.com/wendingding/" target="_blank" class="nav-list-link">博客园</a></li><li class="nav-list-item"><a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place" target="_blank" class="nav-list-link">微博</a></li><li class="nav-list-item"><a href="http://blog.sina.com.cn/u/1910914290" target="_blank" class="nav-list-link">花田半亩</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Node系列-fs</h1><div class="post-info">Dec 1, 2018<span class="post-count"></span> ✧ 字数统计:1,135(字) &nbsp;&nbsp; ♨︎ 阅读时长:5(分钟)</div><div class="post-content"><div class="tip">本文对Node的内置模块fs进行介绍，包括模块的基本情况和简单使用。</div>

<h4 id="1-0-模块的内容"><a href="#1-0-模块的内容" class="headerlink" title="1.0 模块的内容"></a>1.0 模块的内容</h4><p><a href="https://nodejs.org/dist/latest-v10.x/docs/api/fs.html" target="_blank" rel="noopener">fs文件模块(File System)</a>是Node的内置核心模块之一，代码中可以通过<code>var fs = require(&quot;fs&quot;)</code>直接加载和使用，该模块提供了操作文件系统的诸多API，且所有方法均提供了<strong>同步</strong>和<strong>异步</strong>操作两个版本。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">wendingding$ node </span><br><span class="line">&gt; fs</span><br><span class="line">&#123; <span class="attr">constants</span>: &#123; ··省略··· &#125;,</span><br><span class="line">  Stats: [<span class="built_in">Function</span>: Stats],</span><br><span class="line">  F_OK: <span class="number">0</span>,</span><br><span class="line">  R_OK: <span class="number">4</span>,</span><br><span class="line">  W_OK: <span class="number">2</span>,</span><br><span class="line">  X_OK: <span class="number">1</span>,</span><br><span class="line">  access: [<span class="built_in">Function</span>],</span><br><span class="line">  accessSync: [<span class="built_in">Function</span>],</span><br><span class="line">  exists: [<span class="built_in">Function</span>],</span><br><span class="line">  existsSync: [<span class="built_in">Function</span>],</span><br><span class="line">  readFile: [<span class="built_in">Function</span>],</span><br><span class="line">  readFileSync: [<span class="built_in">Function</span>],</span><br><span class="line">  close: [<span class="built_in">Function</span>],</span><br><span class="line">  closeSync: [<span class="built_in">Function</span>],</span><br><span class="line">  open: [<span class="built_in">Function</span>],</span><br><span class="line">  openSync: [<span class="built_in">Function</span>],</span><br><span class="line">  read: [<span class="built_in">Function</span>],</span><br><span class="line">  readSync: [<span class="built_in">Function</span>],</span><br><span class="line">  write: [<span class="built_in">Function</span>],</span><br><span class="line">  writeSync: [<span class="built_in">Function</span>],</span><br><span class="line">  rename: [<span class="built_in">Function</span>],</span><br><span class="line">  renameSync: [<span class="built_in">Function</span>],</span><br><span class="line">  truncate: [<span class="built_in">Function</span>],</span><br><span class="line">  truncateSync: [<span class="built_in">Function</span>],</span><br><span class="line">  ftruncate: [<span class="built_in">Function</span>],</span><br><span class="line">  ftruncateSync: [<span class="built_in">Function</span>],</span><br><span class="line">  rmdir: [<span class="built_in">Function</span>],</span><br><span class="line">  rmdirSync: [<span class="built_in">Function</span>],</span><br><span class="line">  fdatasync: [<span class="built_in">Function</span>],</span><br><span class="line">  fdatasyncSync: [<span class="built_in">Function</span>],</span><br><span class="line">  fsync: [<span class="built_in">Function</span>],</span><br><span class="line">  fsyncSync: [<span class="built_in">Function</span>],</span><br><span class="line">  mkdir: [<span class="built_in">Function</span>],</span><br><span class="line">  mkdirSync: [<span class="built_in">Function</span>],</span><br><span class="line">  readdir: [<span class="built_in">Function</span>],</span><br><span class="line">  readdirSync: [<span class="built_in">Function</span>],</span><br><span class="line">  fstat: [<span class="built_in">Function</span>],</span><br><span class="line">  lstat: [<span class="built_in">Function</span>],</span><br><span class="line">  stat: [<span class="built_in">Function</span>],</span><br><span class="line">  fstatSync: [<span class="built_in">Function</span>],</span><br><span class="line">  lstatSync: [<span class="built_in">Function</span>],</span><br><span class="line">  statSync: [<span class="built_in">Function</span>],</span><br><span class="line">  readlink: [<span class="built_in">Function</span>],</span><br><span class="line">  readlinkSync: [<span class="built_in">Function</span>],</span><br><span class="line">  symlink: [<span class="built_in">Function</span>],</span><br><span class="line">  symlinkSync: [<span class="built_in">Function</span>],</span><br><span class="line">  link: [<span class="built_in">Function</span>],</span><br><span class="line">  linkSync: [<span class="built_in">Function</span>],</span><br><span class="line">  unlink: [<span class="built_in">Function</span>],</span><br><span class="line">  unlinkSync: [<span class="built_in">Function</span>],</span><br><span class="line">  fchmod: [<span class="built_in">Function</span>],</span><br><span class="line">  fchmodSync: [<span class="built_in">Function</span>],</span><br><span class="line">  lchmod: [<span class="built_in">Function</span>],</span><br><span class="line">  lchmodSync: [<span class="built_in">Function</span>],</span><br><span class="line">  chmod: [<span class="built_in">Function</span>],</span><br><span class="line">  chmodSync: [<span class="built_in">Function</span>],</span><br><span class="line">  lchown: [<span class="built_in">Function</span>],</span><br><span class="line">  lchownSync: [<span class="built_in">Function</span>],</span><br><span class="line">  fchown: [<span class="built_in">Function</span>],</span><br><span class="line">  fchownSync: [<span class="built_in">Function</span>],</span><br><span class="line">  chown: [<span class="built_in">Function</span>],</span><br><span class="line">  chownSync: [<span class="built_in">Function</span>],</span><br><span class="line">  _toUnixTimestamp: [<span class="built_in">Function</span>: toUnixTimestamp],</span><br><span class="line">  utimes: [<span class="built_in">Function</span>],</span><br><span class="line">  utimesSync: [<span class="built_in">Function</span>],</span><br><span class="line">  futimes: [<span class="built_in">Function</span>],</span><br><span class="line">  futimesSync: [<span class="built_in">Function</span>],</span><br><span class="line">  writeFile: [<span class="built_in">Function</span>],</span><br><span class="line">  writeFileSync: [<span class="built_in">Function</span>],</span><br><span class="line">  appendFile: [<span class="built_in">Function</span>],</span><br><span class="line">  appendFileSync: [<span class="built_in">Function</span>],</span><br><span class="line">  watch: [<span class="built_in">Function</span>],</span><br><span class="line">  watchFile: [<span class="built_in">Function</span>],</span><br><span class="line">  unwatchFile: [<span class="built_in">Function</span>],</span><br><span class="line">  realpathSync: [<span class="built_in">Function</span>: realpathSync],</span><br><span class="line">  realpath: [<span class="built_in">Function</span>: realpath],</span><br><span class="line">  mkdtemp: [<span class="built_in">Function</span>],</span><br><span class="line">  mkdtempSync: [<span class="built_in">Function</span>],</span><br><span class="line">  copyFile: [<span class="built_in">Function</span>],</span><br><span class="line">  copyFileSync: [<span class="built_in">Function</span>],</span><br><span class="line">  createReadStream: [<span class="built_in">Function</span>],</span><br><span class="line">  ReadStream: </span><br><span class="line">   &#123; [<span class="built_in">Function</span>: ReadStream]</span><br><span class="line">     super_: </span><br><span class="line">      &#123; [<span class="built_in">Function</span>: Readable]</span><br><span class="line">        ReadableState: [<span class="built_in">Function</span>: ReadableState],</span><br><span class="line">        super_: [<span class="built_in">Object</span>],</span><br><span class="line">        _fromList: [<span class="built_in">Function</span>: fromList] &#125; &#125;,</span><br><span class="line">  FileReadStream: </span><br><span class="line">   &#123; [<span class="built_in">Function</span>: ReadStream]</span><br><span class="line">     super_: </span><br><span class="line">      &#123; [<span class="built_in">Function</span>: Readable]</span><br><span class="line">        ReadableState: [<span class="built_in">Function</span>: ReadableState],</span><br><span class="line">        super_: [<span class="built_in">Object</span>],</span><br><span class="line">        _fromList: [<span class="built_in">Function</span>: fromList] &#125; &#125;,</span><br><span class="line">  createWriteStream: [<span class="built_in">Function</span>],</span><br><span class="line">  WriteStream: </span><br><span class="line">   &#123; [<span class="built_in">Function</span>: WriteStream]</span><br><span class="line">     super_: &#123; [<span class="built_in">Function</span>: Writable] WritableState: [<span class="built_in">Function</span>: WritableState], </span><br><span class="line">     super_: [<span class="built_in">Object</span>] &#125; &#125;,</span><br><span class="line">  FileWriteStream: </span><br><span class="line">   &#123; [<span class="built_in">Function</span>: WriteStream]</span><br><span class="line">     super_: &#123; [<span class="built_in">Function</span>: Writable] WritableState: [<span class="built_in">Function</span>: WritableState],</span><br><span class="line">     super_: [<span class="built_in">Object</span>] &#125; &#125; &#125;</span><br></pre></td></tr></table></figure>
<p>在该模块中，所有的文件操作都提供了<code>同步</code>和<code>异步</code>两种方法(譬如：<code>readFile</code>和<code>readFileSync</code>方法)。这些方法在使用的时候，其使用方式和参数情况基本都是一致的。</p>
<p><strong>如果是异步方法</strong>，那么其语法形式总是为<code>function (err,callback)</code>，最后一个参数代表操作完成的回调函数，第一个参数通常是操作错误的异常(如果操作成功，该参数的值为<code>null</code>或<code>undefined</code>)，需注意异步方法不能保证执行顺序，如果对多个异步任务的执行顺序有要求，那么应该把后面的任务写在前面任务的回调函数中。</p>
<p><strong>如果是同步方法</strong>，那么任何异常都会立即抛出，可以使用<code>try/catch</code>结构来处理异常。同步方法总是按顺序从上向下执行，是阻塞的。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//001 导入内置模块</span></span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//002 演示同步方法的执行</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">//方法说明：追加数据到文件中，如果文件不存在那么就创建</span></span><br><span class="line">    fs.appendFileSync(<span class="string">'./Hi.text'</span>, <span class="string">'文本数据'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Success Info：创建文件成功!'</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span>(err)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Error Info:'</span>,err);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//003 演示异步方法的使用</span></span><br><span class="line"><span class="comment">//方法说明：对文件执行重命名操作</span></span><br><span class="line">fs.rename(<span class="string">'./Hi.text'</span>, <span class="string">'./Hello.text'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(error) <span class="keyword">throw</span> error;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Success Info: 文件重命名成功！"</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//方法说明：查看重命名后的文件信息</span></span><br><span class="line">    <span class="comment">//依赖关系：需保证Hello.text文件已经存在</span></span><br><span class="line">    fs.stat(<span class="string">'./Hello.text'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err, stats</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`File Info: \n <span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(stats,<span class="literal">null</span>,<span class="number">4</span>)&#125;</span>`</span>);</span><br><span class="line">      &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><strong>代码说明</strong> 上面给出了同步和异步方法使用的简单示例，代码中首先导入了fs模块，然后在当前目录中使用同步的方法(<code>appendFileSync</code>)来创建<code>Hi.text</code>文件并写入数据，随后调用异步方法(<code>rename</code>)来对文件执行重命名操作，继而打印(<code>stat</code>)该文件的信息。下面列出示例代码的执行细节。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">wendingding$ node app.js </span><br><span class="line">Success Info：创建文件成功!</span><br><span class="line">Success Info: 文件重命名成功！</span><br><span class="line">File Info: </span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"dev"</span>: 16777220,</span><br><span class="line">    <span class="string">"mode"</span>: 33188,</span><br><span class="line">    <span class="string">"nlink"</span>: 1,</span><br><span class="line">    <span class="string">"uid"</span>: 501,</span><br><span class="line">    <span class="string">"gid"</span>: 20,</span><br><span class="line">    <span class="string">"rdev"</span>: 0,</span><br><span class="line">    <span class="string">"blksize"</span>: 4194304,</span><br><span class="line">    <span class="string">"ino"</span>: 8601332359,</span><br><span class="line">    <span class="string">"size"</span>: 12,</span><br><span class="line">    <span class="string">"blocks"</span>: 8,</span><br><span class="line">    <span class="string">"atimeMs"</span>: 1543633694668.5117,</span><br><span class="line">    <span class="string">"mtimeMs"</span>: 1543633694669.2383,</span><br><span class="line">    <span class="string">"ctimeMs"</span>: 1543633694671.2622,</span><br><span class="line">    <span class="string">"birthtimeMs"</span>: 1543633694668.5117,</span><br><span class="line">    <span class="string">"atime"</span>: <span class="string">"2018-12-01T03:08:14.669Z"</span>,</span><br><span class="line">    <span class="string">"mtime"</span>: <span class="string">"2018-12-01T03:08:14.669Z"</span>,</span><br><span class="line">    <span class="string">"ctime"</span>: <span class="string">"2018-12-01T03:08:14.671Z"</span>,</span><br><span class="line">    <span class="string">"birthtime"</span>: <span class="string">"2018-12-01T03:08:14.669Z"</span></span><br><span class="line">&#125;</span><br><span class="line">wendingding$ cat Hello.text </span><br><span class="line">文本数据</span><br></pre></td></tr></table></figure></p>
<hr>
<ul>
<li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="noopener">花田半亩</a></li>
<li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="noopener">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li>
<li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/2018/11/28/Node系列-http/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2018 <a href="https://weibo.com/u/3800117445">文顶顶</a> &nbsp;☁ 全站字数统计246.7k(字)</p><!--p © #{year} #[a(href=config.url)!= config.author], powered by #[a(href=hexoURL, target="_blank") Hexo] and #[a(href=apolloURL, target="_blank") hexo-theme-apollo].--></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>