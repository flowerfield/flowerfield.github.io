<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 前端工程化系列[08] Gulp构建工具的基本使用 · 花田半亩</title><meta name="description" content="前端工程化系列[08] Gulp构建工具的基本使用 - 文顶顶"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/logo.jpeg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://weibo.com/u/3800117445/atom.xml" title="花田半亩"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/04.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">文顶顶的BLOG</a></li><li class="nav-list-item"><a href="/tags/" target="_self" class="nav-list-link">标签</a></li><li class="nav-list-item"><a href="https://www.cnblogs.com/wendingding/" target="_blank" class="nav-list-link">博客园</a></li><li class="nav-list-item"><a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place" target="_blank" class="nav-list-link">微博</a></li><li class="nav-list-item"><a href="http://blog.sina.com.cn/u/1910914290" target="_blank" class="nav-list-link">花田半亩</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">前端工程化系列[08] Gulp构建工具的基本使用</h1><div class="post-info">Jun 29, 2018<span class="post-count"></span> ✧ 字数统计:2,489(字) &nbsp;&nbsp; ♨︎ 阅读时长:10(分钟)</div><div class="post-content"><blockquote>
<p>本文主要介绍前端开发中常用的构建工具Gulp，具体包括Gulp的基本情况、安装、使用以及常见插件的安装、配置和使用等内容。</p>
</blockquote>
<p><img src="https://github.com/flowerField/Source/blob/master/Blog/gulp.png?raw=true" height="200px"></p>
<h3 id="Gulp介绍"><a href="#Gulp介绍" class="headerlink" title="Gulp介绍"></a>Gulp介绍</h3><p><strong>Gulp</strong><code>是使用JavaScript编写的，运行在Node.js上的一款自动化构建工具</code>，同类型的构建工具还有Grunt、Npm-script等。Gulp的构建系统基于流来实现，增加了监听文件、读写文件以及流式处理等功能，Gulp作为后起之秀整体来说比Grunt更加强大而且使用起来也更加简单，你值得拥有。</p>
<p><strong>Gulp优点</strong></p>
<blockquote>
<p>❏  基于流的操作，能更快速的构建项目并减少频繁的IO操作，更高效。<br>❏  提供最少的API，降低开发者的学习成本，自动构建相关代码更简单。<br>❏  代码优先的策略，让简单的任务简单处理，让复杂的任务变得可管理。<br>❏  严格的插件指南，确保所有的插件简单，职责单一能按期望方式工作。</p>
</blockquote>
<p><strong>Gulp和Grunt简单对比</strong><br><img src="https://github.com/flowerField/Source/blob/master/Blog/gulp01.png?raw=true"></p>
<p><strong>Gulp的组成结构</strong></p>
<p>Gulp本身和Grunt还是很相像的，Gulp项目主要由<code>Gulp-Cli</code>、<code>Node模块(本地的gulp和gulp插件)</code>以及<code>Gulpfile文件</code>构成。</p>
<blockquote>
<p><strong>Gulp-Cli &nbsp;&nbsp; ✧ </strong>  &nbsp;启动Gulp构建工具的命令行接口，全局安装。<br><strong>本地Gulp ✧ </strong>   &nbsp;构建时实际运行的本地程序,提供基本的API并加载构建指令和运行任务。<br><strong>Gulp插件 ✧ </strong>   &nbsp;Gulp构建工具生态系统中拥有众多高质量的插件，本质上是对特定任务的封装。<br><strong>Gulpfile文件 ✧ </strong> &nbsp;定义所有构建任务的配置文件，告诉本地Gulp如何执行具体构建操作的指令文件。</p>
</blockquote>
<p><img src="https://github.com/flowerField/Source/blob/master/Blog/gulp02.png?raw=true"></p>
<p>上图是Gulp几个部分的关系图，这里做简单说明。</p>
<p><code>Gulp-cli</code>是Gulp的命令行工具，如果项目中要使用Gulp构建工具，那么必须先安装Gulp-cli，它的作用非常简单，就死检查当前项目里是否安装了本地的Gulp，如果安装了那么Gulp-cli会根据命令行中输入的命令参数来启动本地Gulp接管后续的操作。Gulp-cli通常需要全局安装，这样任何目录下面的Gulp才能够在终端中执行。</p>
<p><code>本地Gulp</code>主要有两个作用，一个是提供构建必要的基本API，另一个是加载并执行定义好的任务。需要注意的是，本地的Gulp才是真正的Gulp运行时，它负责处理所有的任务，而Gulp-Cli是本地Gulp的全局入口，它负责把所有的命令参数都转交给本地Gulp处理，之后由Gulp来接手具体的构建过程。</p>
<p>本地Gulp在运行的时候，需要读取<code>Gulpfile.js文件</code>的内容，Gulpfile.js文件主要加载Gulp插件，并且调用Gulp相关的api来定义task（任务）。Gulp具体要做什么操作，应该如何执行这些操作等都由Gulpfile.js文件决定。</p>
<p><strong>Gulp参考</strong></p>
<p><a href="https://gulpjs.com/" target="_blank" rel="external">Gulp官网</a><br><a href="https://gulpjs.com.cn" target="_blank" rel="external">Gulp官网（中文）</a><br><a href="https://gulpjs.com/plugins/" target="_blank" rel="external">Gulp官方插件列表页</a><br><a href="https://www.npmjs.com/package/gulp" target="_blank" rel="external">Gulp在npm的发布页</a><br><a href="https://legacy.gitbook.com/book/wizardforcel/gulp-doc/details" target="_blank" rel="external">Gulp中文文档-GitBook</a></p>
<h3 id="Gulp的安装"><a href="#Gulp的安装" class="headerlink" title="Gulp的安装"></a>Gulp的安装</h3><p><span style="border:1px solid #000"><strong>&nbsp; &nbsp;环境支持&nbsp; &nbsp;</strong></span></p>
<p>Gulp基于Node.js，所以在安装gulp之前，请确认已经在系统环境中安装了Node.js和npm（默认和Node绑定在一起安装）。</p>
<p>Node.js的安装请参考<a href="https://nodejs.org" target="_blank" rel="external">Node官网</a>，根据提示安装完成后，可以通过下面的命令来检查Node.js和npm是否被正确安装。</p>
<p><code>$ node --version</code><br><code>$ npm --version</code></p>
<p><span style="border:1px solid #000"><strong>&nbsp; &nbsp;Gulp-Cli的安装&nbsp; &nbsp;</strong></span></p>
<p>Node的环境准备好之后，接下来就可以来安装Gulp的命令行工具了。需要注意，Gulp的命令行工具需要全局安装，安装完成后可以通过查看版本号的方式来进行确认，下面给出安装命令。</p>
<p><code>$ npm install -g gulp-cli</code><br><code>$ gulp --version</code></p>
<p>这里顺便贴出终端执行细节。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">wendingding$ node --version</div><div class="line">v8.9.3</div><div class="line">wendingding$ npm --version</div><div class="line">5.5.1</div><div class="line">wendingding$ npm install -g gulp-cli</div><div class="line">/usr/<span class="built_in">local</span>/bin/gulp -&gt; /usr/<span class="built_in">local</span>/lib/node_modules/gulp-cli/bin/gulp.js</div><div class="line">+ gulp-cli@2.0.1</div><div class="line">added 236 packages <span class="keyword">in</span> 89.58s</div><div class="line">wendingding$ gulp --version</div><div class="line">[17:23:12] CLI version 2.0.1</div></pre></td></tr></table></figure></p>
<p><span style="border:1px solid #000"><strong>&nbsp; &nbsp;本地Gulp的安装&nbsp; &nbsp;</strong></span></p>
<p>安装好Gulp的命令行工具后，就可以在您的项目目录中安装本地的局部Gulp了。本地的Gulp是真正运行构建任务的程序，全局的Gulp-Cli仅仅用于检查本地Gulp是否可用，如果可用那么就启动本地Gulp程序。安装成功后，本地的Gulp位于目录结构中的node_modules文件夹下。它包含了Gulpfile文件需要的所有函数和API。</p>
<p><strong>① 创建项目目录，使用命令行工具先进入当前路径（假设项目名称为GulpDemo）</strong></p>
<p><code>$ mkdir GulpDemo</code><br><code>$ cd GulpDemo/</code></p>
<p><strong>② 初始化环境，创建package.json文件</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">wendingding$ mkdir GulpDemo</div><div class="line">wendingding$ <span class="built_in">cd</span> GulpDemo/</div><div class="line">GulpDemo wendingding$ npm init</div><div class="line">This utility will walk you through creating a package.json file.</div><div class="line">It only covers the most common items, and tries to guess sensible defaults.</div><div class="line"></div><div class="line">See `npm <span class="built_in">help</span> json` <span class="keyword">for</span> definitive documentation on these fields</div><div class="line">and exactly what they <span class="keyword">do</span>.</div><div class="line"></div><div class="line">Use `npm install &lt;pkg&gt;` afterwards to install a package and</div><div class="line">save it as a dependency <span class="keyword">in</span> the package.json file.</div><div class="line"></div><div class="line">Press ^C at any time to quit.</div><div class="line">package name: (gulpdemo)</div><div class="line">version: (1.0.0)</div><div class="line">description:</div><div class="line">entry point: (index.js)</div><div class="line"><span class="built_in">test</span> <span class="built_in">command</span>:</div><div class="line">git repository:</div><div class="line">keywords:</div><div class="line">author: 文顶顶</div><div class="line">license: (ISC)</div><div class="line">About to write to /Users/文顶顶/GulpDemo/package.json:</div><div class="line">&#123;</div><div class="line">  <span class="string">"name"</span>: <span class="string">"gulpdemo"</span>,</div><div class="line">  <span class="string">"version"</span>: <span class="string">"1.0.0"</span>,</div><div class="line">  <span class="string">"description"</span>: <span class="string">""</span>,</div><div class="line">  <span class="string">"main"</span>: <span class="string">"index.js"</span>,</div><div class="line">  <span class="string">"scripts"</span>: &#123;</div><div class="line">    <span class="string">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="string">"author"</span>: <span class="string">"文顶顶"</span>,</div><div class="line">  <span class="string">"license"</span>: <span class="string">"ISC"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">Is this ok? (yes) yes</div></pre></td></tr></table></figure></p>
<p><strong>③ 安装Gulp到当前项目中</strong></p>
<p><code>$ npm install --save-dev gulp</code></p>
<p><code>save-dev</code>参数的作用是把安装的Gulp版本正确保存在package.json文件中，命令行执行完毕后我们可以通过<code>cat指令</code>来查看package.json文件的内容，可以发现devDependencies字段增加了gulp信息。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">GulpDemo wendingding$ cat package.json</div><div class="line">&#123;</div><div class="line">  <span class="string">"name"</span>: <span class="string">"gulpdemo"</span>,</div><div class="line">  <span class="string">"version"</span>: <span class="string">"1.0.0"</span>,</div><div class="line">  <span class="string">"description"</span>: <span class="string">""</span>,</div><div class="line">  <span class="string">"main"</span>: <span class="string">"index.js"</span>,</div><div class="line">  <span class="string">"scripts"</span>: &#123;</div><div class="line">    <span class="string">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="string">"author"</span>: <span class="string">"文顶顶"</span>,</div><div class="line">  <span class="string">"license"</span>: <span class="string">"ISC"</span>,</div><div class="line">  <span class="string">"devDependencies"</span>: &#123;</div><div class="line">    <span class="string">"gulp"</span>: <span class="string">"^3.9.1"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>④ Gulp安装好后，可以通过<code>--version</code>命令检查版本信息确认</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">GulpDemo wendingding$ gulp --version</div><div class="line">[19:30:11] CLI version 2.0.1</div><div class="line">[19:30:11] Local version 3.9.1</div><div class="line">GulpDemo wendingding$ Tree -L 1</div><div class="line">.</div><div class="line">├── node_modules</div><div class="line">├── package-lock.json</div><div class="line">└── package.json</div></pre></td></tr></table></figure></p>
<p>现在全局的Gulp-Cli和本地的Gulp安装完毕，且package.json文件准备好后，就可以创建Gulpfile.js文件来处理具体的Task了。</p>
<h3 id="Gulp的基本使用"><a href="#Gulp的基本使用" class="headerlink" title="Gulp的基本使用"></a>Gulp的基本使用</h3><p>前面我们对Gulp进行了简单了介绍，并且已经在全局安装好了Gulp命令行工具并把Gulp安装到了当前项目（GulpDemo）中，接下来这里简单介绍下Gulp的基本使用。</p>
<p>Gulp要执行哪些任务，这些任务的具体执行方式等等的都由Gulpfile文件中的命令来决定，现在我们先在GulpDemo根目录下创建一个空的Gulpfile.js文件，然后编写具体的Task处理代码。</p>
<p>在根目录创建文件命令：<code>$ touch Gulpfile.js</code></p>
<p>Gulp的任务可以简单的划分为两种，一种是自定义任务，另外一种是使用Gulp插件，不管是什么类型的任务都通过gulp.task这个API来进行设置。</p>
<p><strong>自定义Task</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//[01] 引入本地的Gulp</span></div><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">"gulp"</span>);</div><div class="line"></div><div class="line"><span class="comment">//[02] 定义Task（自定义的任务）</span></div><div class="line">gulp.task(<span class="string">"demo"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">"这是一个自定义的Task"</span>);</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>编辑Gulpfile.js文件的内容，这里我们先引入了本地的gulp，然后通过gulp.task这个API定义了一个打印输出字符串的任务。gulp.task方法接收两个参数，第一个参数为任务的名称，第二个参数为表示具体任务的回调函数。当我们执行指定任务的时候，该任务对应的回调函数会被执行。</p>
<p>在终端中输入<code>$ gulp demo</code>指令来执行自定义任务。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">GulpDemo wendingding$ gulp demo</div><div class="line">[20:22:40] Using gulpfile ~/GulpDemo/gulpfile.js</div><div class="line">[20:22:40] Starting <span class="string">'demo'</span>...</div><div class="line">这是一个自定义的Task</div><div class="line">[20:22:40] Finished <span class="string">'demo'</span> after 260 μs</div></pre></td></tr></table></figure></p>
<p><strong>Gulp插件Task</strong></p>
<p>在Gulp作为项目构建工具使用的时候，通常主要是使用现成的相关插件来处理Task的，因为Gulp生态的原因，Gulp的插件数量足够多，质量足够好。这里我们就以一款比较流行的JavaScript代码压缩和混淆插件<code>uglify</code>为例简单说明。</p>
<p>要使用某个插件，需要先把该插件下载安装到本地。</p>
<p>安装插件的命令  <code>$ npm install --save-dev gulp-uglify</code></p>
<p>上面的命令会把Uglify的Gulp插件下载到当前项目的node_modules文件夹下，并在package.json文件中保存相关的依赖信息。</p>
<p>插件安装完毕之后，我们在Gulpfile.js文件中需要先把要用到的插件引入进来，然后调用相关的API即可，下面给出代码示例。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//[01] 引入本地的Gulp</span></div><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">"gulp"</span>);</div><div class="line"><span class="comment">//[02] 引入gulp-uglify插件</span></div><div class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">"gulp-uglify"</span>);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//[03] 定义Task（自定义的任务）</span></div><div class="line">gulp.task(<span class="string">"demo"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">"这是一个自定义的Task"</span>);</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">//[04] 定义Task（插件）</span></div><div class="line">gulp.task(<span class="string">"uglifyTask"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src(<span class="string">"src/js/*.js"</span>).pipe(uglify()).pipe(gulp.dest(<span class="string">"dist"</span>));</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>然后通过<code>$ gulp uglifyTask</code>命令来执行uglifyTask任务即可，该任务执行的时候会把src/js/目录下面所有的js文件进行压缩混淆并把结果分别保存到dist目录下，下面简单列一下终端的执行情况。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">GulpDemo wendingding$ gulp uglifyTask</div><div class="line">[23:58:51] Using gulpfile ~/GulpDemo/gulpfile.js</div><div class="line">[23:58:51] Starting <span class="string">'uglifyTask'</span>...</div><div class="line">[23:58:51] Finished <span class="string">'uglifyTask'</span> after 64 ms</div></pre></td></tr></table></figure>
<p>Gulp执行任务的时候，支持一次性执行多个任务，语法格式为：<code>$ gulp task1 task2</code>，上面的Gulpfile.js文件中如果要依次执行uglifyTask和demo这两个Task，那么可以像下面这样处理。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">GulpDemo wendingding$ gulp uglifyTask demo</div><div class="line">[00:01:35] Using gulpfile ~/GulpDemo/gulpfile.js</div><div class="line">[00:01:35] Starting <span class="string">'uglifyTask'</span>...</div><div class="line">[00:01:35] Starting <span class="string">'demo'</span>...</div><div class="line">这是一个自定义的Task</div><div class="line">[00:01:35] Finished <span class="string">'demo'</span> after 185 μs</div><div class="line">[00:01:35] Finished <span class="string">'uglifyTask'</span> after 65 ms</div></pre></td></tr></table></figure></p>
<hr>
<ul>
<li>获取更多、更专业的IT技能，请猛戳~<a href="http://www.520it.com/" target="_blank" rel="external">小码哥教育</a>︎</li>
<li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="external">文顶顶</a> ~ <a href="http://wendingding.com" target="_blank" rel="external">文顶顶的个人博客_花田半亩</a></li>
<li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="external">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li>
<li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="external">文顶顶</a><br><img src="https://github.com/flowerField/Source/blob/master/Blog/banner.jpg?raw=true" onclick="window.open('http://www.520it.com/zt/t30/');"></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/2018/07/05/读书笔记 [012]-可爱的洪水猛兽/" class="prev">上一篇</a><a href="/2018/06/24/TypeScript系列 [06]-typeScript语言特性(五)/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2018 <a href="https://weibo.com/u/3800117445">文顶顶</a> &nbsp;☁ 全站字数统计142.9k(字)</p><!--p © #{year} #[a(href=config.url)!= config.author], powered by #[a(href=hexoURL, target="_blank") Hexo] and #[a(href=apolloURL, target="_blank") hexo-theme-apollo].--></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>