<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 微信小程序基础[06]-数据的绑定和基础指令 · 花田半亩</title><meta name="description" content="微信小程序基础[06]-数据的绑定和基础指令 - 文顶顶"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/logo.jpeg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://weibo.com/u/3800117445/atom.xml" title="花田半亩"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/鲸鱼.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">文顶顶的BLOG</a></li><li class="nav-list-item"><a href="/tags/" target="_self" class="nav-list-link">标签</a></li><li class="nav-list-item"><a href="https://www.cnblogs.com/wendingding/" target="_blank" class="nav-list-link">博客园</a></li><li class="nav-list-item"><a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place" target="_blank" class="nav-list-link">微博</a></li><li class="nav-list-item"><a href="http://blog.sina.com.cn/u/1910914290" target="_blank" class="nav-list-link">花田半亩</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">微信小程序基础[06]-数据的绑定和基础指令</h1><div class="post-info">Sep 25, 2018<span class="post-count"></span> ✧ 字数统计:1,464(字) &nbsp;&nbsp; ♨︎ 阅读时长:6(分钟)</div><div class="post-content"><blockquote>
<p>本文介绍小程序框架中的数据绑定以及基本指令相关知识点。</p>
</blockquote>
<h4 id="1-0-数据绑定"><a href="#1-0-数据绑定" class="headerlink" title="1.0 数据绑定"></a>1.0 数据绑定</h4><p>我们在进行小程序开发的时候应该深刻理解数据绑定和事件响应模型，这和前端开发中面向DOM操作的编程思想截然不同。</p>
<p>小程序中的页面在进行渲染的时候，框架本身会将WXML文件和对应js文件中Page函数里面的data进行绑定。在WXML页面中我们可以直接使用<code>data中的属性</code>。小程序中的数据绑定使用<code>Mustache语法</code>(双大括号插值)来讲变量或者是简单的运算规则包起来。</p>
<p><img src="https://github.com/flowerField/Source/blob/master/Blog/wx14.png?raw=true"></p>
<p><strong>简单绑定</strong></p>
<p>简单绑定指的是使用Mustache语法将变量包起来，在模板中直接作为字符串输出。</p>
<p>数据的简单绑定可作用于<strong>组件的内容</strong>、<strong>组件的属性</strong>、<strong>组件的控制属性</strong>以及<strong>关键字</strong>(按JavaScript中关键字其真值输出)等输出。</p>
<p>这里给出简单数据绑定的代码和运行结果示例：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">//.wxml文件的内容</div><div class="line"><span class="comment">&lt;!-- 1.0 作为组件的内容绑定 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>&#123;&#123;contentText&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 2.0 作为组件的属性绑定 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">'&#123;&#123;className&#125;&#125;'</span>&gt;</span>绑定class属性<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">style</span>=<span class="string">'border:&#123;&#123;borderStyle&#125;&#125;'</span>&gt;</span>绑定style属性中border的值<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 3.0 作为控制属性绑定 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:if</span>=<span class="string">'&#123;&#123;isShow&#125;&#125;'</span>&gt;</span>是否显示该组件<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 4.0 作为关键字直接输出 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>作为数字直接输出&#123;&#123;100&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">checkbox</span> <span class="attr">checked</span>=<span class="string">'&#123;&#123;false&#125;&#125;'</span>&gt;</span><span class="tag">&lt;/<span class="name">checkbox</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">checkbox</span> <span class="attr">checked</span>&gt;</span><span class="tag">&lt;/<span class="name">checkbox</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">checkbox</span> <span class="attr">checked</span>=<span class="string">'false'</span>&gt;</span><span class="tag">&lt;/<span class="name">checkbox</span>&gt;</span></div><div class="line"></div><div class="line">//js文件的内容</div><div class="line">Page(&#123;</div><div class="line">  data: &#123;</div><div class="line">    contentText:"曾虑多情损梵行",</div><div class="line">    className:"view-class",</div><div class="line">    borderStyle:"1px solid #000",</div><div class="line">    isShow:true</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/flowerField/Source/blob/master/Blog/wx15.png?raw=true"></p>
<p><strong>运算支持</strong></p>
<p>小程序在进行数据绑定的时候还支持进行简单的运算，这些运算包括<strong>三元运算</strong>、<strong>算术运算</strong>、<strong>逻辑判断</strong>、<strong>字符串运算</strong>和<strong>对象取值</strong>等操作，这些运算在具体执行的时候遵从JavaScript语言的运算规则。</p>
<p>这里给出数据绑定运算支持的代码和运行结果示例：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">//wxml文件内容</div><div class="line"><span class="comment">&lt;!-- 1.0 三元运算符 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>&#123;&#123;isShowText ? '显示' : '不显示'&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- &lt;view&gt;&#123;&#123;isShowText ? 显示 : 不显示&#125;&#125;&lt;/view&gt; 错误的演示--&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 2.0 基本的算术运算 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>&#123;&#123; a &#125;&#125; + 4  + &#123;&#123; b + c &#125;&#125;  = &#123;&#123;a + b + c + 4&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 3.0 逻辑运算 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span> 显示变量a&gt;3的结果：&#123;&#123;a &gt; 3&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 4.0 字符串运算 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>&#123;&#123; "des:" + strM&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 5.0 对象取值运算 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>姓名== &#123;&#123;"name:" + objM.name&#125;&#125; 年龄== &#123;&#123;"age:" + objM.age&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"></div><div class="line">//js文件内容</div><div class="line">Page(&#123;</div><div class="line">  data: &#123;</div><div class="line">    isShowText:true,</div><div class="line">    a:1,</div><div class="line">    b:2,</div><div class="line">    c:3,</div><div class="line">    strM:"我是拼接的字符串",</div><div class="line">    objM:&#123;</div><div class="line">      name:"文顶顶",</div><div class="line">      age:18</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  &#125;)</div></pre></td></tr></table></figure></p>
<p><img src="https://github.com/flowerField/Source/blob/master/Blog/wx16.png?raw=true"></p>
<h4 id="2-0-基本指令"><a href="#2-0-基本指令" class="headerlink" title="2.0 基本指令"></a>2.0 基本指令</h4><p>在小程序开发中还有一些指令可以用来辅助数据绑定的操作，它们分别是<strong>条件渲染</strong>的指令和<strong>列表渲染</strong>的指令，负责处理<code>分支和循环</code>两种结构。</p>
<p><strong>条件渲染</strong></p>
<p>条件渲染的指令主要有：<code>wx:if</code>、<code>wx:elif</code>和<code>wx:else</code>,它们其实相当于if、else if和else。</p>
<p>当绑定的数据结果为true的时候显示，为false的时候不显示。<strong>注意</strong><code>wx:else</code>指令只能和<code>wx:if</code>指令配合成对使用，无法独自使用。如果需要控制多个组件的显示和隐藏又不影响布局，那么可以使用block标签来进行包裹。</p>
<div class="tip">注意：block不是组件，仅仅是一个包裹元素，页面渲染的时候不做任何处理。</div>

<p><strong><code>wx:if指令和hidden简单对比</code></strong></p>
<blockquote>
<p>❏ <code>wx:if是惰性的，当条件为真时才第一次渲染组件，否则将忽略。</code><br>❏ <code>设置hidden的组件始终会被渲染，仅通过样式控制显示或隐藏，本身不会触发销毁和重新渲染。</code></p>
</blockquote>
<p><strong>列表渲染</strong></p>
<p>列表渲染的指令主要有：<code>wx:for</code>、<code>wx:for-index</code>和<code>wx:for-item</code>。</p>
<p><code>wx:for</code>指令(控制属性)用于遍历数组根据数据的元素来重复渲染组件。默认情况下，渲染过程中数组当前渲染项的下标为index,当前项为item，它们可以通过<code>wx:for-index</code>和<code>wx:for-item</code>指令重命名。如果需要渲染的是多个组件的组合，那么可以使用block元素来进行包裹。</p>
<p>这里给出条件渲染和列表渲染的代码示例和运行结果：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">//js文件内容</div><div class="line">Page(&#123;</div><div class="line">  data: &#123;</div><div class="line">    isShow:true,</div><div class="line">    count:80,</div><div class="line">    arrM1:[</div><div class="line">      "哈哈",</div><div class="line">      "呵呵",</div><div class="line">      "嘻嘻"</div><div class="line">    ],</div><div class="line">    arrM2: [</div><div class="line">      &#123;name:"张三",age:18&#125;,</div><div class="line">      &#123;name:"李四",age:99&#125;</div><div class="line">    ],</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line">//wxml文件内容</div><div class="line"><span class="comment">&lt;!-- 1.0 控制是否显示 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:if</span>=<span class="string">"&#123;&#123;isShow&#125;&#125;"</span>&gt;</span>是否显示<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 2.0 if..elif..else组合使用 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:if</span>=<span class="string">"&#123;&#123;count &gt; 100&#125;&#125;"</span>&gt;</span>已经超过100块<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:elif</span>=<span class="string">"&#123;&#123;count &gt; 50&#125;&#125;"</span>&gt;</span>超过50块不足100块<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:else</span>&gt;</span>连50块都不给我<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 3.0 使用block包裹控制多个组件是否显示 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:if</span>=<span class="string">'&#123;&#123;true&#125;&#125;'</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">text</span>&gt;</span>我是文本\n<span class="tag">&lt;/<span class="name">text</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">text</span>&gt;</span>我还是文本\n<span class="tag">&lt;/<span class="name">text</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>我和它们不一样<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">block</span>&gt;</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 4.0 隐藏标签 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:if</span>=<span class="string">'&#123;&#123;isShow&#125;&#125;'</span>&gt;</span>哈哈哈<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 隐藏 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">hidden</span>&gt;</span>嘻嘻嘻嘻2<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 隐藏 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">hidden</span>=<span class="string">'false'</span>&gt;</span>嘻嘻嘻嘻3<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--显示--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">hidden</span>=<span class="string">'&#123;&#123;false&#125;&#125;'</span>&gt;</span>嘻嘻嘻嘻4<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 5.0 列表渲染基本 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:for</span>=<span class="string">'&#123;&#123;arrM1&#125;&#125;'</span>&gt;</span>当前的索引和元素&#123;&#123;index + ":" + item&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 6.0 列表渲染其它指令 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:for</span>=<span class="string">'&#123;&#123;arrM2&#125;&#125;'</span> <span class="attr">wx:for-index</span>=<span class="string">'i'</span> <span class="attr">wx:for-item</span>=<span class="string">'ele'</span>&gt;</span>当前的索引和元素信息&#123;&#123;i + "=&gt;" + ele.name + ele.age&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div></pre></td></tr></table></figure>
<p><img src="https://github.com/flowerField/Source/blob/master/Blog/wx17.png?raw=true"></p>
<div class="tip">警告：Now you can provide attr “wx:key” for a “wx:for” to improve performance。官方解释：当数据改变触发渲染层重新渲染的时候，会校正带有 key 的组件，框架会确保他们被重新排序，而不是重新创建，以确保使组件保持自身的状态，并且提高列表渲染时的效率。</div>


<hr>
<ul>
<li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="external">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="external">花田半亩</a></li>
<li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="external">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li>
<li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="external">文顶顶</a></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/2018/09/26/微信小程序系列[07]-事件的绑定和事件对象/" class="prev">上一篇</a><a href="/2018/09/24/微信小程序系列[05]-小程序框架基础组件01/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2018 <a href="https://weibo.com/u/3800117445">文顶顶</a> &nbsp;☁ 全站字数统计216.3k(字)</p><!--p © #{year} #[a(href=config.url)!= config.author], powered by #[a(href=hexoURL, target="_blank") Hexo] and #[a(href=apolloURL, target="_blank") hexo-theme-apollo].--></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>