<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 微信小程序序列[07]-事件的绑定和事件对象 · 花田半亩</title><meta name="description" content="微信小程序序列[07]-事件的绑定和事件对象 - 文顶顶"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/logo.jpeg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://weibo.com/u/3800117445/atom.xml" title="花田半亩"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/鲸鱼.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">文顶顶的BLOG</a></li><li class="nav-list-item"><a href="/tags/" target="_self" class="nav-list-link">标签</a></li><li class="nav-list-item"><a href="https://www.cnblogs.com/wendingding/" target="_blank" class="nav-list-link">博客园</a></li><li class="nav-list-item"><a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place" target="_blank" class="nav-list-link">微博</a></li><li class="nav-list-item"><a href="http://blog.sina.com.cn/u/1910914290" target="_blank" class="nav-list-link">花田半亩</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">微信小程序序列[07]-事件的绑定和事件对象</h1><div class="post-info">Sep 26, 2018<span class="post-count"></span> ✧ 字数统计:760(字) &nbsp;&nbsp; ♨︎ 阅读时长:3(分钟)</div><div class="post-content"><blockquote>
<p>本文介绍小程序框架中的事件和事件对象，包括事件的分类，事件的绑定和事件对象的内部细节。</p>
</blockquote>
<h4 id="1-0-事件绑定"><a href="#1-0-事件绑定" class="headerlink" title="1.0 事件绑定"></a>1.0 事件绑定</h4><p><strong>小程序官方对WXML事件的定义</strong></p>
<blockquote>
<p>❏ 事件时视图层到逻辑层的通信方式。<br>❏ 事件可以将用户的行为反馈到逻辑层进行处理。<br>❏ 事件对象可以携带额外的数据信息，例如id、dataset和touches等。<br>❏ 事件可以绑定到组件上，当组件上对应事件被触发后，将执行逻辑层中对应的事件处理函数。</p>
</blockquote>
<p>小程序中的事件系统和前端开发中HTML里DOM事件系统很相像，在DOM系统通过<code>on + &quot;事件类型&quot;</code>的方式(ex：<span style="color:#195">onclick</span>)来给标签注册不同类型的事件，在小程序中我们通过<code>bind|catch + &quot;事件类型(名)</code>“的方式(ex：<span style="color:#195">bindtap</span>)来给组件绑定不同的事件。</p>
<p><img src="https://github.com/flowerField/Source/blob/master/Blog/wx18.png?raw=true"></p>
<p>小程序中的事件分为<strong>冒泡事件</strong>和<strong>非冒泡事件</strong>，如果是冒泡事件的话，那么当组件上对应的事件被触发后该事件会向其父节点传递，直到顶层节点；如果是非冒泡事件的话，则不会向父节点传递。</p>
<p>绑定事件的时候可以使用<code>bind</code>或者是<code>catch</code>关键字，其中bind绑定的事件不会阻止冒泡事件向上传递，而catch绑定的事件会阻止冒泡事件向上传递。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">//wxml文件中的内容</div><div class="line"><span class="comment">&lt;!-- 1.0 使用bind绑定事件(不会阻止事件冒泡) --&gt;</span></div><div class="line"><span class="comment">&lt;!-- &lt;view class='box1' bindtap='box1click'&gt;外层标签</span></div><div class="line"><span class="comment">&lt;view class='box2' bindtap='box2click'&gt;内部标签</span></div><div class="line"><span class="comment">&lt;view class='box3' bindtap='box3click'&gt;核&lt;/view&gt;</span></div><div class="line"><span class="comment">&lt;/view&gt;</span></div><div class="line"><span class="comment">&lt;/view&gt; --&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 1.0 使用catcth绑定事件(会阻止事件冒泡) --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">'box1'</span> <span class="attr">catchtap</span>=<span class="string">'box1click'</span>&gt;</span>外层标签</div><div class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">'box2'</span> <span class="attr">catchtap</span>=<span class="string">'box2click'</span>&gt;</span>内部标签</div><div class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">'box3'</span> <span class="attr">catchtap</span>=<span class="string">'box3click'</span>&gt;</span>核<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"></div><div class="line">//wxss文件中的内容</div><div class="line">.box1&#123;</div><div class="line">  width: 500rpx;</div><div class="line">  height: 300rpx;</div><div class="line">  background: red</div><div class="line">&#125;</div><div class="line"></div><div class="line">.box2&#123;</div><div class="line">  width: 400rpx;</div><div class="line">  height: 200rpx;</div><div class="line">  background: green</div><div class="line">&#125;</div><div class="line"></div><div class="line">.box3&#123;</div><div class="line">  width: 100rpx;</div><div class="line">  height: 100rpx;</div><div class="line">  background: red</div><div class="line">&#125;</div><div class="line"></div><div class="line">//js文件中的内容</div><div class="line">Page(&#123;</div><div class="line">  data: &#123;&#125;,</div><div class="line">  box1click:function()&#123;</div><div class="line">    console.log("box1click");</div><div class="line">  &#125;,</div><div class="line">  box2click: function () &#123;</div><div class="line">    console.log("box2click");</div><div class="line">  &#125;,</div><div class="line">  box3click: function () &#123;</div><div class="line">    console.log("box3click");</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<h4 id="2-0-事件对象"><a href="#2-0-事件对象" class="headerlink" title="2.0 事件对象"></a>2.0 事件对象</h4><p><span style="color:#f05">当组件上绑定的事件被触发后逻辑层对应的事件处理函数将接受到一个事件对象(events)</span>,在事件处理函数中我们可以提供一个形参并通过该参数获取此事件对象。</p>
<p>事件对象的内容主要由<strong>基础事件对象属性(<code>BaseEvent</code>)</strong>、<strong>自定义事件对象属性(<code>CustomEvent</code>)</strong>和<strong>触摸事件对象属性(<code>TouchEvent</code>)</strong>三部分组成。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">//wxml文件</div><div class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">bindtap</span>=<span class="string">'click'</span>&gt;</span>我是view<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"></div><div class="line">//js文件</div><div class="line">Page(&#123;</div><div class="line">  click:function(event)&#123;</div><div class="line">    console.log(event);   //打印当前的事件对象</div><div class="line">    console.log(JSON.stringify(event,null,4));  //把当前的事件对象转换为JSON打印</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<p><img src="https://github.com/flowerField/Source/blob/master/Blog/wx19.png?raw=true"></p>
<p>这里列出通过组件中<code>data-*属性</code>来给逻辑层事件处理函数传递数据的示例代码。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">//wxml文件内容</div><div class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">data-id</span>=<span class="string">'123'</span> <span class="attr">data-index</span>=<span class="string">'22'</span> <span class="attr">bindtap</span>=<span class="string">'click'</span>&gt;</span>我是view<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"></div><div class="line">//js文件内容</div><div class="line">Page(&#123;</div><div class="line">  click:function(event)&#123;</div><div class="line">    console.log(JSON.stringify(event.currentTarget.dataset));</div><div class="line">  &#125;&#125;)</div><div class="line"></div><div class="line">//打印输出内容</div><div class="line">&#123;"id":"123","index":"22"&#125;</div></pre></td></tr></table></figure></p>
</div></article></div></main><footer><div class="paginator"><a href="/2018/09/27/微信小程序系列[08]-模板的基本使用和引入/" class="prev">上一篇</a><a href="/2018/09/25/微信小程序系列[06]-数据的绑定和基础指令/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2018 <a href="https://weibo.com/u/3800117445">文顶顶</a> &nbsp;☁ 全站字数统计193.5k(字)</p><!--p © #{year} #[a(href=config.url)!= config.author], powered by #[a(href=hexoURL, target="_blank") Hexo] and #[a(href=apolloURL, target="_blank") hexo-theme-apollo].--></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>