<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> javaScript系列 [06]-javaScript和神秘的this · 花田半亩</title><meta name="description" content="javaScript系列 [06]-javaScript和神秘的this - 文顶顶"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/logo.jpeg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://weibo.com/u/3800117445/atom.xml" title="花田半亩"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/白菜.jpeg" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">文顶顶的BLOG</a></li><li class="nav-list-item"><a href="https://www.cnblogs.com/wendingding/" target="_blank" class="nav-list-link">博客园</a></li><li class="nav-list-item"><a href="https://github.com/flowerField" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="http://blog.sina.com.cn/u/1910914290" target="_blank" class="nav-list-link">花田半亩</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">javaScript系列 [06]-javaScript和神秘的this</h1><div class="post-info">May 11, 2018</div><div class="post-content"><blockquote>
<p>在<a href="http://wendingding.com/2018/04/11/javaScript%E7%B3%BB%E5%88%97%20[01]-javaScript%E5%87%BD%E6%95%B0%E5%9F%BA%E6%9C%AC/" target="_blank" rel="external">javaScript系列 [01]-javaScript函数基础</a>这篇文章中我已经简单介绍了JavaScript语言在函数使用中this的指向问题，虽然篇幅不长，但其实最重要的部分已经讲清楚了，这篇文章我们来单独谈一谈神秘的this，或者叫<code>怎么也搞不清楚的指天指地指空气的this</code>。</p>
</blockquote>
<h4 id="1-1-this简单说明"><a href="#1-1-this简单说明" class="headerlink" title="1.1 this简单说明"></a>1.1 this简单说明</h4><p><strong>this</strong>关键字被认为是JavaScript语言中最复杂的机制之一，跟this相关的知识很多开发者往往总是一知半解，更有甚者很多人完全搞不懂也不愿意去搞懂跟this相关的内容，在必须要用到的时候宁愿选择在代码中总是使用临时打印验证的方式来探知this的指向。这是现实，也许因为他们觉得跟this有关的这一切都混乱不堪，各种文档晦涩难懂，this的指向好似没有固定的套路，总是变来变去难以捉摸。其实，this原本并没有那么复杂，它就是个被自动定义在函数作用域中的变量，总是指向某个特定的“对象”。接下来，我们将尝试用这样一篇文章来讲清楚跟this有关的以下问题：</p>
<blockquote>
<p>❐   this 是什么？<br>❐   为什么要使用this?<br>❐   this指向谁？<br>❐   this绑定的优先级关系<br>❐   this固定规则外的注意事项<br>❐   this的几个使用场景介绍</p>
</blockquote>
<p><span style="border:1px solid #000"><strong>&nbsp; &nbsp;this是什么?&nbsp; &nbsp;</strong></span></p>
<p>在声明函数的时候，除了声明时定义的形式参数外，每个函数还接受两个附加的参数：<code>this</code>和<code>arguments</code>。其中arguments是一个类似于数组的结构，保存了函数调用时传递的所有实际参数，arguments这个参数让我们有能力编写<code>能够接受任意个数参数的</code>函数。参数this在面向对象编程中非常重要，它总是指向一个“特定的对象”，至于这个特定的对象是谁通常取决于函数的调用模式。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>);  <span class="comment">//默认指向window</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> res = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="built_in">arguments</span>.length; i++) &#123;</div><div class="line">           res += <span class="built_in">arguments</span>[i];</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>);</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//调用sum函数的时候，this默认指向window</span></div><div class="line">    <span class="built_in">console</span>.log(sum(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)); <span class="comment">//计算输入参数的累加和，结果为10</span></div><div class="line">&lt;<span class="regexp">/script&gt;</span></div></pre></td></tr></table></figure>
<p>现在我们知道和this有关的关键信息是：</p>
<p><span style="color:#F55">① this是JavaScript中所有函数的隐藏参数之一，因此每个函数中都能访问this。</span><br><span style="color:#F55">② 函数中的this总是指向一个特定对象，该对象具体取决于函数的调用模式。</span></p>
<div class="tip"><br>说明：在script标签中我们也可以直接访问this，它通常总是指向widow，我们讨论的this主要特指函数内部(函数体)的this。<br></div>

<p><span style="border:1px solid #000"><strong>&nbsp; &nbsp;为什么要使用this?&nbsp; &nbsp;</strong></span></p>
<p><span style="color:#F55">this提供一种更优雅的方式来隐士的传递一个对象引用，因为拥有this，所以我们可以把API设计得更加的简洁并且易于复用。简单点说，那就是this可以帮助我们省略参数。</span></p>
<p>我们可以通过以下两个代码片段来加深对this使用的理解。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**代码 [ 01 ]**/</span></div><div class="line"><span class="keyword">var</span> personOne = &#123;<span class="attr">name</span>:<span class="string">"文顶顶"</span>,<span class="attr">contentText</span>:<span class="string">"天王盖地虎 小鸡炖蘑菇"</span>&#125;;</div><div class="line"><span class="keyword">var</span> personTwo = &#123;<span class="attr">name</span>:<span class="string">"燕赤霞"</span>,<span class="attr">contentText</span>:<span class="string">"天地无极 乾坤借法 急急如令令"</span>&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">speak</span>(<span class="params">obj</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(obj.name+<span class="string">"口诀是："</span> + getContentText(obj));;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getContentText</span>(<span class="params">obj</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> obj.contentText + <span class="string">"哒哒哒哒~"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">speak(personOne);  <span class="comment">//文顶顶口诀是：天王盖地虎 小鸡炖蘑菇哒哒哒哒~</span></div><div class="line">speak(personTwo);  <span class="comment">//燕赤霞口诀是：天地无极 乾坤借法 急急如令令哒哒哒哒~</span></div><div class="line"></div><div class="line">getContentText(personOne);</div><div class="line">getContentText(personTwo);</div></pre></td></tr></table></figure>
<p><strong>代码说明：</strong>上面的代码声明了两个函数：speak和getContentText，这两个函数都需要访问对象中的属性，上面的代码中每个函数都接收一个obj对象作为参数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**代码 [ 02 ]**/</span></div><div class="line"><span class="keyword">var</span> personOne = &#123;<span class="attr">name</span>:<span class="string">"文顶顶"</span>,<span class="attr">contentText</span>:<span class="string">"天王盖地虎 小鸡炖蘑菇"</span>&#125;;</div><div class="line"><span class="keyword">var</span> personTwo = &#123;<span class="attr">name</span>:<span class="string">"燕赤霞"</span>,<span class="attr">contentText</span>:<span class="string">"天地无极 乾坤借法 急急如令令"</span>&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">speak</span>(<span class="params"></span>) </span>&#123;</div><div class="line">       <span class="built_in">console</span>.log(<span class="keyword">this</span>.name+<span class="string">"口诀是："</span> + getContentText.call(<span class="keyword">this</span>));;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getContentText</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.contentText + <span class="string">"哒哒哒哒~"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">speak.call(personOne);  <span class="comment">//文顶顶口诀是：天王盖地虎 小鸡炖蘑菇哒哒哒哒~</span></div><div class="line">speak.call(personTwo);  <span class="comment">//燕赤霞口诀是：天地无极 乾坤借法 急急如令令哒哒哒哒~</span></div><div class="line"></div><div class="line">getContentText.call(personOne);  <span class="comment">//天王盖地虎 小鸡炖蘑菇哒哒哒哒~</span></div><div class="line">getContentText.call(personTwo);  <span class="comment">//天地无极 乾坤借法 急急如令令哒哒哒哒~</span></div></pre></td></tr></table></figure>
<p><strong>代码说明：</strong>完成相同的功能，还是两个同样的函数，区别在于我们借助this省略掉了函数必须要传递的对象参数，实现更优雅。而且如果你的代码越来越复杂，那么需要显示传递的上下文对象会让代码变得越来越混乱而难以维护，使用this则不会如此。</p>
<hr>
<ul>
<li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="external">文顶顶</a> ~ <a href="http://wendingding.com" target="_blank" rel="external">文顶顶的个人博客_花田半亩</a></li>
<li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="external">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">文顶顶</a></li>
<li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="external">文顶顶</a></li>
</ul>
<p><img src="https://github.com/flowerField/Source/blob/master/Blog/zanshang.jpeg?raw=true" width="180" height="180"></p>
</div></article></div></main><footer><div class="paginator"><a href="/2018/05/11/网络编程系列 同源策略和跨域请求/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2018 <a href="https://weibo.com/u/3800117445">文顶顶</a></p><!--p © #{year} #[a(href=config.url)!= config.author], powered by #[a(href=hexoURL, target="_blank") Hexo] and #[a(href=apolloURL, target="_blank") hexo-theme-apollo].--></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>