<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> javaScript系列 [08]-javaScript和JSON (进阶) · 花田半亩</title><meta name="description" content="javaScript系列 [08]-javaScript和JSON (进阶) - 文顶顶"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/logo.jpeg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://weibo.com/u/3800117445/atom.xml" title="花田半亩"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/鲸鱼.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">文顶顶的BLOG</a></li><li class="nav-list-item"><a href="/tags/" target="_self" class="nav-list-link">标签</a></li><li class="nav-list-item"><a href="https://www.cnblogs.com/wendingding/" target="_blank" class="nav-list-link">博客园</a></li><li class="nav-list-item"><a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place" target="_blank" class="nav-list-link">微博</a></li><li class="nav-list-item"><a href="http://blog.sina.com.cn/u/1910914290" target="_blank" class="nav-list-link">花田半亩</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">javaScript系列 [08]-javaScript和JSON (进阶)</h1><div class="post-info">Nov 11, 2018<span class="post-count"></span> ✧ 字数统计:2,129(字) &nbsp;&nbsp; ♨︎ 阅读时长:8(分钟)</div><div class="post-content"><p><div class="tip">在<a href="http://wendingding.com/2018/04/16/javaScript%E7%B3%BB%E5%88%97%20[05]-javaScript%E5%92%8CJSON/" target="_blank" rel="external">javaScript和JSON</a>这篇博文中已经对JSON的基础知识进行了系统的介绍，此文是JSON知识的<strong>进阶内容</strong>，本文输出和JSON有关的以下内容：</div></p>
<blockquote>
<p>❐  JSON核心<br>❐  JSON的搜索<br>❐  JSON的转换<br>❐  JSON的校验(JSON Schema)</p>
</blockquote>
<h3 id="JSON核心"><a href="#JSON核心" class="headerlink" title="JSON核心"></a>JSON核心</h3><p>JSON是一种数据交换格式，是当前网络通信中使用的主流数据格式。</p>
<p><span style="color:#000">JSON本身并不局限(依赖)于某项特定的技术，非私有且可移植，几乎所有的现代编程语言(<code>javaScript</code> | <code>java</code> | <code>Ruby</code> | <code>C#</code> | <code>PHP</code> | <code>Object-C</code>等)和平台都支持对JSON数据的序列化和反序列化处理，JSON主要应用在<strong><code>网络通信的数据格式</code>、<code>Node用来存储项目元数据</code>、<code>Kafka类似的消息平台</code></strong>以及<strong><code>MongoDB等NoSQL数据库</code></strong>中。</span></p>
<p><span style="border:1px solid #000;padding:5px 20px;"><strong>JSON流行的主要原因</strong></span></p>
<ul>
<li><strong>JavaScript语言的复兴和崛起</strong>。</li>
<li><strong>JSON自身数据结构的简洁和紧凑特性</strong>。</li>
<li><strong>基于JSON的RESTful API呈现大规模增长</strong>。</li>
<li><strong>Ecma国际和IETF相关的标准化工作让JSON获得行业认可</strong>。</li>
</ul>
<p>JSON的作者<a href="https://en.wikipedia.org/wiki/Douglas_Crockford" target="_blank" rel="external">Douglas Crockford</a>在创作时借鉴了JavaScript对象字面量的语法，也就是说JSON本身就是JavaScript对象字面量表示法的一个子集和JavaScript开发能够无缝融合，而JavaScript编程语言的复兴和崛起(<code>前端 + Node后端生态</code>)极大的推动了JSON的流行。</p>
<p>JSON的数据表示方式非常简洁，结构紧凑易于阅读而且其本身的结构与高级编程语言中的<code>对象|字典|数组</code>结构天然一致，与XML相比更适合面向对象的设计和开发。此外，JSON格式的文档通常比相同内容的XML文档更小，因此在进行网络传输和处理的时候更快、效率更高，JSON本身的这些特性加上相关技术环境的发展让它逐步替代XML成为互联网中主要的数据交换格式。 </p>
<p>近些年，基于JSON的RESTful API呈现大规模爆炸式增长，包括LinkedIn、Github、Twitter、Facebook、Tumblr和Amazon等公司都提供基于JSON的RESTful API(<strong><code>备注</code></strong> 相关API可以访问<a href="https://www.programmableweb.com" target="_blank" rel="external">programmableweb</a>查询)。</p>
<p>JSON的标准化(成为一项技术标准)，让JSON获得了行业内的认可，下面简单列出主要的标准化进程。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">2001 年 JSON由Douglas Crockford提出。</div><div class="line">2006 年 JSON由IETF通过RFC 4627进行首次标准化。</div><div class="line">2013 年 Ecma国际通过ECMA 404 将JSON正式标准化。</div><div class="line">2014 年 Tim Bray发布了RFC 7158和RFC 7159作为原始标准的改进版本(主要修正了4627标准中的一些错误)。</div></pre></td></tr></table></figure></p>
<p><span style="border:1px solid #000;padding:5px 20px;"><strong>JSON数值的类型</strong></span></p>
<p>JSON数值的类型主要指的是在JSON文档中，键值对冒号(:)后侧值的数据类型，主要包括：</p>
<ul>
<li><span style="color:#196"><strong>null</strong></span></li>
<li><span style="color:#196"><strong>数值</strong></span></li>
<li><span style="color:#196"><strong>对象</strong></span></li>
<li><span style="color:#196"><strong>数组</strong></span></li>
<li><span style="color:#196"><strong>字符串</strong></span></li>
<li><span style="color:#196"><strong>布尔值</strong></span></li>
</ul>
<p><strong><code>null</code></strong>是JSON中的一个特殊值，用来表示某个key(属性)没有值用作占位符，注意不能由引号括起来。</p>
<p><strong><code>数值</code></strong>遵循JavaScript双精度浮点数格式，支持指数形式，但仅支持十进制数不支持8进制和16进制数。</p>
<p><strong><code>对象</code></strong>由 { 和 } 把键值对(key-value)括起来，允许设置为空对象，可以内嵌在其他的对象或者是数组中。</p>
<p><strong><code>数组</code></strong>由 [ 和 ] 把元素括起来，允许设置为空数组且不限制类型，可以内嵌在其他的对象或者是数组中。</p>
<p><strong><code>字符串</code></strong>由包含在双引号间的N(&gt;=0)个Unicode字符组成可包含由转义字符，但<span style="color:#972">单引号字符串是非法的</span>。</p>
<p><strong><code>布尔值</code></strong>只存在true和false这两种值，且不能用引号把它们括起来，需注意JSON中没有为<strong>undefined</strong>值。</p>
<p><span style="border:1px solid #000;padding:5px 20px;"><strong>More …</strong></span></p>
<p><strong>版本 ➤</strong>JSON的核心标准不会再有新的版本，适用”无版本”理念。</p>
<p><strong>类型 ➤</strong>JSON数据在文件系统中存储的标准文件类型为.json，IANA为JSON文档指定的MIME(媒体类型)为<span style="color:red">application/json</span>。</p>
<p><strong>缩进 ➤</strong>JSON的编码规范并不存在与JSON数据缩进相关的话题，主要因为JSON本身是一种序列化格式而非呈现格式，所以缩进对JSON本身而言意义不大，在优化JSON现实的时候，常见的缩进方案是两格缩进或四格缩进。</p>
<p><strong>工具 ➤</strong> </p>
<p>在线生成合法JSON文档的工具(1)  <a href="http://jsonmate.com" target="_blank" rel="external">JSONmate</a><br>在线生成合法JSON文档的工具(2)  <a href="https://jsoneditoronline.org" target="_blank" rel="external">JSON Editor Online</a><br>快速生成大量测试JSON数据的工具 <a href="https://www.json-generator.com" target="_blank" rel="external">JSON Generator</a><br>在线对复杂JSON数据格式化的工具 <a href="http://tool.oschina.net/codeformat/json" target="_blank" rel="external">JSON 在线格式化</a><br>在线校验JSON文档是否合法的工具(1) <a href="http://json-schema.org" target="_blank" rel="external">JSON Schema</a><br>在线校验JSON文档是否合法的工具(2) <a href="http://jsonvalidate.com" target="_blank" rel="external">JSON Validate</a></p>
<h3 id="JSON-Schema"><a href="#JSON-Schema" class="headerlink" title="JSON Schema"></a>JSON Schema</h3><p><a href="http://json-schema.org" target="_blank" rel="external">JSON Schema</a>是对JSON文档中的内容、结构和格式进行的声明，用于校验JSON文档。区别于普通的JSON校验工具，JSON Schema能够对JSON文档执行<strong>语法校验</strong>和严格的<strong>语义校验</strong>。<a href="http://json-schema.org" target="_blank" rel="external">JSON Schema</a>这种能够用于校验JSON文档内容和语义的工具能够有效提供服务的安全性，在消息系统中的应用能够确保数据格式的正确性，在API设计领域还能够帮助定义API协议等。</p>
<p><strong>建议</strong> 从零开始对JSON文档的内容进行声明非常麻烦也没有必要，建议先使用<a href="https://www.jsonschema.net" target="_blank" rel="external">JSONSchema.net网站</a>来根据已有的JSON文档生成对应的Schema文档，然后再根据具体的校验规则来逐步修缮。</p>
<p><span style="border:1px solid #000;padding:5px 20px;"><strong>基本示例</strong></span></p>
<p>这里先给出一份简单的JSON文档和对该文档的JSON Schema描述，然后再介绍<code>JSON Schema的核心关键词</code>和具体规则。<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"># 文件名 demo.json 注意该行不作为json文件的内容</div><div class="line"></div><div class="line">&#123;</div><div class="line">    <span class="attr">"name"</span>: <span class="string">"wendingding"</span>,</div><div class="line">    <span class="attr">"age"</span>: <span class="number">18</span>,</div><div class="line">    <span class="attr">"email"</span>: <span class="string">"wendingding_ios@126.com"</span>,</div><div class="line">    <span class="attr">"height"</span>: <span class="number">1.73</span>,</div><div class="line">    <span class="attr">"isGoodMan"</span>: <span class="literal">true</span>,</div><div class="line">    <span class="attr">"tags"</span>: [</div><div class="line">        <span class="string">"javaScript"</span>,</div><div class="line">        <span class="string">"object-C"</span>,</div><div class="line">        <span class="string">"C++"</span>,</div><div class="line">        <span class="string">"swift"</span>,</div><div class="line">        <span class="string">"php"</span></div><div class="line">    ],</div><div class="line">    <span class="attr">"car"</span>: &#123;</div><div class="line">        <span class="attr">"type"</span>: <span class="string">"A"</span>,</div><div class="line">        <span class="attr">"number"</span>: <span class="string">"粤A 66666"</span>,</div><div class="line">        <span class="attr">"price"</span>: <span class="number">21344.88</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"># 文件名 demo-schema.json 注意该行不作为json文件的内容</div><div class="line">&#123;</div><div class="line">  <span class="attr">"$schema"</span>: <span class="string">"http://json-schema.org/draft-07/schema#"</span>,</div><div class="line">  <span class="attr">"type"</span>: <span class="string">"object"</span>,</div><div class="line">  <span class="attr">"required"</span>: [<span class="string">"name"</span>,<span class="string">"age"</span>,<span class="string">"email"</span>,<span class="string">"height"</span>,<span class="string">"isGoodMan"</span>,<span class="string">"tags"</span>,<span class="string">"car"</span>],</div><div class="line">  <span class="attr">"properties"</span>: &#123;</div><div class="line">    <span class="attr">"name"</span>: &#123;</div><div class="line">      <span class="attr">"type"</span>: <span class="string">"string"</span>,</div><div class="line">      <span class="attr">"examples"</span>: [ <span class="string">"wendingding"</span> ],</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"age"</span>: &#123;</div><div class="line">      <span class="attr">"type"</span>: <span class="string">"integer"</span>,</div><div class="line">      <span class="attr">"examples"</span>: [ <span class="number">18</span> ]</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"email"</span>: &#123;</div><div class="line">      <span class="attr">"type"</span>: <span class="string">"string"</span>,</div><div class="line">      <span class="attr">"examples"</span>: [<span class="string">"wendingding_ios@126.com"</span>],</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"height"</span>: &#123;</div><div class="line">      <span class="attr">"type"</span>: <span class="string">"number"</span>,</div><div class="line">      <span class="attr">"examples"</span>: [ <span class="number">1.73</span> ]</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"isGoodMan"</span>: &#123;</div><div class="line">      <span class="attr">"type"</span>: <span class="string">"boolean"</span>,</div><div class="line">      <span class="attr">"examples"</span>: [ <span class="literal">true</span>]</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"tags"</span>: &#123;</div><div class="line">      <span class="attr">"type"</span>: <span class="string">"array"</span>,</div><div class="line">      <span class="attr">"items"</span>: &#123;</div><div class="line">        <span class="attr">"type"</span>: <span class="string">"string"</span>,</div><div class="line">        <span class="attr">"examples"</span>: [<span class="string">"javaScript"</span>, <span class="string">"object-C"</span>, <span class="string">"C++"</span>,<span class="string">"swift"</span>,<span class="string">"php"</span>]  </div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"car"</span>: &#123;</div><div class="line">      <span class="attr">"type"</span>: <span class="string">"object"</span>,</div><div class="line">      <span class="attr">"required"</span>: [<span class="string">"type"</span>,<span class="string">"number"</span>, <span class="string">"price"</span>],</div><div class="line">      <span class="attr">"properties"</span>: &#123;</div><div class="line">        <span class="attr">"type"</span>: &#123;</div><div class="line">          <span class="attr">"type"</span>: <span class="string">"string"</span>,</div><div class="line">          <span class="attr">"examples"</span>: [<span class="string">"A"</span>] </div><div class="line">        &#125;,</div><div class="line">        <span class="attr">"number"</span>: &#123;</div><div class="line">          <span class="attr">"type"</span>: <span class="string">"string"</span>,</div><div class="line">          <span class="attr">"examples"</span>: [<span class="string">"粤A 66666"</span>]   </div><div class="line">        &#125;,</div><div class="line">        <span class="attr">"price"</span>: &#123;</div><div class="line">          <span class="attr">"type"</span>: <span class="string">"number"</span>,</div><div class="line">          <span class="attr">"examples"</span>: [<span class="number">21344.88</span> ] </div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>推荐使用命令行工具的validate模块来使用Schema对准备好的JSON文档进行校验，列出执行细节：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">wendingding$ npm install -g ujs-jsonvalidate</div><div class="line">/usr/<span class="built_in">local</span>/bin/validaten -&gt; /usr/<span class="built_in">local</span>/lib/node_modules/ujs-jsonvalidate/bin/validaten</div><div class="line">/usr/<span class="built_in">local</span>/bin/validate -&gt; /usr/<span class="built_in">local</span>/lib/node_modules/ujs-jsonvalidate/bin/validate</div><div class="line">+ ujs-jsonvalidate@0.1.2</div><div class="line">added 4 packages <span class="keyword">in</span> 7.353s</div><div class="line">wendingding$ validate demo.json demo-schema.json </div><div class="line">JSON content <span class="keyword">in</span> file demo.json is valid</div></pre></td></tr></table></figure></p>
<p>因为在Schema文档中name字段是必要的，这里尝试删除demo.json文档中的<code>name:&quot;wendingding&quot;</code>部分，然后重新执行校验会发现提示错误信息。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">wendingding$ cat demo.json</div><div class="line">&#123;</div><div class="line">  <span class="string">"age"</span>: 18,</div><div class="line">  <span class="string">"email"</span>: <span class="string">"wendingding_ios@126.com"</span>,</div><div class="line">  <span class="string">"height"</span>: 1.73,</div><div class="line">  <span class="string">"isGoodMan"</span>: <span class="literal">true</span>,</div><div class="line">  <span class="string">"tags"</span>: [</div><div class="line">    <span class="string">"javaScript"</span>,</div><div class="line">    <span class="string">"object-C"</span>,</div><div class="line">    <span class="string">"C++"</span>,</div><div class="line">    <span class="string">"swift"</span>,</div><div class="line">    <span class="string">"php"</span></div><div class="line">  ],</div><div class="line">  <span class="string">"car"</span>: &#123;</div><div class="line">    <span class="string">"type"</span>: <span class="string">"A"</span>,</div><div class="line">    <span class="string">"number"</span>: <span class="string">"粤A 66666"</span>,</div><div class="line">    <span class="string">"price"</span>: 21344.88</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">wendingding$ validate demo.json demo-schema.json </div><div class="line">Invalid: Missing required property: name</div><div class="line">JSON Schema element: /required/0</div><div class="line">JSON Content path:</div></pre></td></tr></table></figure></p>
<p><span style="border:1px solid #000;padding:5px 20px;"><strong>核心关系词说明</strong></span></p>
<p><strong><code>type</code></strong> 声明对应字段的类型。<br><strong><code>pattern</code></strong> 使用正则表达式来限定字段的值。<br><strong><code>properties</code></strong> 声明对象中的字段，其中包含具体字段的type值等信息。<br><strong><code>$schema</code></strong> 声明遵循的JSON Schema标准版本，校验文档时使用该版本的规则。</p>
<p><strong><code>items</code></strong> 如果字段是数组类型(array)，那么对数组元素的类型等进行限定。<br><strong><code>minimum | maximum</code></strong> 如果是数值类型(number)，那么限定其取值的范围。<br><strong><code>minItems | maxItems</code></strong> 用于校验数组成员的数目，设定最小数目和最大数目。<br><strong><code>examples</code></strong> 提供该字段对应值的示例，在创建schema文档的时候通常根据JSON模板文件的内容生成。<br><strong><code>enum</code></strong> 定义几个固定的枚举值来限制数组元素的取值，即数组的元素值只能是enum限定集合中的数据。</p>
<p><strong><code>additionalProperties</code></strong> 将该字段设置为false可以禁止JSON文档当前节点中出现额外的字段。<br><strong><code>required</code></strong> 该数组用于声明JSON文档中所有的必需字段，即必需要包含这些字段，否则将视为非法文档。<br><strong><code>dependencies</code></strong> 设置字段的依赖关系，即JSON文档中出现了某个字段(比如XXX)，那么另外一个字段必须同时出现(比如xxx)。</p>
<hr>
<ul>
<li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="external">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="external">花田半亩</a></li>
<li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="external">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li>
<li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="external">文顶顶</a></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/2018/10/24/微信小程序实战[03]-衣橱商城首页功能实现/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2018 <a href="https://weibo.com/u/3800117445">文顶顶</a> &nbsp;☁ 全站字数统计213.7k(字)</p><!--p © #{year} #[a(href=config.url)!= config.author], powered by #[a(href=hexoURL, target="_blank") Hexo] and #[a(href=apolloURL, target="_blank") hexo-theme-apollo].--></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>