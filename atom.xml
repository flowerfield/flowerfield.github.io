<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>花田半亩</title>
  
  <subtitle>文顶顶的Blog</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://weibo.com/u/3800117445/"/>
  <updated>2020-04-27T16:36:46.848Z</updated>
  <id>https://weibo.com/u/3800117445/</id>
  
  <author>
    <name>文顶顶</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>奇怪问题 - 校验括号是否匹配</title>
    <link href="https://weibo.com/u/3800117445/2020/04/28/%E5%A5%87%E6%80%AA%E9%97%AE%E9%A2%98-%E6%A0%A1%E9%AA%8C%E6%8B%AC%E5%8F%B7%E6%98%AF%E5%90%A6%E5%8C%B9%E9%85%8D/"/>
    <id>https://weibo.com/u/3800117445/2020/04/28/奇怪问题-校验括号是否匹配/</id>
    <published>2020-04-27T16:00:09.000Z</published>
    <updated>2020-04-27T16:36:46.848Z</updated>
    
    <content type="html"><![CDATA[<div class="titleX" style="background:#4fc08d;color:white"><strong>问题：给出下面的字符串，请编写函数来校验括号是否匹配，要求函数尽可能通用。</strong></div>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> testString = <span class="string">"(()()()()"</span>;</span><br></pre></td></tr></table></figure><div class="titleX" style="background:orange;color:white"><strong>方案</strong></div><p><strong><code>说明</code></strong> 类似问题使用栈数据结构的方式来进行匹配会比较合理。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">/* 1.提供简单的栈结构 Class */</span></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Stack</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">        <span class="keyword">this</span>.data = [];</span><br><span class="line">        <span class="keyword">this</span>.top = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    push(ele) &#123;</span><br><span class="line">        <span class="keyword">this</span>.data[<span class="keyword">this</span>.top++] = ele;</span><br><span class="line">    &#125;</span><br><span class="line">    pop() &#123;</span><br><span class="line">        <span class="keyword">this</span>.top--;</span><br><span class="line">        <span class="keyword">this</span>.data.pop();</span><br><span class="line">    &#125;</span><br><span class="line">    peek() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.data[<span class="keyword">this</span>.top - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    clear() &#123;</span><br><span class="line">        <span class="keyword">this</span>.top = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.data = [];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 2.括号字符串匹配校验函数 */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">matching</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">   stack.clear();                                <span class="comment">/* 清栈操作 */</span></span><br><span class="line">   str = str.trim();                             <span class="comment">/* 字符串清理 */</span></span><br><span class="line">   <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; str.length; i++) &#123;        <span class="comment">/* 遍历字符串 */</span></span><br><span class="line">       <span class="keyword">if</span> (str[i] == <span class="string">" "</span>) <span class="keyword">continue</span>;              <span class="comment">/* 如果当前字符是空格则跳过 */</span></span><br><span class="line">       <span class="keyword">if</span> (stack.peek() == <span class="string">"("</span> &amp;&amp; str[i] == <span class="string">")"</span>) &#123;</span><br><span class="line">           stack.pop();                          <span class="comment">/* 若匹配则执行出栈操作 */</span></span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           stack.push(str[i]);                   <span class="comment">/* 不匹配则执行入栈操作 */</span></span><br><span class="line">       &#125;</span><br><span class="line">       <span class="built_in">console</span>.log(i, stack.data)                <span class="comment">/* 打印检查栈内数据结构 */</span></span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> stack.top == <span class="number">0</span>;                        <span class="comment">/* 返回结果 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 3.测试数据 */</span></span><br><span class="line"><span class="keyword">let</span> res1 = matching(<span class="string">"()"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"_______"</span>);</span><br><span class="line"><span class="keyword">let</span> res2 = matching(<span class="string">"("</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"_______"</span>);</span><br><span class="line"><span class="keyword">let</span> res3 = matching(<span class="string">"()("</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"_______"</span>);</span><br><span class="line"><span class="keyword">let</span> res4 = matching(<span class="string">"( (())  ()()  )  "</span>);</span><br><span class="line"><span class="built_in">console</span>.log(res1, res2, res3, res4);</span><br></pre></td></tr></table></figure></p><p>打印参考：<br><img src="https://github.com/flowerField/Source/blob/master/Blog/khpp.png?raw=true"></p><p>在上面代码中<code>matching</code>函数中通过普通 for 循环遍历字符串，尝试使用<code>forEach</code>遍历调整代码如下。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">matching</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    stack.clear();                      <span class="comment">/* 清栈操作 */</span></span><br><span class="line">    str = str.trim();                   <span class="comment">/* 清理字符串前后可能存在的空格 */</span></span><br><span class="line">    <span class="keyword">if</span> (str[<span class="number">0</span>] == <span class="string">")"</span>) <span class="keyword">return</span> <span class="literal">false</span>;    <span class="comment">/* 如果开始字符为)那么直接结束 */</span></span><br><span class="line"></span><br><span class="line">    [...str].forEach(<span class="function">(<span class="params">s, i</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (s == <span class="string">" "</span>) <span class="keyword">return</span>;           <span class="comment">/* 如果当前字符是空格，那么忽略处理 */</span></span><br><span class="line">        <span class="comment">/* 如果当前字符和栈顶字符匹配，那么就出栈，否则执行入栈操作 */</span></span><br><span class="line">        (stack.peek() == <span class="string">"("</span> &amp;&amp; s == <span class="string">")"</span>) ? stack.pop(): stack.push(s);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">/* 如果栈内没有数据(都消除了)，那么表示()总是合法成对匹配 */</span></span><br><span class="line">    <span class="keyword">return</span> stack.top == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><ul><li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="noopener">花田半亩</a></li><li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="noopener">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li><li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;titleX&quot; style=&quot;background:#4fc08d;color:white&quot;&gt;&lt;strong&gt;问题：给出下面的字符串，请编写函数来校验括号是否匹配，要求函数尽可能通用。&lt;/strong&gt;&lt;/div&gt;

  &lt;figure class=&quot;hi
      
    
    </summary>
    
    
      <category term="奇怪问题" scheme="https://weibo.com/u/3800117445/tags/%E5%A5%87%E6%80%AA%E9%97%AE%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>杂谈书坊-“陷王于恶”</title>
    <link href="https://weibo.com/u/3800117445/2020/03/28/%E6%9D%82%E8%B0%88%E4%B9%A6%E5%9D%8A-%E9%99%B7%E7%8E%8B%E4%BA%8E%E6%81%B6%E5%92%8C%E8%90%A5%E6%83%91%E8%AF%B8%E4%BE%AF/"/>
    <id>https://weibo.com/u/3800117445/2020/03/28/杂谈书坊-陷王于恶和营惑诸侯/</id>
    <published>2020-03-28T15:58:37.000Z</published>
    <updated>2020-03-30T01:01:04.887Z</updated>
    
    <content type="html"><![CDATA[<p><a href="">“陷王于恶”</a> 这个典故出自汉书,叙述了海昏侯<strong>刘贺</strong>被霍光废黜的故事。</p><p><strong>贺者，武帝孙，昌邑哀王子也。既至，即位，行淫乱。光忧懑，独以问所亲故吏大司农田延年。延年曰：“将军为国柱石，审此人不可，何不建白太后，更选贤而立之？” 光曰：“今欲如是，于古尝有此否？” 延年曰：“伊尹相殷，废太甲以安宗庙，后世称其忠。将军若能行此，亦汉之伊尹也”。光乃引延年给事中，阴与车骑将军张安世图计，遂召丞相、御史、将军、列侯、中二千石、大夫、博士会议未央宫。光曰：“昌邑王行昏乱，恐危社稷，如何？” 群臣皆惊鄂失色，莫敢发言，但唯唯而已。田延年前，离席按剑，曰：“先帝属将军以幼孤，寄将军以天下，以将军忠贤能安刘氏也。今群下鼎沸，社稷将倾，且汉之传谥常为孝者，以长有天下，令宗庙血食也。如令汉家绝祀，将军虽死，何面目见先帝于地下乎？今日之议，不得旋踵。群臣后应者，臣请剑斩之”。光谢曰：“九卿责光是也。天下匈匈不安，光当受难”。于是议者皆叩头，曰：“万姓之命在于将军，唯大将军令”。</strong></p><p><strong>光即与群臣俱见白太后，具陈昌邑王不可以承宗庙状。皇太后乃车驾幸未央承明殿，诏诸禁门毋内昌邑群臣。王入朝太后还，乘辇欲归温室，中黄门宦者各持门扇，王入，门闭，昌邑群臣不得入。王曰“何为？” 大将军跪曰：“有皇太后诏，毋内昌邑群臣”。王曰：“徐之，何乃惊人如是!” 光使尽驱出昌邑群臣，置金马门外。车骑将军安世将羽林骑收缚二百余人，皆送廷尉诏狱。令故昭帝侍中中臣侍守王。光敕左右：“谨宿卫，卒有物故自裁，令我负天下，有杀主名”。王尚未自知当废，谓左右：“我故群臣从官安得罪，而大将军尽系之乎？” 顷之，有太后诏召王，王闻召，意恐，乃曰：“我安得罪而召我哉!” 太后被珠襦，盛服坐武帐中，侍御数百人皆持兵，期门武士陛戟，陈列殿下。群臣以次上殿，召昌邑王伏前听诏。光与群臣连名奏王，尚书令读奏。</strong></p><p><strong>皇太后诏曰：“可”。光令王起拜受诏，王曰：“闻天子有争臣七人，虽无道不失天下”。光曰：“皇太后诏废，安得天子!” 乃即持其手，解脱其玺组，奉上太后，扶王下殿，出金马门，群臣随送。王西面拜，曰：“愚戆不任汉事”。起就乘舆副车。大将军光送至昌邑邸，光谢曰：“王行自绝于天，臣等驽怯，不能杀身报德。臣宁负王，不敢负社稷。愿王自爱，臣长不复见左右”。光涕泣而去。群臣奏言：“古者废放之人屏于远方，不及以政，请徙王贺汉中房陵县”。太后诏归贺昌邑，赐汤沐邑二千户。<span style="color:red">昌邑群臣坐亡辅导之谊，陷王于恶，光悉诛杀二百余人</span>。出死，号呼市中曰：“当断不断，反受其乱”。</strong></p><p>这段文字记载于《<a href="http://www.oh100.com/peixun/guoxuezhihui/294243.html" target="_blank" rel="noopener">汉书·霍光金日禪传</a>》，完整的记录了大将军霍光废黜刘贺的详细过程。2015年，在江西南昌发现了轰动一时的海昏侯墓，而刘贺正是这海昏侯墓的主人。关于海昏侯墓的相关信息，大家可以查询。</p><p>刘贺是汉武帝的孙子，其父刘髆为昌邑哀王[<code>今山东菏泽</code>]，刘贺在历史上短暂的做过27天皇帝，后因为言行昏(淫)乱被大将军霍光和太后废黜。据记载，刘贺被废的主要原因是先帝刚驾崩棺材都还停放在宫中的时候就迫不及待的和乐人寻欢作乐，被朝臣认为没有“人主之尊”。说起来，我们现在所经历的一些现实就很魔幻了。据说，现在很多地方在治办丧事的时候，都喜欢把丧事办的喜庆风光，因此网络上也流传了很多坟头蹦迪的鬼畜视频出来。这真是，先人的棺材板都还没盖上，后来人就一蹦跳起了三丈高。</p><p>我今天知道这个这个典故，是读了秋原先生著的《乱世靡音》，这本书讲了江湖中“艺人”的生存之道和历史演变，颇有意思。</p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/qy.jpg?raw=true" height="500px"></p><p>古时候，”江湖艺人”的身份低位，仅仅只有少数造诣极高的艺人，才可能得到有限的尊重，不像现在的明星这么风光，他们的身份地位几乎排在最末，甚至连现在的某些平台主播也不如。</p><p>其实，哪怕是最牛逼的艺人(为皇帝和朝臣服务的官伶)，可能下场也比较凄凉。譬如上述<strong>“陷王于恶”</strong>的这两百多人就半数都是“乐人”，他们的结局是被 <strong><span style="color:red"> 悉数诛杀 </span></strong>。</p><p>最后，再贴点学到的新知识。</p><p><a href="">※</a> 献艺和卖艺，前者有很高的雅兴，后者是鄙俗的生意。<br><a href="">※</a> “玩意儿”这个词同”玩艺儿”，指的是稍微有些才能的乞丐。<br><a href="">※</a> 长期以来以艺娱人低人一等。这也是古时候罪犯抄家为什么男的杀头，妻女则送入教坊司的原因。<br><a href="">※</a> 以艺娱人的人被称为乐人或乐工，职业会被编入乐户，算作贱民，而管理乐户的机构就叫做乐府。<br><a href="">※</a> 艺人主要有三种起源分别是“人类古老的祭祀活动、人们对身体残障者的嘲弄以及流民行乞的手段”。</p><hr><ul><li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="noopener">花田半亩</a></li><li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="noopener">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home？from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li><li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;&quot;&gt;“陷王于恶”&lt;/a&gt; 这个典故出自汉书,叙述了海昏侯&lt;strong&gt;刘贺&lt;/strong&gt;被霍光废黜的故事。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;贺者，武帝孙，昌邑哀王子也。既至，即位，行淫乱。光忧懑，独以问所亲故吏大司农田延年。延年曰：“将军为国柱石，审此
      
    
    </summary>
    
    
      <category term="读书笔记" scheme="https://weibo.com/u/3800117445/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>Gossip - TS、Class and ES5</title>
    <link href="https://weibo.com/u/3800117445/2020/03/24/Gossip%20-%20TS%E3%80%81Class%20and%20ES5/"/>
    <id>https://weibo.com/u/3800117445/2020/03/24/Gossip - TS、Class and ES5/</id>
    <published>2020-03-23T16:00:08.000Z</published>
    <updated>2020-03-26T04:43:28.696Z</updated>
    
    <content type="html"><![CDATA[<div class="tip">本文讨论Typescript中的Class同ES5构造函数的对应关系，涉及TypeScript的诸多语法、构造函数、面向对象以及原型对象等相关知识点细节，本文只简单对比并不进行深入展开。</div><p><a href="">TypeScript</a> 是JavaScript的超集，包含ES5、ES6、ES7+…和扩展。</p><p>我们知道在TS中，Class并不是什么新鲜的东西，它的本质其实就是ES那套<code>构造函数·原型对象·实例对象</code>的老古董。在下面的篇幅中，我会简单的对比Class的ES5写法，从最简单到复杂。</p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#fff;background:#195">最简单的类</span></p><p>最简单的类，除名字外其它一无所有。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 文件名：01.ts_class_and_es5.ts */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Class_test</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure></p><p>我们通过<code>tsc 01.ts_class_and_es5.ts</code>命令对该文件进行编译，得到的是下面的JavaScript代码。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 文件名：01.ts_class_and_es5.js */</span></span><br><span class="line"><span class="keyword">var</span> Class_test = <span class="comment">/** @class */</span> (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Class_test</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">    <span class="keyword">return</span> Class_test;</span><br><span class="line">&#125;());</span><br></pre></td></tr></table></figure></p><p>从编译后的结果可以看到对应的代码就是个空构造函数，精巧的地方在于<strong>这个函数被放到一个自调用函数中并返回</strong>，这里使用了一个同名的变量来接收内部的构造函数，多么经典的闭包应用啊。</p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#fff;background:#195"> + 属性</span></p><p>我们尝试在上面代码的基础上，在这个类中加入属性的概念。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Class_test</span> </span>&#123;</span><br><span class="line">    name:string;</span><br><span class="line">    age:number;</span><br><span class="line">    <span class="keyword">constructor</span>(name:string,age:number)&#123;</span><br><span class="line">      <span class="keyword">this</span>.name = name;</span><br><span class="line">      <span class="keyword">this</span>.age  = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>我们为Class_test类新添加了属性的概念( 分别是 <code>name</code> 和 <code>age</code> ) , 这里其实如果不想写constructor构造函数的话其实可以给 <code>name</code> 和 <code>age</code> 设置一个初始值也是没问题的。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Class_test = <span class="comment">/** @class */</span> (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">Class_test</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.name = name;</span><br><span class="line">            <span class="keyword">this</span>.age = age;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Class_test;</span><br><span class="line">&#125;());</span><br></pre></td></tr></table></figure><p>可以发现写法跟ES5构造函数的写法一致，注意Class成员的几个修饰符：<a href="">public</a> <a href="">protected</a> <a href="">private</a> 在ES5代码的结构中没有意义，这里不做额外说明。</p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#fff;background:#195"> + 方法(静态)</span></p><p>我们在上面代码的基础上再加上方法、静态属性、静态方法。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 设计类 */</span></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Class_test</span> </span>&#123;</span><br><span class="line">    name: string;</span><br><span class="line">    age: number;</span><br><span class="line">    <span class="keyword">constructor</span>(name: string, age: number) &#123;</span><br><span class="line">      <span class="keyword">this</span>.name = name;</span><br><span class="line">      <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    getInfo():<span class="keyword">void</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">`Name === <span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span>  Age === <span class="subst">$&#123;<span class="keyword">this</span>.age&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* 静态属性：构造函数(类)自己的属性，访问示例：类名.静态属性; */</span></span><br><span class="line">    <span class="comment">/* 静态方法：构造函数(类)自己的方法，访问示例：类名.静态方法名称(); */</span></span><br><span class="line">    <span class="keyword">static</span> className: string = <span class="string">"Class_test"</span>;</span><br><span class="line">    <span class="keyword">static</span> getClassName():<span class="keyword">void</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"ClassName === "</span>+<span class="keyword">this</span>.className);   <span class="comment">//this=&gt;Class_Test</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 实例化对象 */</span></span><br><span class="line">  <span class="keyword">let</span> c:Class_test = <span class="keyword">new</span> Class_test(<span class="string">"文顶顶"</span>,<span class="number">18</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(c.name,c.age);</span><br><span class="line">  c.getInfo();</span><br><span class="line">  <span class="built_in">console</span>.log(Class_test.className);</span><br><span class="line">  Class_test.getClassName();</span><br></pre></td></tr></table></figure></p><p>我们为代码添加了静态属性 <code>className</code>、静态方法 <code>getClassName()</code> 、实例方法 <code>getInfo()</code>,通过查看对应的ES5代码，我们会发现这也没什么特别的。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Class_test = <span class="comment">/** @class */</span> (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">Class_test</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.name = name;</span><br><span class="line">            <span class="keyword">this</span>.age = age;</span><br><span class="line">        &#125;</span><br><span class="line">        Class_test.prototype.getInfo = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"Name === "</span> + <span class="keyword">this</span>.name + <span class="string">"  Age === "</span> + <span class="keyword">this</span>.age);</span><br><span class="line">        &#125;;</span><br><span class="line">        Class_test.getClassName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"ClassName === "</span> + <span class="keyword">this</span>.className); <span class="comment">//this=&gt;Class_Test</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">/* 静态属性：构造函数(类)自己的属性，访问示例：类名.静态属性; */</span></span><br><span class="line">        <span class="comment">/* 静态方法：构造函数(类)自己的方法，访问示例：类名.静态方法名称(); */</span></span><br><span class="line">        Class_test.className = <span class="string">"Class_test"</span>;</span><br><span class="line">        <span class="keyword">return</span> Class_test;</span><br><span class="line">    &#125;());</span><br><span class="line">    <span class="keyword">var</span> c = <span class="keyword">new</span> Class_test(<span class="string">"文顶顶"</span>, <span class="number">18</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(c.name, c.age);           <span class="comment">/* 文顶顶 18 */</span></span><br><span class="line">    c.getInfo();                          <span class="comment">/* Name === 文顶顶  Age === 18 */</span></span><br><span class="line">    <span class="built_in">console</span>.log(Class_test.className);    <span class="comment">/* Class_test */</span></span><br><span class="line">    Class_test.getClassName();            <span class="comment">/* ClassName === Class_test */</span></span><br></pre></td></tr></table></figure></p><p>关键在于搞清楚<strong>成员</strong>、<strong>原型成员</strong>、<strong>静态成员</strong>、<strong>实例成员</strong>、<strong>构造函数</strong>、<strong>原型对象</strong>以及<strong>实例化</strong>的关系。</p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#fff;background:#195"> + 继承 </span></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 设计类(父类) */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Class_super</span> </span>&#123;</span><br><span class="line">  name: string;</span><br><span class="line">  age: number;</span><br><span class="line">  <span class="keyword">constructor</span>(name: string, age: number) &#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">  &#125;</span><br><span class="line">  getInfo():<span class="keyword">void</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Name === <span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span>  Age === <span class="subst">$&#123;<span class="keyword">this</span>.age&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">static</span> className: string = <span class="string">"Class_test"</span>;</span><br><span class="line">  <span class="keyword">static</span> getClassName():<span class="keyword">void</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"ClassName === "</span>+<span class="keyword">this</span>.className);   <span class="comment">//this=&gt;Class_Test</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 设计类(子类) */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Class_child</span> <span class="keyword">extends</span> <span class="title">Class_super</span></span>&#123;</span><br><span class="line">  money:number;</span><br><span class="line">  <span class="keyword">constructor</span>(name: string, age: number,money:number) &#123;</span><br><span class="line">    <span class="keyword">super</span>(name,age);</span><br><span class="line">    <span class="keyword">this</span>.money = money;</span><br><span class="line">  &#125;</span><br><span class="line">  getMoney():<span class="keyword">void</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Money === <span class="subst">$&#123;<span class="keyword">this</span>.money&#125;</span>`</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">static</span> child_static_func():<span class="keyword">void</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"测试该方法能否被Class_super方法调用？No"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 实例化(对象) */</span></span><br><span class="line"><span class="keyword">let</span> child:Class_child = <span class="keyword">new</span> Class_child(<span class="string">"zs"</span>,<span class="number">19</span>,<span class="number">100</span>);</span><br><span class="line"><span class="built_in">console</span>.log(child,child.name,child.age,child.money);</span><br><span class="line">child.getInfo();</span><br><span class="line">child.getMoney();</span><br><span class="line"><span class="built_in">console</span>.log(Class_child.className);</span><br><span class="line">Class_child.getClassName();</span><br><span class="line">Class_child.child_static_func();</span><br><span class="line"><span class="comment">// Class_super.child_static_func();   错误的示范</span></span><br></pre></td></tr></table></figure><p>如果我们实现了类的继承，那么问题就会变得复杂得多，至少看起来如此。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> __extends = (<span class="keyword">this</span> &amp;&amp; <span class="keyword">this</span>.__extends) || (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> extendStatics = <span class="function"><span class="keyword">function</span> (<span class="params">d, b</span>) </span>&#123;</span><br><span class="line">        extendStatics = <span class="built_in">Object</span>.setPrototypeOf ||</span><br><span class="line">            (&#123; <span class="attr">__proto__</span>: [] &#125; <span class="keyword">instanceof</span> <span class="built_in">Array</span> &amp;&amp; <span class="function"><span class="keyword">function</span> (<span class="params">d, b</span>) </span>&#123; d.__proto__ = b; &#125;) </span><br><span class="line">            || <span class="function"><span class="keyword">function</span> (<span class="params">d, b</span>) </span>&#123; <span class="keyword">for</span> (<span class="keyword">var</span> p <span class="keyword">in</span> b) <span class="keyword">if</span> (b.hasOwnProperty(p)) d[p] = b[p]&#125;;</span><br><span class="line">        <span class="keyword">return</span> extendStatics(d, b);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">d, b</span>) </span>&#123;</span><br><span class="line">        extendStatics(d, b);</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__</span>(<span class="params"></span>) </span>&#123; <span class="keyword">this</span>.constructor = d; &#125;</span><br><span class="line">    d.prototype = b === <span class="literal">null</span> ? <span class="built_in">Object</span>.create(b) : (__.prototype = b.prototype, <span class="keyword">new</span> __());</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 设计类(父类) */</span></span><br><span class="line"><span class="keyword">var</span> Class_super = <span class="comment">/** @class */</span> (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Class_super</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    Class_super.prototype.getInfo = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"Name === "</span> + <span class="keyword">this</span>.name + <span class="string">"  Age === "</span> + <span class="keyword">this</span>.age);</span><br><span class="line">    &#125;;</span><br><span class="line">    Class_super.getClassName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"ClassName === "</span> + <span class="keyword">this</span>.className); <span class="comment">//this=&gt;Class_Test</span></span><br><span class="line">    &#125;;</span><br><span class="line">    Class_super.className = <span class="string">"Class_test"</span>;</span><br><span class="line">    <span class="keyword">return</span> Class_super;</span><br><span class="line">&#125;());</span><br><span class="line"><span class="comment">/* 设计类(子类) */</span></span><br><span class="line"><span class="keyword">var</span> Class_child = <span class="comment">/** @class */</span> (<span class="function"><span class="keyword">function</span> (<span class="params">_super</span>) </span>&#123;</span><br><span class="line">    __extends(Class_child, _super);</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Class_child</span>(<span class="params">name, age, money</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> _this = _super.call(<span class="keyword">this</span>, name, age) || <span class="keyword">this</span>;</span><br><span class="line">        _this.money = money;</span><br><span class="line">        <span class="keyword">return</span> _this;</span><br><span class="line">    &#125;</span><br><span class="line">    Class_child.prototype.getMoney = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"Money === "</span> + <span class="keyword">this</span>.money);</span><br><span class="line">    &#125;;</span><br><span class="line">    Class_child.child_static_func = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"测试该方法能否被Class_super方法调用？No"</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> Class_child;</span><br><span class="line">&#125;(Class_super));</span><br><span class="line"><span class="comment">/* 实例化(对象) */</span></span><br><span class="line"><span class="keyword">var</span> child = <span class="keyword">new</span> Class_child(<span class="string">"zs"</span>, <span class="number">19</span>, <span class="number">100</span>);</span><br><span class="line"><span class="built_in">console</span>.log(child, child.name, child.age, child.money);   </span><br><span class="line"><span class="comment">/* Class_child &#123; name: 'zs', age: 19, money: 100 &#125; 'zs' 19 100 */</span></span><br><span class="line">child.getInfo();                    <span class="comment">/* Name === zs  Age === 19 */</span></span><br><span class="line">child.getMoney();                   <span class="comment">/* Money === 100 */</span></span><br><span class="line"><span class="built_in">console</span>.log(Class_child.className); <span class="comment">/* Class_test */</span></span><br><span class="line">Class_child.getClassName();         <span class="comment">/* ClassName === Class_test */</span></span><br><span class="line">Class_child.child_static_func();    <span class="comment">/* 测试该方法能否被Class_super方法调用？No */</span></span><br><span class="line"><span class="comment">// Class_super.child_static_func();   错误的示范</span></span><br></pre></td></tr></table></figure></p><p>蒽，是的。看上去，TS ( ES6 ) 中感觉Class继承的实现稍显复杂。接下来，我们试着挑出关键的部分，并把比较重要(表面感觉不太看得懂)的那部分代码加上些注释。</p><p><strong>关键 ①</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> _this = _super.call(<span class="keyword">this</span>, name, age) || <span class="keyword">this</span>;</span><br></pre></td></tr></table></figure></p><p>这行代码的目的是获取父类的实例成员，具体采用的技术手段是通过借用构造函数调用( <a href="">在子构造函数中以call方法来调用父构造函数，并绑定this </a>)的方式来获取。此处，拿到的是<code>name</code> <code>age</code>两个属性(当我们通过子类来实例化创建对象的时候，得到的实例化对象中因此拥有了<code>name</code> 和 <code>age</code> 属性)。</p><p><strong>关键 ②</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__extends(Class_child, _super);</span><br></pre></td></tr></table></figure></p><p>这行代码是一个函数调用，其中__extends是函数名称，而Class_child, _super是传递给函数的具体实参。<br>该函数的作用是，通过特定的方式来获取父类(构造函数)的静态成员(包括静态属性以及静态方法)并让实例对象可以通过原型链来访问父类原型对象上面的成员(属性和方法)。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* @Description: __extends主要用于处理(静态成员)的继承</span></span><br><span class="line"><span class="comment"> * @return: 函数形态 function f(_child,_super)&#123;&#125; */</span></span><br><span class="line"><span class="keyword">var</span> __extends = (<span class="keyword">this</span> &amp;&amp; <span class="keyword">this</span>.__extends) || (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="comment">/* @Description: extendStatics用于扩展静态成员(静态属性和静态方法)</span></span><br><span class="line"><span class="comment"> * param __child  子类(Class_child)</span></span><br><span class="line"><span class="comment"> * param __super  父类(Class_super)*/</span></span><br><span class="line"><span class="keyword">var</span> extendStatics = <span class="function"><span class="keyword">function</span>(<span class="params">__child, __super</span>) </span>&#123;</span><br><span class="line">    <span class="comment">/* 1.确定函数 */</span></span><br><span class="line">    <span class="comment">/* extendStatics变量的值总是为一个函数，该函数的目的是_super的属性和方法(静态)*/</span></span><br><span class="line">    <span class="comment">/* 核心策略 */</span></span><br><span class="line">    <span class="comment">/* ① 尝试直接使用 Object.setPrototypeOf函数 类似于__child.__proto__ = __super */</span></span><br><span class="line">    <span class="comment">/* ② 直接通过__child.__proto__ = __super来设置 */</span></span><br><span class="line">    <span class="comment">/* ③ 通过遍历的方式来拷贝_super对象的实例成员 */</span></span><br><span class="line">    extendStatics = <span class="built_in">Object</span>.setPrototypeOf </span><br><span class="line">    ||(&#123; <span class="attr">__proto__</span>: [] &#125; <span class="keyword">instanceof</span> <span class="built_in">Array</span> </span><br><span class="line">      &amp;&amp; <span class="function"><span class="keyword">function</span>(<span class="params">__child, __super</span>) </span>&#123;</span><br><span class="line">         __child.__proto__ = __super; </span><br><span class="line">         &#125;) </span><br><span class="line">    ||<span class="function"><span class="keyword">function</span>(<span class="params">d, b</span>) </span>&#123; </span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> p <span class="keyword">in</span> b) &#123; </span><br><span class="line">        <span class="keyword">if</span> (b.hasOwnProperty(p)) d[p] = b[p]; &#125; </span><br><span class="line">      &#125;;</span><br><span class="line">    <span class="comment">/* 2.调用函数(完成继承) */</span></span><br><span class="line">    <span class="keyword">return</span> extendStatics(__child, __super);</span><br><span class="line">&#125;;</span><br><span class="line"> <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">_child, _super</span>) </span>&#123;</span><br><span class="line">     <span class="comment">/* [1] 完成对父类(构造函数)静态成员(属性+方法)的拷贝工作 */</span></span><br><span class="line">     extendStatics(_child, _super);</span><br><span class="line"></span><br><span class="line">     <span class="comment">/* [2] 完成对父类(构造函数)原型成员(主要是方法)的原型链继承 */</span></span><br><span class="line">     <span class="comment">/* 内部的this取决于__()函数如何调用，使用new调用则this指向的是内部新创建的实例对象 */</span></span><br><span class="line">     <span class="function"><span class="keyword">function</span> <span class="title">__</span>(<span class="params"></span>) </span>&#123; <span class="keyword">this</span>.constructor = _child; &#125; </span><br><span class="line"></span><br><span class="line">     <span class="comment">/* 如果_spuer为null,那么就创建一个新对象*/</span></span><br><span class="line">     <span class="comment">/* 设置该对象的原型对象为_super[let o = &#123;&#125;; o.__prototype = _super] */</span> </span><br><span class="line">     <span class="comment">/* 并把最终结果赋值给_child.prototype, 否则就间接通过__()这个函数来设置原型对象*/</span></span><br><span class="line">     <span class="comment">/* 并创建实例化对象，并设置 _child.prototype = new __() */</span></span><br><span class="line">     _child.prototype = </span><br><span class="line">          _super === <span class="literal">null</span> ? </span><br><span class="line">          <span class="built_in">Object</span>.create(_super) : </span><br><span class="line">          (__.prototype = _super.prototype, <span class="keyword">new</span> __());</span><br><span class="line"> &#125;;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><p>我在代码中穿插并加上了一些说明性的注释 ，看上去似乎比较复杂，稍微总结下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">__extends() 函数做了两件事情：</span><br><span class="line">  [1] 完成对父类(构造函数)静态成员(属性+方法)的拷贝工作</span><br><span class="line">  [2] 完成对父类(构造函数)原型成员(主要是方法)的原型链继承</span><br><span class="line">如何做的？</span><br><span class="line">  [1] child.__proto__ = super  </span><br><span class="line">  [2] child.prototype = super.prototype; + 解决共享问题(中间加了间隔层)</span><br></pre></td></tr></table></figure></p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/ts_class.png?raw=true"></p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#fff;background:#195"> + Interface </span></p><p>接口( <a href="">interface </a> )是 typescript 中的重要概念，而且接口也能继承且可以约束类，因此这里简单的比较下，下面给出示例代码以及对应的JavaScript代码。<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 1.定义接口(父) */</span></span><br><span class="line">  <span class="keyword">interface</span> Test_Class_Super_Interface &#123;</span><br><span class="line">    name: <span class="built_in">string</span>;</span><br><span class="line">    age: <span class="built_in">number</span>;</span><br><span class="line">    getName: <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">    getAge: <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 2.定义接口(子) */</span></span><br><span class="line">  <span class="keyword">interface</span> Test_Class_Child_Interface <span class="keyword">extends</span> Test_Class_Super_Interface&#123;</span><br><span class="line">    id:<span class="built_in">number</span>;</span><br><span class="line">    getId:<span class="function"><span class="params">()</span>=&gt;</span><span class="built_in">void</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 3.设计类：该类实现指定的接口 */</span></span><br><span class="line">  <span class="keyword">class</span> Test_Class <span class="keyword">implements</span> Test_Class_Child_Interface &#123;</span><br><span class="line">    id: <span class="built_in">number</span> = <span class="number">0</span>;</span><br><span class="line">    name: <span class="built_in">string</span>;</span><br><span class="line">    age: <span class="built_in">number</span>;</span><br><span class="line">    getName(): <span class="built_in">void</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"getName() "</span> + <span class="keyword">this</span>.name)</span><br><span class="line">    &#125;;</span><br><span class="line">    getAge(): <span class="built_in">void</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"getAge() "</span> + <span class="keyword">this</span>.age)</span><br><span class="line">    &#125;;</span><br><span class="line">    getId():<span class="built_in">void</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span>.id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">name: <span class="built_in">string</span>, age: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">      <span class="keyword">this</span>.name = name;</span><br><span class="line">      <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/* 4.创建实例化对象 */</span></span><br><span class="line">  <span class="keyword">let</span> instance: Test_Class = <span class="keyword">new</span> Test_Class(<span class="string">"ls"</span>, <span class="number">18</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(instance);</span><br></pre></td></tr></table></figure></p><p>上面代码设计了两个接口，分别是<code>Test_Class_Super_Interface</code> 和 <code>Test_Class_Child_Interface</code>,它们是继承关系，<a href="">Test_Class</a> 类实现了<code>Test_Class_Child_Interface</code>接口。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Test_Class = <span class="comment">/** @class */</span> (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">Test_Class</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.id = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">this</span>.name = name;</span><br><span class="line">            <span class="keyword">this</span>.age = age;</span><br><span class="line">        &#125;</span><br><span class="line">        Test_Class.prototype.getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"getName() "</span> + <span class="keyword">this</span>.name);</span><br><span class="line">        &#125;;;</span><br><span class="line">        Test_Class.prototype.getAge = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"getAge() "</span> + <span class="keyword">this</span>.age);</span><br><span class="line">        &#125;;;</span><br><span class="line">        Test_Class.prototype.getId = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.id);</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> Test_Class;</span><br><span class="line">    &#125;());</span><br><span class="line">    <span class="keyword">var</span> instance = <span class="keyword">new</span> Test_Class(<span class="string">"ls"</span>, <span class="number">18</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(instance);</span><br></pre></td></tr></table></figure><p>我们发现转换后 JavaScript版本的代码里面好像没有任何与接口相关的信息，<strong>接口是 typescript 中特有的<code>类型</code>, 在编译后会自动消失。</strong></p><ul><li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="noopener">花田半亩</a></li><li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="noopener">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li><li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;tip&quot;&gt;本文讨论Typescript中的Class同ES5构造函数的对应关系，涉及TypeScript的诸多语法、构造函数、面向对象以及原型对象等相关知识点细节，本文只简单对比并不进行深入展开。&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;&quot;&gt;TypeScri
      
    
    </summary>
    
    
      <category term="Gossip" scheme="https://weibo.com/u/3800117445/tags/Gossip/"/>
    
  </entry>
  
  <entry>
    <title>Gossip - Rollup</title>
    <link href="https://weibo.com/u/3800117445/2019/08/24/Gossip%20-%20Rollup/"/>
    <id>https://weibo.com/u/3800117445/2019/08/24/Gossip - Rollup/</id>
    <published>2019-08-23T16:00:08.000Z</published>
    <updated>2020-04-26T08:46:12.715Z</updated>
    
    <content type="html"><![CDATA[<div class="tip">本文简单介绍类库打包工具 rollup 。</div><p><a href="https://www.rollupjs.com/" target="_blank" rel="noopener">Rollup</a> 是一款 JavaScript 模块打包器,可以将多个简单的js代码文件编译成一份复杂的js代码文件,需要注意的是 <a href="https://www.rollupjs.com/" target="_blank" rel="noopener">Rollup</a> 主要用于JavaScript类库的打包，譬如 Vue 框架的源码打包。</p><p>使用 <a href="https://www.rollupjs.com/" target="_blank" rel="noopener">Rollup</a> 必要性在于，如果我们开发的是较为复杂的大型项目，那么将项目拆分成小的单独文件来组织代码兴许会更简单，因为这通常会消除无法预知的相互影响(<code>remove unexpected interaction</code>)，以及显著降低了所要解决的问题的复杂度(<code>complexity of the problem</code>)。</p><div class="titleX"><strong>第一步 安装rollup环境</strong></div><p>我们可以通过下面的指令来全局安装 rollup 和一些必要的插件。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @babel/preset-env @babel/core rollup rollup-plugin-babel rollup-plugin-serve cross-env -D</span><br></pre></td></tr></table></figure></p><p><code>rollup</code>               打包工具<br><code>@babel/preset-env</code>    babel将高级语法转换为高级语法<br><code>@babel/core</code>          需要使用 babel核心模块<br><code>rollup-plugin-babel</code>  和 babel关联的 rollup插件<br><code>rollup-plugin-serve</code>  在本地开启(设置)静态服务<br><code>cross-env</code>            在本地设置环境变量等</p><p>这里我先新创建 Vue_L文件夹，先执行<code>npm init -y</code>初始化，然后再执行上面的命令行，下面列出安装和执行成功后显示的结果信息。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+ cross-env@7.0.2</span><br><span class="line">+ rollup-plugin-babel@4.4.0</span><br><span class="line">+ @babel/preset-env@7.9.5</span><br><span class="line">+ @babel/core@7.9.0</span><br><span class="line">+ rollup@2.7.2</span><br><span class="line">+ rollup-plugin-serve@1.0.1</span><br><span class="line">added 158 packages from 93 contributors and audited 2000 packages in 23.326s</span><br><span class="line">found 0 vulnerabilities</span><br></pre></td></tr></table></figure></p><div class="titleX"><strong>第二步 创建配置文件</strong></div><p>在根目录中创建<code>rollup.config.js</code>文件，并引入插件模块，并配置入口、出口以及插件等信息。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> babel <span class="keyword">from</span> <span class="string">'rollup-plugin-babel'</span>;</span><br><span class="line"><span class="keyword">import</span> serve <span class="keyword">from</span> <span class="string">'rollup-plugin-serve'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="comment">/* 设置打包的入口文件 */</span></span><br><span class="line">    input: <span class="string">"./src/index.js"</span>,</span><br><span class="line">    <span class="comment">/* 输出配置项 */</span></span><br><span class="line">    output: &#123;</span><br><span class="line">        <span class="comment">/* 配置出口路径 */</span></span><br><span class="line">        file: <span class="string">"dist/umd/xxx.js"</span>,</span><br><span class="line">        <span class="comment">/* 指定打包后全局变量的名字 */</span></span><br><span class="line">        name: <span class="string">"Person"</span>,</span><br><span class="line">        <span class="comment">/* 统一模块规范 */</span></span><br><span class="line">        format: <span class="string">"umd"</span>,</span><br><span class="line">        <span class="comment">/* es6-&gt;es5 开启源码调试(显示报错位置) */</span></span><br><span class="line">        sourcemap: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">/* 使用插件 */</span></span><br><span class="line">    plugins: [</span><br><span class="line">        babel(&#123;</span><br><span class="line">            exclude: <span class="string">"node_modules/**"</span></span><br><span class="line">        &#125;),</span><br><span class="line">        process.env.ENV === <span class="string">'development'</span> ? serve(&#123;</span><br><span class="line">            open: <span class="literal">true</span>,</span><br><span class="line">            <span class="comment">/* 默认打开的 HTML 文件路径 */</span></span><br><span class="line">            openPage: <span class="string">"/public/index.html"</span>,</span><br><span class="line">            port: <span class="number">3000</span>,</span><br><span class="line">            contentBase: <span class="string">""</span></span><br><span class="line">        &#125;) : <span class="literal">null</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><div class="titleX"><strong>第三步 创建其它文件等</strong></div><p>在项目根目录中创建 <code>.babelrc</code> 文件，设置文件内容<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"presets"</span>: [</span><br><span class="line">    <span class="string">"@babel/preset-env"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>创建项目所需要的 public 、src 、dist 等文件夹和对应的文件，下面列出文件树结构。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">wendingding:Vue_L wendingding$ tree -L 2</span><br><span class="line">.</span><br><span class="line">├── dist</span><br><span class="line">│   └── umd</span><br><span class="line">├── node_modules</span><br><span class="line">│   ├── @babel</span><br><span class="line">│   ├── ansi-styles</span><br><span class="line">│   ├── babel-plugin-dynamic-import-node</span><br><span class="line">│   ├── browserslist</span><br><span class="line">│   ├── caniuse-lite</span><br><span class="line">│   ...</span><br><span class="line">│   └── which</span><br><span class="line">├── package-lock.json</span><br><span class="line">├── package.json</span><br><span class="line">├── public</span><br><span class="line">│   └── index.html</span><br><span class="line">├── rollup.config.js</span><br><span class="line">└── src</span><br><span class="line">    └── index.js</span><br></pre></td></tr></table></figure></p><p>在 index.html文件中，通过 script文件引入最终打包好的文件.<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/dist/umd/xxx.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">       <span class="comment">// 使用 xxx.js 文件中提供的class</span></span></span><br><span class="line"><span class="javascript">       <span class="keyword">let</span> x = <span class="keyword">new</span> Person(<span class="string">"zs"</span>, <span class="number">18</span>);</span></span><br><span class="line"><span class="javascript">       <span class="built_in">console</span>.log(x);</span></span><br><span class="line"><span class="undefined">   </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p><div class="titleX"><strong>第四步 执行打包</strong></div><p>在 package.json文件中配置<code>scripts</code>项中的<code>build:dev</code>任务和<code>serve</code>任务。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">        &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;,</span><br><span class="line">        &quot;build:dev&quot;: &quot;rollup -c&quot;,</span><br><span class="line">        &quot;serve&quot;: &quot;cross-env ENV=development rollup -c -w&quot;,</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure></p><p>执行指令<code>$ npm run serve</code>即可 (如果只是简单的想要打包，那么执行<code>npm run build:dev</code>指令即可)。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* /dist/umd/xxx.js 文件的内容 */</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">global, factory</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">typeof</span> exports === <span class="string">'object'</span> &amp;&amp; <span class="keyword">typeof</span> <span class="built_in">module</span> !== <span class="string">'undefined'</span> ? </span><br><span class="line">    <span class="built_in">module</span>.exports = factory() :</span><br><span class="line">    <span class="keyword">typeof</span> define === <span class="string">'function'</span> &amp;&amp; define.amd ? define(factory) :</span><br><span class="line">    (global = global || self, global.Person = factory());</span><br><span class="line">&#125;(<span class="keyword">this</span>, (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="string">'use strict'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.name = name;</span><br><span class="line">      <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Person;</span><br><span class="line"></span><br><span class="line">&#125;)));</span><br><span class="line"></span><br><span class="line"><span class="comment">//# sourceMappingURL=xxx.js.map</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rollup v2.7.2</span><br><span class="line">bundles ./src/index.js → dist/umd/xxx.js...</span><br><span class="line">http://localhost:3000 -&gt; /Users/文顶顶/Documents/花田半亩 /Learn/Hall/Vue_L</span><br><span class="line">created dist/umd/xxx.js in 616ms</span><br><span class="line"></span><br><span class="line">[2019-08-24 16:35:26] waiting for changes...</span><br></pre></td></tr></table></figure><p><code>-c</code> 等同于<code>--config</code>命令，表示使用 配置文件来执行打包过程。<br><code>-w</code> 等同于<code>--watch</code>命令，用于监听源文件是否有改动，如果有改动那么就会重新打包。</p><p>这里顺便列出该打包工具的其它可用参数，作为参考。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">-i, --input &lt;filename&gt;      要打包的文件（必须）</span><br><span class="line">-o, --file &lt;output&gt;         输出的文件 (如果没有这个参数，则直接输出到控制台)</span><br><span class="line">-f, --format &lt;format&gt;       输出的文件类型 (amd, cjs, esm, iife, umd)</span><br><span class="line">-e, --external &lt;ids&gt;        将模块ID的逗号分隔列表排除</span><br><span class="line">-g, --globals &lt;pairs&gt;       以`module ID:Global` 键值对的形式，用逗号分隔开 </span><br><span class="line">                              任何定义在这里模块ID定义添加到外部依赖</span><br><span class="line">-n, --name &lt;name&gt;           生成UMD模块的名字</span><br><span class="line">-h, --help                  输出 help 信息</span><br><span class="line">-m, --sourcemap             生成 sourcemap (`-m inline` for inline map)</span><br><span class="line">--amd.id                    AMD模块的ID，默认是个匿名函数</span><br><span class="line">--amd.define                使用Function来代替`define`</span><br><span class="line">--no-strict                 在生成的包中省略`&quot;use strict&quot;;`</span><br><span class="line">--no-conflict               对于UMD模块来说，给全局变量生成一个无冲突的方法</span><br><span class="line">--intro                     在打包好的文件的块的内部(wrapper内部)的最顶部插入一段内容</span><br><span class="line">--outro                     在打包好的文件的块的内部(wrapper内部)的最底部插入一段内容</span><br><span class="line">--banner                    在打包好的文件的块的外部(wrapper外部)的最顶部插入一段内容</span><br><span class="line">--footer                    在打包好的文件的块的外部(wrapper外部)的最底部插入一段内容</span><br><span class="line">--interop                   包含公共的模块（这个选项是默认添加的）</span><br></pre></td></tr></table></figure></p><ul><li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="noopener">花田半亩</a></li><li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="noopener">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li><li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;tip&quot;&gt;本文简单介绍类库打包工具 rollup 。&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://www.rollupjs.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Rollup&lt;/a&gt; 是一款 JavaScrip
      
    
    </summary>
    
    
      <category term="Gossip" scheme="https://weibo.com/u/3800117445/tags/Gossip/"/>
    
  </entry>
  
  <entry>
    <title>疑难杂症-raw.githubusercontent.com访问错误</title>
    <link href="https://weibo.com/u/3800117445/2019/08/10/%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87-raw.githubusercontent.com/"/>
    <id>https://weibo.com/u/3800117445/2019/08/10/疑难杂症-raw.githubusercontent.com/</id>
    <published>2019-08-10T15:58:37.000Z</published>
    <updated>2020-04-26T04:07:14.802Z</updated>
    
    <content type="html"><![CDATA[<p>我自己在写博客的时候，需要在博客中间插入很多的图片来解释和说明文章，为了方便所以我以前是在 github账户下面新创建了一个 source 仓库专门用来保存图片等静态资源的，当图片等文件上传到 github 仓库后会获得一个 URL 地址，正常我在博客中只需要通过 image 标签来引入这个地址就可以了。</p><p>前段时间在访问自己博客的时候，突然发现很多图片资源都访问不了，检查下原因应该是 raw.githubusercontent.com 被 GFW 特殊照顾了，下面给出恢复访问的解决方案。</p><div class="titleX" style="width:250px"><strong>第一步 查询该网站的 IP 地址</strong></div><p>打开<a href="https://site.ip138.com/" target="_blank" rel="noopener">查询网</a>页面,在该页面的查询搜索框中输入 <code>raw.githubusercontent.com</code> , 或者直接<a href="https://site.ip138.com/raw.Githubusercontent.com/" target="_blank" rel="noopener">点击我跳转</a></p><p>你将会得到下面的 IP 地址结果。</p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/raw1.png?raw=true"></p><p>查询到 IP 地址后，可以ping不同IP的延时以选择最佳IP地址。</p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/raw2.png?raw=true"></p><div class="titleX" style="width:250px"><strong>第二步 修改电脑的 host </strong></div><p>我用的是 Mac 电脑，所以直接在终端中输入<code>sudo vi /etc/hosts</code>命令使用 vim 工具来打开。<br>在该文件中新添加 对应的 IP 地址即可。</p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/raw3.png?raw=true"></p><hr><ul><li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="noopener">花田半亩</a></li><li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="noopener">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li><li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;我自己在写博客的时候，需要在博客中间插入很多的图片来解释和说明文章，为了方便所以我以前是在 github账户下面新创建了一个 source 仓库专门用来保存图片等静态资源的，当图片等文件上传到 github 仓库后会获得一个 URL 地址，正常我在博客中只需要通过 imag
      
    
    </summary>
    
    
      <category term="疑难杂症" scheme="https://weibo.com/u/3800117445/tags/%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/"/>
    
  </entry>
  
  <entry>
    <title>奇怪问题 - 找出复杂数组中的最大值</title>
    <link href="https://weibo.com/u/3800117445/2019/08/01/%E5%A5%87%E6%80%AA%E9%97%AE%E9%A2%98-%E6%B1%82%E6%95%B0%E7%BB%84%E6%9C%80%E5%A4%A7%E5%80%BC/"/>
    <id>https://weibo.com/u/3800117445/2019/08/01/奇怪问题-求数组最大值/</id>
    <published>2019-07-31T16:00:09.000Z</published>
    <updated>2020-04-27T16:36:54.644Z</updated>
    
    <content type="html"><![CDATA[<div class="titleX" style="background:#4fc08d;color:white"><strong>问题：给出下面的数据，请编写函数求数组的最大值。</strong></div>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> data = [</span><br><span class="line">            [<span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>],</span><br><span class="line">            [<span class="number">13</span>, <span class="number">27</span>, <span class="number">18</span>, <span class="number">26</span>],</span><br><span class="line">            [<span class="number">32</span>, <span class="number">35</span>, <span class="number">37</span>, [<span class="number">39</span>, <span class="number">43</span>, [<span class="number">99</span>, <span class="number">81</span>]]],</span><br><span class="line">            <span class="number">12</span></span><br><span class="line">    ];</span><br></pre></td></tr></table></figure><p><div class="titleX" style="background:orange;color:white"><strong>方案</strong></div><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">findMax</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/* 整理数组元素 */</span></span><br><span class="line">   arr.forEach(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">       <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(item)) &#123;</span><br><span class="line">           <span class="comment">/* 递归调用 */</span></span><br><span class="line">           arr[index] = findMax(item);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;);</span><br><span class="line"></span><br><span class="line">   <span class="comment">/* 数组排序 */</span></span><br><span class="line">   arr.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> b - a;</span><br><span class="line">   &#125;);</span><br><span class="line"></span><br><span class="line">   <span class="comment">/* 总是取最大值 */</span></span><br><span class="line">  <span class="keyword">return</span> arr[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>优化下代码，把利用 <code>sort</code> 排序求最大值的部分调整为 <code>Math.max</code> 方法。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">findMax</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    arr.forEach(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(item)) &#123;</span><br><span class="line">            arr[index] = findMax(item);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.max(...arr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><ul><li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="noopener">花田半亩</a></li><li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="noopener">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li><li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;titleX&quot; style=&quot;background:#4fc08d;color:white&quot;&gt;&lt;strong&gt;问题：给出下面的数据，请编写函数求数组的最大值。&lt;/strong&gt;&lt;/div&gt;


  &lt;figure class=&quot;highlight java
      
    
    </summary>
    
    
      <category term="奇怪问题" scheme="https://weibo.com/u/3800117445/tags/%E5%A5%87%E6%80%AA%E9%97%AE%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>Gossip - 如何自己撸一个脚手架(commander模块)</title>
    <link href="https://weibo.com/u/3800117445/2019/07/22/Gossip%20-%20%E5%A6%82%E4%BD%95%E8%87%AA%E5%B7%B1%E6%92%B8%E4%B8%80%E4%B8%AA%E8%84%9A%E6%89%8B%E6%9E%B6(commander%E6%A8%A1%E5%9D%97)/"/>
    <id>https://weibo.com/u/3800117445/2019/07/22/Gossip - 如何自己撸一个脚手架(commander模块)/</id>
    <published>2019-07-21T16:00:09.000Z</published>
    <updated>2020-04-27T08:52:27.858Z</updated>
    
    <content type="html"><![CDATA[<div class="tip">这是系列文章 <a href="">如何自己撸一个脚手架</a> 的第一篇，主要讲解脚手架工具中的核心模块命令行参数解析功能的实现，重点讲解 Node 模块 <a href="">commander</a>的使用。</div><p>在前端开发中我们已经接触过各种各样的脚手架工具，从<code>Yeoman</code>到<code>vue-cli</code>和<code>dva-cli</code>等，这几篇文章将讲解脚手架工具的核心功能以及具体实现细节，本文探讨哪些功能呢？我们先随便拿一个现成的脚手架工具<code>vue-cli</code>来作为参考。</p><p>当我们通过<code>npm install -g @vue/cli</code> 来全局安装 @vue/cli之后，就可以在终端中使用 vue 指令了。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">wendingding:vue-test wendingding$ vue --version</span><br><span class="line">@vue/cli 4.3.1</span><br><span class="line">wendingding:vue-test wendingding$ vue --<span class="built_in">help</span></span><br><span class="line">Usage: vue &lt;<span class="built_in">command</span>&gt; [options]</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -V, --version                              output the version number</span><br><span class="line">  -h, --<span class="built_in">help</span>                                 output usage information</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">  create [options] &lt;app-name&gt;                create a new project powered by vue-cli-service</span><br><span class="line">  add [options] &lt;plugin&gt; [pluginOptions]     install a plugin and invoke its generator <span class="keyword">in</span> an already created project</span><br><span class="line">  invoke [options] &lt;plugin&gt; [pluginOptions]  invoke the generator of a plugin <span class="keyword">in</span> an already created project</span><br><span class="line">  inspect [options] [paths...]               inspect the webpack config <span class="keyword">in</span> a project with vue-cli-service</span><br><span class="line">  serve [options] [entry]                    serve a .js or .vue file <span class="keyword">in</span> development mode with zero config</span><br><span class="line">  build [options] [entry]                    build a .js or .vue file <span class="keyword">in</span> production mode with zero config</span><br><span class="line">  ui [options]                               start and open the vue-cli ui</span><br><span class="line">  init [options] &lt;template&gt; &lt;app-name&gt;       generate a project from a remote template (legacy API, requires @vue/cli-init)</span><br><span class="line">  config [options] [value]                   inspect and modify the config</span><br><span class="line">  outdated [options]                         (experimental) check <span class="keyword">for</span> outdated vue cli service / plugins</span><br><span class="line">  upgrade [options] [plugin-name]            (experimental) upgrade vue cli service / plugins</span><br><span class="line">  migrate [options] [plugin-name]            (experimental) run migrator <span class="keyword">for</span> an already-installed cli plugin</span><br><span class="line">  info                                       <span class="built_in">print</span> debugging information about your environment</span><br><span class="line"></span><br><span class="line">  Run vue &lt;<span class="built_in">command</span>&gt; --<span class="built_in">help</span> <span class="keyword">for</span> detailed usage of given <span class="built_in">command</span>.</span><br><span class="line">  </span><br><span class="line">  wendingding:vue-test wendingding$ abc </span><br><span class="line">  -bash: abc: <span class="built_in">command</span> not found</span><br></pre></td></tr></table></figure></p><p>观察上面的终端命令和显示输出，我们总共输入了三个命令<br><code>$ vue --version</code> 查看版本信息<br><code>$ vue --help</code>    获取帮助信息<br><code>$ abc</code>          随意输入的指令，显示<code>command not found</code>该指令不存在。</p><p>本文将专注实现上面的功能，假设我们自己实现的脚手架名为<code>vito-cli</code>那么当我在终端中使用<code>vito-cli</code>的时候，系统应该认识该指令，且能够获取当前脚手架的版本并能够获取帮助信息，下面给出具体的实现过程。</p><div class="titleX"><strong>项目准备</strong></div><p>在电脑中新创建文件夹，假设为 <code>vito-cli</code> ,在该文件夹下面执行下面的命令先做一些准备工作。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm init -y                         <span class="comment"># 初始化package.json</span></span><br><span class="line">npm install eslint husky --save-dev <span class="comment"># eslint是负责代码校验工作,husky提供了git钩子功能</span></span><br><span class="line">npx eslint --init                   <span class="comment"># 初始化eslint配置文件，用于语法检查</span></span><br></pre></td></tr></table></figure><div class="titleX"><strong>目录结构</strong></div><p>参考下面的目录结构来创建文件和文件夹，关键。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── bin</span><br><span class="line">│   └── www            &lt;!-- 全局命令执行的根文件 --&gt;</span><br><span class="line">├── node_modules       &lt;!-- 安装的包文件 --&gt;</span><br><span class="line">│   ├── @babel</span><br><span class="line">│   ...</span><br><span class="line">│   └── yaml</span><br><span class="line">├── package-lock.json</span><br><span class="line">├── package.json       &lt;!-- 元信息文件 --&gt;</span><br><span class="line">├── src       </span><br><span class="line">│   └── main.js        &lt;!-- 项目入口文件 --&gt;</span><br><span class="line">│── .huskyrc           &lt;!-- git hook --&gt;</span><br><span class="line">│── .eslintrc.json     &lt;!-- 代码规范校验文件 --&gt;</span><br><span class="line">└── util</span><br><span class="line">    └── constants.js   &lt;!-- 该文件用于存放公共常量数据 --&gt;</span><br></pre></td></tr></table></figure></p><div class="titleX"><strong>配置和链接</strong></div><p>❏ 配置 <code>package.json</code> 校验src文件夹下的代码<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"lint"</span>:<span class="string">"eslint src"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>❏ 配置 <code>husky</code> 文件，当使用git提交前校验代码是否符合规范<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"hooks"</span>: &#123;</span><br><span class="line">    <span class="string">"pre-commit"</span>: <span class="string">"npm run lint"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>❏ 链接全局包，编写 <code>package.json</code> 文件设置在终端中<code>执行 vito-cli 时调用 bin 目录下的 www 文件</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"bin"</span>: &#123;</span><br><span class="line">       <span class="string">"vito-cli"</span>: <span class="string">"./bin/www"</span></span><br><span class="line">   &#125;,</span><br></pre></td></tr></table></figure></p><p>❏ <code>bin</code> 目录下面的 <code>www</code> 文件设置使用 <code>main.js</code> 作为入口文件，并且以 <code>node 环境</code> 执行此文件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#! /usr/bin/env node</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">'../src/main.js'</span>);</span><br></pre></td></tr></table></figure><p>❏ 链接包到全局环境下使用<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm link</span><br></pre></td></tr></table></figure></p><p>到现在这一步，我们就已经可以成功的在命令行中使用<code>vito-cli</code>命令了，当在终端中执行<code>vito-cli</code>命令的时候其内部会执行main.js文件，如果我们在该文件中加上一行打印代码<code>console.log(&quot;hello vito-cli&quot;)</code>,那么在终端中可以看到对应的输出。</p><div class="titleX" style="background:orange"><strong>使用 commander 解析命令行参数</strong></div><p><a href="https://www.npmjs.com/package/commander" target="_blank" rel="noopener">commander</a> 模块可以帮助我们自动的生成 help 信息，解析选项参数大家可以点击到<a href="https://www.npmjs.com/package/commander" target="_blank" rel="noopener"> npmjs网站 </a>查看包模块的详细情况。</p><p>先在系统中安装 <code>commander</code> 模块<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install commander</span><br></pre></td></tr></table></figure></p><p>在入口文件 main.js 文件中引入该模块并测试<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> program = <span class="built_in">require</span>(<span class="string">"commander"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// process.argv就是用户在命令行中传入的参数</span></span><br><span class="line">program.version(<span class="string">'1.0.1'</span>).parse(process.argv);</span><br></pre></td></tr></table></figure></p><p>此时，我们终端使用<code>vito-cli --help</code> 或者是 <code>vito-cli --version</code> 就能看到对应的提示信息。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">wendingding$ vito-cli --version</span><br><span class="line">1.0.1</span><br><span class="line"></span><br><span class="line">wendingding$ vito-cli --<span class="built_in">help</span></span><br><span class="line">Usage: vito-cli [options]</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -V, --version  output the version number</span><br><span class="line">  -h, --<span class="built_in">help</span>     display <span class="built_in">help</span> <span class="keyword">for</span> <span class="built_in">command</span></span><br></pre></td></tr></table></figure></p><p>注意：脚手架的这个版本号应该使用的是当前cli项目的版本号，我们需要动态的来获取，具体实现方式是直接把<code>package.json</code> 文件中的 <code>version</code> 字段值导入到<code>main.js</code>文件中直接使用即可。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; name, version &#125; = <span class="built_in">require</span>(<span class="string">"../package"</span>);</span><br></pre></td></tr></table></figure><p>另外，当我们使用脚手架工具的时候，往往不同的指令会对应不同的功能，譬如<code>vue create app</code>的作用是创建项目，而<code>vue ui</code>的作用是开启一个服务以 UI 界面的方式来创建项目，也就是说不能的 命令 它的功能、别名以及使用示例这些信息都是不同的，如何实现呢？</p><p><a href="">commander</a> 模块我为了提供了对应的方法，下面给出具体的示例(演示使用，实际功能暂欠缺)。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* main.js 文件的内容 */</span></span><br><span class="line"><span class="comment">/* 0.导入模块 */</span></span><br><span class="line"><span class="keyword">const</span> program = <span class="built_in">require</span>(<span class="string">"commander"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 导入常量(package 包中的名称和版本号) */</span></span><br><span class="line"><span class="keyword">const</span> &#123; name, version &#125; = <span class="built_in">require</span>(<span class="string">"../package"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 1.vito-cli crete */</span></span><br><span class="line">program</span><br><span class="line">    <span class="comment">/*  命令的名称 */</span></span><br><span class="line">    .command(<span class="string">"create"</span>) </span><br><span class="line">    <span class="comment">/*  命令的别名 */</span></span><br><span class="line">    .alias(<span class="string">"c"</span>) </span><br><span class="line">    <span class="comment">/* 命令的描述 */</span></span><br><span class="line">    .description(<span class="string">"create a project whit vito-cli...."</span>) </span><br><span class="line">    <span class="comment">/* 该命令的具体功能(动作) */</span></span><br><span class="line">    .action(<span class="function"><span class="params">()</span> =&gt;</span> &#123; </span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`执行 action-&gt; create`</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 2.vito-cli config */</span></span><br><span class="line">program</span><br><span class="line">    .command(<span class="string">"config"</span>)</span><br><span class="line">    .alias(<span class="string">"conf"</span>)</span><br><span class="line">    .description(<span class="string">"config info...."</span>)</span><br><span class="line">    .action(<span class="function"><span class="params">()</span> =&gt;</span> &#123; </span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`执行 action-&gt; config`</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 3.vito-cli xxx  (其它未定义指令) */</span></span><br><span class="line">program</span><br><span class="line">    .command(<span class="string">"*"</span>)</span><br><span class="line">    .alias(<span class="string">""</span>)</span><br><span class="line">    .description(<span class="string">"command not found"</span>)</span><br><span class="line">    .action(<span class="function"><span class="params">()</span> =&gt;</span> &#123; </span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`执行 action-&gt; nothing`</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 4.示例信息 */</span></span><br><span class="line"><span class="keyword">const</span> examples = [</span><br><span class="line">    <span class="string">"vito-cli create &lt;project-name&gt;"</span>,</span><br><span class="line">    <span class="string">"vito-cli config get &lt;k&gt;"</span>,</span><br><span class="line">    <span class="string">"vito-cli config set &lt;k&gt; &lt;v&gt;"</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5.监听用户的help 事件</span></span><br><span class="line">program.on(<span class="string">'--help'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="comment">/* 当终端输入 vito-cli --help指令的时候打印nExamples信息 */</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'\nExamples:'</span>);</span><br><span class="line">    examples.forEach(<span class="function"><span class="params">example</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">`   <span class="subst">$&#123;example&#125;</span>`</span>))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 6.版本信息 + 命令行参数解析 */</span></span><br><span class="line">program.version(<span class="string">`version = <span class="subst">$&#123;version&#125;</span>`</span>).parse(process.argv);</span><br></pre></td></tr></table></figure></p><p>我们来看看此时，我们的工具拥有了哪些功能？<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">wendingding$ vito-cli --<span class="built_in">help</span></span><br><span class="line">Usage: vito-cli [options] [<span class="built_in">command</span>]</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -V, --version   output the version number</span><br><span class="line">  -h, --<span class="built_in">help</span>      display <span class="built_in">help</span> <span class="keyword">for</span> <span class="built_in">command</span></span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">  create|c        create a project whit vito-cli....</span><br><span class="line">  config|conf     config info....</span><br><span class="line">  *               <span class="built_in">command</span> not found</span><br><span class="line">  <span class="built_in">help</span> [<span class="built_in">command</span>]  display <span class="built_in">help</span> <span class="keyword">for</span> <span class="built_in">command</span></span><br><span class="line"></span><br><span class="line">Examples:</span><br><span class="line">   vito-cli create &lt;project-name&gt;</span><br><span class="line">   vito-cli config get &lt;k&gt;</span><br><span class="line">   vito-cli config <span class="built_in">set</span> &lt;k&gt; &lt;v&gt;</span><br><span class="line"></span><br><span class="line">wendingding$ vito-cli --version</span><br><span class="line">version = 1.0.1</span><br><span class="line"></span><br><span class="line">wendingding$ vito-cli create myapp</span><br><span class="line">执行 action-&gt; create</span><br><span class="line"></span><br><span class="line">wendingding$ vito-cli config</span><br><span class="line">执行 action-&gt; config</span><br><span class="line"></span><br><span class="line">wendingding$ vito-cli c app</span><br><span class="line">执行 action-&gt; create</span><br></pre></td></tr></table></figure></p><p>写到这里，脚手架工具的基本提示功能就已经实现了，但代码较长且脚手架的指令肯定不止 <code>create</code> 和 <code>config</code> 这么两个，如果指令较多那么就不太好了，因此这里适当调整下代码结构让其可维护性更高一些。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* main.js 文件的内容 */</span></span><br><span class="line"><span class="comment">/* 导入模块 */</span></span><br><span class="line"><span class="keyword">const</span> program = <span class="built_in">require</span>(<span class="string">"commander"</span>);</span><br><span class="line"><span class="comment">/* 导入常量(package 包中的名称和版本号) */</span></span><br><span class="line"><span class="keyword">const</span> &#123; name, version &#125; = <span class="built_in">require</span>(<span class="string">"../util/constants"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">    create: &#123; <span class="comment">// 项目创建(初始化)指令</span></span><br><span class="line">        description: <span class="string">'create project with vito-cli'</span>,</span><br><span class="line">        alias: <span class="string">'c'</span>,</span><br><span class="line">        examples: [</span><br><span class="line">            <span class="string">'vito-cli create &lt;project-name&gt;'</span>,</span><br><span class="line">        ],</span><br><span class="line">    &#125;,</span><br><span class="line">    config: &#123; <span class="comment">// 设置项目配置文件指令</span></span><br><span class="line">        description: <span class="string">'config info'</span>,</span><br><span class="line">        alias: <span class="string">'conf'</span>,</span><br><span class="line">        examples: [</span><br><span class="line">            <span class="string">'vito-cli config get &lt;k&gt;'</span>,</span><br><span class="line">            <span class="string">'vito-cli config set &lt;k&gt; &lt;v&gt;'</span>,</span><br><span class="line">        ],</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">'*'</span>: &#123;</span><br><span class="line">        description: <span class="string">'command not found'</span>,</span><br><span class="line">        alias: <span class="string">''</span>,</span><br><span class="line">        examples: [],</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.keys(actions).forEach(<span class="function">(<span class="params">action</span>) =&gt;</span> &#123;</span><br><span class="line">    program</span><br><span class="line">        <span class="comment">/* 命名的名称 */</span></span><br><span class="line">        .command(action)</span><br><span class="line">        <span class="comment">/* 命名的别名 */</span></span><br><span class="line">        .alias(actions[action].alias)</span><br><span class="line">        <span class="comment">/* 命令的描述信息 */</span></span><br><span class="line">        .description(actions[action].description)</span><br><span class="line">        <span class="comment">/* 命令的任务(功能) */</span></span><br><span class="line">        .action(<span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="comment">// 动作</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`执行 action-&gt;`</span>, action);</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听用户的help 事件</span></span><br><span class="line">program.on(<span class="string">'--help'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'\nExamples:'</span>);</span><br><span class="line">    <span class="built_in">Reflect</span>.ownKeys(actions).forEach(<span class="function">(<span class="params">action</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">        actions[action].examples.forEach(<span class="function">(<span class="params">example</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`  <span class="subst">$&#123;example&#125;</span>`</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 版本信息 + 命令行参数解析 */</span></span><br><span class="line">program.version(<span class="string">`version = <span class="subst">$&#123;version&#125;</span>`</span>).parse(process.argv);</span><br></pre></td></tr></table></figure><ul><li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="noopener">花田半亩</a></li><li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="noopener">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li><li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;tip&quot;&gt;这是系列文章 &lt;a href=&quot;&quot;&gt;如何自己撸一个脚手架&lt;/a&gt; 的第一篇，主要讲解脚手架工具中的核心模块命令行参数解析功能的实现，重点讲解 Node 模块 &lt;a href=&quot;&quot;&gt;commander&lt;/a&gt;的使用。&lt;/div&gt;

&lt;p&gt;在前端开
      
    
    </summary>
    
    
      <category term="Gossip" scheme="https://weibo.com/u/3800117445/tags/Gossip/"/>
    
  </entry>
  
  <entry>
    <title>Gossip - Objet 和 Array 数据劫持</title>
    <link href="https://weibo.com/u/3800117445/2019/07/21/Gossip%20-%20%E5%AF%B9%E8%B1%A1%E5%92%8C%E6%95%B0%E7%BB%84%E7%9A%84%E8%AF%BB%E5%86%99%E5%8A%AB%E6%8C%81/"/>
    <id>https://weibo.com/u/3800117445/2019/07/21/Gossip - 对象和数组的读写劫持/</id>
    <published>2019-07-20T16:00:09.000Z</published>
    <updated>2020-04-26T04:05:52.909Z</updated>
    
    <content type="html"><![CDATA[<div class="tip">本文讨论如何监听对象中所有属性的读和写操作，以及对于数组的劫持特殊处理，本文将从侧面来介绍 Vue2.X版本中响应式数据监听的原理。本文将用到 <a href="">Object.defineProperty</a>方法，该方法以及[getter 和 setter] 方法的具体使用方式，可以参考另一篇<a href="http://wendingding.com/2019/08/25/Gossip%20-%20defineProperty/" target="_blank" rel="noopener">博客文章</a>。</div><div class="titleX"><strong>对象劫持</strong></div><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">isObject</span>(<span class="params">o</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> o === <span class="string">"object"</span> &amp;&amp; o != <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*核心函数：通过Object.defineProperty方法实现劫持*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">defineReactive</span>(<span class="params">data, key, value</span>) </span>&#123;</span><br><span class="line">    <span class="comment">/* 递归调用：解决value也是对象的情况 */</span></span><br><span class="line">    observe(value);</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(data, key, &#123;</span><br><span class="line">        get() &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;key&#125;</span>--读`</span>)</span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;,</span><br><span class="line">        set(newValue) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;key&#125;</span>--写`</span>)</span><br><span class="line">                <span class="comment">/* 如果数据的值没有改变那么就直接返回 */</span></span><br><span class="line">            <span class="keyword">if</span> (value === newValue) <span class="keyword">return</span>;</span><br><span class="line">            <span class="comment">/* 如果设置的新数据是对象，那么也应该进行监听 */</span></span><br><span class="line">            observe(newValue);</span><br><span class="line">            value = newValue;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* Observer 类(构造函数) */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(val) &#123;</span><br><span class="line">        <span class="keyword">this</span>.walk(val)</span><br><span class="line">    &#125;</span><br><span class="line">    walk(data) &#123;</span><br><span class="line">        <span class="comment">/* 获取当前对象所有可枚举的 key */</span></span><br><span class="line">        <span class="keyword">let</span> keys = <span class="built_in">Object</span>.keys(data);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 遍历所有的 keys，通过 Object.defineProperty 给所有的 key 都添加 getter和 setter */</span></span><br><span class="line">        keys.forEach(<span class="function"><span class="params">key</span> =&gt;</span> defineReactive(data, key, data[key]));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">observe</span>(<span class="params">o</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!isObject(o)) <span class="keyword">return</span>; <span class="comment">/* 排除对象的情况 */</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Observer(o); <span class="comment">/* 获取Observer的实例 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 测试数据 */</span></span><br><span class="line"><span class="keyword">let</span> data = &#123;</span><br><span class="line">    person: &#123;</span><br><span class="line">        name: <span class="string">"zs"</span>,</span><br><span class="line">        age: <span class="number">18</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">observe(data);</span><br></pre></td></tr></table></figure><p>上面代码同的核心方法是<code>defineReactive函数</code>，在该函数的内部我们通过<code>Object.defineProperty</code>方法实现了对对象中属性的读(<code>get</code>)和写(<code>set</code>)操作的监听。<code>Observer</code>类用于构建 observe实例对象，该实例的<code>walk</code>方法通过遍历的方式为对象中所有的属性都实现了<code>getter 和 setter 方法</code>。</p><p>接下来，我们给出一组测试数据并贴出对应的显示结果。</p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/objtest.png?raw=true"></p><p>通过对代码的研究和对数据的测试，我们验证了上面代码基本上能够完成对对象数据读写操作的监听，但仍然存在一些不足。</p><p><strong>① 如果是新增加属性，那么则无法监听。</strong><br><strong>② 如果是数组的结构，那么也无法监听。</strong></p><div class="titleX"><strong>数组劫持</strong></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">isObject</span>(<span class="params">o</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> o === <span class="string">"object"</span> &amp;&amp; o != <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">defineReactive</span>(<span class="params">data, key, value</span>) </span>&#123;</span><br><span class="line">    <span class="comment">/* 递归调用：解决value也是对象的情况 */</span></span><br><span class="line">    observe(value);</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(data, key, &#123;</span><br><span class="line">        get() &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;key&#125;</span>--读`</span>)</span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;,</span><br><span class="line">        set(newValue) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;key&#125;</span>--写`</span>)</span><br><span class="line">                <span class="comment">/* 如果数据的值没有改变那么就直接返回 */</span></span><br><span class="line">            <span class="keyword">if</span> (value === newValue) <span class="keyword">return</span>;</span><br><span class="line">            <span class="comment">/* 如果设置的新数据是对象，那么也应该进行监听 */</span></span><br><span class="line">            observe(newValue);</span><br><span class="line">            value = newValue;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 获取数组原型的方法 */</span></span><br><span class="line"><span class="keyword">let</span> oldArrayMethods = <span class="built_in">Array</span>.prototype;</span><br><span class="line"><span class="comment">/* 把oldArrayMethods作为原型对象创建一个新的空的对象 */</span></span><br><span class="line"><span class="keyword">let</span> newArrayMethods = <span class="built_in">Object</span>.create(oldArrayMethods);</span><br><span class="line"><span class="comment">/* 整理数组中需要重写的方法 */</span></span><br><span class="line"><span class="keyword">let</span> methods = [<span class="string">"pop"</span>, <span class="string">"push"</span>, <span class="string">"shift"</span>, <span class="string">"unshift"</span>, <span class="string">"sort"</span>, <span class="string">"reverse"</span>, <span class="string">"splice"</span>];</span><br><span class="line">methods.forEach(<span class="function"><span class="params">method</span> =&gt;</span> &#123;</span><br><span class="line">    newArrayMethods[method] = <span class="function"><span class="keyword">function</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> __ob__ = <span class="keyword">this</span>.__ob__;</span><br><span class="line">        <span class="keyword">let</span> result = oldArrayMethods[method].apply(<span class="keyword">this</span>, args);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`监听到<span class="subst">$&#123;method&#125;</span>方法`</span>, <span class="keyword">this</span>, args);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 注意：新添加的数据可能是对象也需要监听读写操作 */</span></span><br><span class="line">        <span class="comment">/* 1.先获取新添加的数据参数 */</span></span><br><span class="line">        <span class="keyword">let</span> insetData;</span><br><span class="line">        <span class="keyword">switch</span> (method) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"push"</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"unshift"</span>:</span><br><span class="line">                insetData = args;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"splice"</span>:</span><br><span class="line">                insetData = args.slice(<span class="number">2</span>);</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"insetData"</span>, insetData);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 2.对新添加的数据进行监听 */</span></span><br><span class="line">        <span class="keyword">if</span> (insetData) __ob__.observerArr(insetData);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Observer 类(构造函数) */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(val) &#123;</span><br><span class="line">            <span class="comment">/* 区分对象和数组的情况 */</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(val)) &#123;</span><br><span class="line">                <span class="comment">/* 给当前的对象定义__ob__属性,该属性指向的是自己 */</span></span><br><span class="line">            <span class="built_in">Object</span>.defineProperty(val, <span class="string">"__ob__"</span>, &#123;</span><br><span class="line">                configurable: <span class="literal">false</span>,</span><br><span class="line">                enumerable: <span class="literal">false</span>,</span><br><span class="line">                value: <span class="keyword">this</span></span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="comment">/* 重写数组的原型方法，在这些重写的方法内部进行监听 */</span></span><br><span class="line">            <span class="built_in">Reflect</span>.setPrototypeOf(val, newArrayMethods);</span><br><span class="line">            <span class="keyword">this</span>.observerArr(val);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.walk(val)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    walk(data) &#123;</span><br><span class="line">        <span class="comment">/* 获取当前对象所有可枚举的 key */</span></span><br><span class="line">        <span class="keyword">let</span> keys = <span class="built_in">Object</span>.keys(data);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 遍历所有的 keys，通过 Object.defineProperty 给所有的 key 都添加 getter和 setter */</span></span><br><span class="line">        keys.forEach(<span class="function"><span class="params">key</span> =&gt;</span> defineReactive(data, key, data[key]));</span><br><span class="line">    &#125;</span><br><span class="line">    observerArr(arr) &#123;</span><br><span class="line">        arr.forEach(<span class="function"><span class="params">item</span> =&gt;</span> observe(item));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">observe</span>(<span class="params">o</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!isObject(o)) <span class="keyword">return</span>; <span class="comment">/* 排除对象的情况 */</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Observer(o); <span class="comment">/* 获取Observer的实例 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 测试数据 */</span></span><br><span class="line"><span class="keyword">let</span> data = &#123;</span><br><span class="line">    person: &#123;</span><br><span class="line">        name: <span class="string">"zs"</span>,</span><br><span class="line">        age: <span class="number">18</span></span><br><span class="line">    &#125;,</span><br><span class="line">    friends: [&#123;</span><br><span class="line">        name: <span class="string">"佩琪"</span>,</span><br><span class="line">        age: <span class="number">3</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">        name: <span class="string">"巧虎"</span>,</span><br><span class="line">        age: <span class="number">5</span></span><br><span class="line">    &#125;]</span><br><span class="line">&#125;;</span><br><span class="line">observe(data);</span><br></pre></td></tr></table></figure><p>根据测试数据贴出对应的显示结果如下所示。</p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/objtest2.png?raw=true"></p><p>上述代码完成了对数组数据的读写监听(劫持)，但仍然存在一些无法处理的情况，下面简单列出。</p><p><strong>问题1</strong>：如果我们通过数组的下标来访问和修改数据，那么无法监听。<br><strong>问题2</strong>：如果我们通过数组的 length 属性来操作(删除)数组，那么也无法监听。</p><div class="tip">上面的这些问题在 Vue 2.X 版本中主要通过 Vue.set() 或者是 vm.$set() 来进行实现。</div><ul><li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="noopener">花田半亩</a></li><li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="noopener">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li><li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;tip&quot;&gt;本文讨论如何监听对象中所有属性的读和写操作，以及对于数组的劫持特殊处理，本文将从侧面来介绍 Vue2.X版本中响应式数据监听的原理。本文将用到 &lt;a href=&quot;&quot;&gt;Object.defineProperty&lt;/a&gt;方法，该方法以及[getter
      
    
    </summary>
    
    
      <category term="Gossip" scheme="https://weibo.com/u/3800117445/tags/Gossip/"/>
    
  </entry>
  
  <entry>
    <title>Gossip - defineProperty</title>
    <link href="https://weibo.com/u/3800117445/2019/05/25/Gossip%20-%20defineProperty/"/>
    <id>https://weibo.com/u/3800117445/2019/05/25/Gossip - defineProperty/</id>
    <published>2019-05-24T16:00:09.000Z</published>
    <updated>2020-04-26T01:39:21.238Z</updated>
    
    <content type="html"><![CDATA[<div class="tip">本文介绍<code>Object.defineProperty()</code>方法，并基于此简单讨论数据劫持的实现方案。</div><h3 id="defineProperty"><a href="#defineProperty" class="headerlink" title="defineProperty"></a>defineProperty</h3><p><code>Object.getOwnPropertyDescriptor(target,attrName)</code>方法用于获取对象的属性描述符对象，该方法的第一个参数为目标对象，第二个参数为指定的属性名。</p><p>我们可以利用该方法来查看对象属性的描述符配置项(包括：<code>value值</code>、<code>writable可重写</code>、<code>enumerable可枚举</code>和<code>configurable可配置</code>等)。默认正常的对象属性中，这些配置项的值都是 <code>true</code>。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123; <span class="attr">name</span>: <span class="string">"文顶顶"</span>, <span class="attr">age</span>: <span class="number">18</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> des = <span class="built_in">Object</span>.getOwnPropertyDescriptor(o, <span class="string">"name"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(des);</span><br><span class="line"><span class="comment">/* &#123; value: '文顶顶',writable: true,enumerable: true,configurable: true &#125; */</span></span><br></pre></td></tr></table></figure><p><code>Object.defineProperty(target,attrName,options)</code>方法用于定义(设置)对象并对指定的属性描述符对象进行配置。该方法的第一个参数为目标对象，第二个参数为指定的属性名，第三个参数为配置对象。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 备注：给o对象添加address属性，并设置属性值为香悦山 */</span></span><br><span class="line"><span class="comment">/* 说明：默认新添加的属性，属性描述配置项均为false */</span></span><br><span class="line"><span class="keyword">var</span> o = &#123; <span class="attr">name</span>: <span class="string">"文顶顶"</span>, <span class="attr">age</span>: <span class="number">18</span> &#125;;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(o, <span class="string">"address"</span>, &#123; <span class="attr">value</span>: <span class="string">"香悦山"</span> &#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getOwnPropertyDescriptor(o, <span class="string">"address"</span>));</span><br><span class="line"><span class="comment">/* &#123; value: '香悦山',writable: false,enumerable: false,configurable: false &#125; */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 备注：重新定义age属性，设置属性值为20，该属性值可配置但无法重写和枚举 */</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(o, <span class="string">"age"</span>, &#123; <span class="attr">value</span>: <span class="number">20</span>, <span class="attr">enumerable</span>: <span class="literal">false</span>, <span class="attr">writable</span>: <span class="literal">false</span> &#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getOwnPropertyDescriptor(o, <span class="string">"age"</span>));</span><br><span class="line"><span class="comment">/* &#123; value: 20,writable: false,enumerable: false,configurable: true &#125; */</span></span><br><span class="line">o.age = <span class="number">99</span>;</span><br><span class="line"><span class="built_in">console</span>.log(o.age); <span class="comment">//20</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> o) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(key, o[key]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* name 文顶顶 */</span></span><br><span class="line"><span class="comment">/* 在for...in循环中，age键值对 ，以及新添加的address键值对均没有被枚举 */</span></span><br></pre></td></tr></table></figure><p><code>Object.defineProperties(target,options)</code>方法用于一次性设置(<code>添加</code>)对象的多个属性，与之对应的<code>Object.getOwnPropertyDescriptors(target)</code>方法用于获取对象中所有成员的 <strong>详细</strong> 配置信息。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.defineProperties(o, &#123;</span><br><span class="line">    <span class="string">"className"</span>: &#123;</span><br><span class="line">        value: <span class="string">"H5"</span>,</span><br><span class="line">        configurable: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"friends"</span>: &#123;</span><br><span class="line">        value: [<span class="string">"胡适"</span>, <span class="string">"沈从文"</span>, <span class="string">"辜鸿铭"</span>],</span><br><span class="line">        configurable: <span class="literal">true</span>,</span><br><span class="line">        writable: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"_____"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getOwnPropertyDescriptors(o));</span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">&#123;   name:&#123; value: '文顶顶', writable: true,enumerable: true,configurable: true &#125;,</span></span><br><span class="line"><span class="comment">    age:&#123; value: 20,writable: false,enumerable: false,configurable: true &#125;,</span></span><br><span class="line"><span class="comment">    address:&#123; value: '香悦山',writable: false,enumerable: false,configurable: false &#125;,</span></span><br><span class="line"><span class="comment">    className:&#123; value: 'H5',writable: false,enumerable: false,configurable: true &#125;,</span></span><br><span class="line"><span class="comment">    friends:&#123; value: [ '胡适', '沈从文', '辜鸿铭' ],</span></span><br><span class="line"><span class="comment">              writable: true, enumerable: false,configurable: true &#125; &#125; */</span></span><br></pre></td></tr></table></figure></p><div class="tip"><a href="">Object.defineProperty </a>方法主要用于对象中的某个属性进行访问配置，如果需要对整个对象执行类似的操作则可使用<code>Object.preventExtensions()</code>、<code>Object.seal()</code>和<code>Object.freeze()</code> 等方法，它们分别对应着<code>禁止扩展</code>、<code>密封对象</code>以及要<code>冻结</code>对象。</div><h3 id="Getter-and-Setter"><a href="#Getter-and-Setter" class="headerlink" title="Getter and Setter"></a>Getter and Setter</h3><p>对于对象字面量创建的对象而言，我们可以直接通过<code>get attrName</code>或<code>set attrName</code>的方式来对属性的设置和读取操作进行拦截和监听。通过下面的代码，我们可以观察到，对象属性的 Getter 和 Setter 的代码并不复杂但却需要借助一个无关的中间变量<code>_age</code>来实现。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* getter 和 setter */</span></span><br><span class="line"><span class="keyword">var</span> o = &#123;</span><br><span class="line">    name: <span class="string">"文顶顶"</span>,</span><br><span class="line">    _age: <span class="number">17</span>,</span><br><span class="line">    get age() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"监听到执行了getter方法"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>._age;</span><br><span class="line">    &#125;,</span><br><span class="line">    set age(val) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"监听到执行了setter方法"</span>);</span><br><span class="line">        <span class="keyword">this</span>._age = val;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(o.age);</span><br><span class="line">o.age = <span class="number">100</span>;</span><br><span class="line"><span class="built_in">console</span>.log(o.age);</span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">监听到执行了getter方法</span></span><br><span class="line"><span class="comment">17</span></span><br><span class="line"><span class="comment">监听到执行了setter方法</span></span><br><span class="line"><span class="comment">监听到执行了getter方法</span></span><br><span class="line"><span class="comment">100 </span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></p><p><code>Object.defineProperty()</code>方法的配置对象中也支持对象属性的 <code>Getter</code> 和 <code>Setter</code>操作。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> o = &#123; <span class="attr">name</span>: <span class="string">"文顶顶"</span>, <span class="attr">age</span>: <span class="number">17</span> &#125;;</span><br><span class="line">    <span class="keyword">var</span> temp = <span class="number">18</span>;</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(o, <span class="string">"age"</span>, &#123;</span><br><span class="line">        get() &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"——getter———"</span>);</span><br><span class="line">            <span class="keyword">return</span> temp;</span><br><span class="line">        &#125;,</span><br><span class="line">        set(val) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"——setter———"</span>);</span><br><span class="line">            temp = val;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">console</span>.log(o.age);</span><br><span class="line">    o.age = <span class="number">100</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(o.age);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 执行情况 */</span></span><br><span class="line">    <span class="comment">// ——getter———</span></span><br><span class="line">    <span class="comment">// 18</span></span><br><span class="line">    <span class="comment">// ——setter———</span></span><br><span class="line">    <span class="comment">// ——getter———</span></span><br><span class="line">    <span class="comment">// 100</span></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure></p><p><hr><br>利用<code>Object.defineProperty()</code>方法，来监听对象属性的设置和读取操作，可以不必借助于中间属性来实现而改用一个外部变量即可，这样的处理方式为代码的封装提供了可能。</p><p><strong>注意</strong> 在 <code>defineProperty</code> 方法内部使用 <code>set 和 get</code> 函数时不能与 <code>value 和 writable</code> 共存。上述的代码演示了监听对象单个属性读写的方案，如果需要为对象中所有的属性都添加 <code>set 和 get</code> 监听，可以考虑对上述代码进行封装。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> observer = <span class="function">(<span class="params">target</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> target !== <span class="string">"object"</span> || target == <span class="literal">null</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> target) &#123;</span><br><span class="line">        <span class="keyword">if</span> (target.hasOwnProperty(key)) defineReactive(target, key, target[key]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> defineReactive = <span class="function">(<span class="params">target, key, val</span>) =&gt;</span> &#123;</span><br><span class="line">    observer(val); <span class="comment">/* 递归解决多层对象解构问题 */</span></span><br><span class="line">    <span class="comment">/* val 是外部传入的参数：就是指定属性的默认值 */</span></span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(target, key, &#123;</span><br><span class="line">        get() &#123;</span><br><span class="line">            handler(<span class="string">"getter"</span>)</span><br><span class="line">            <span class="keyword">return</span> val;</span><br><span class="line">        &#125;,</span><br><span class="line">        set(_val) &#123;</span><br><span class="line">            handler(<span class="string">"setter"</span>)</span><br><span class="line">            val = _val;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> handler = <span class="function">(<span class="params">text</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"监听到"</span> + text);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 测试代码 */</span></span><br><span class="line"><span class="keyword">var</span> o = &#123; <span class="attr">name</span>: <span class="string">"文顶顶"</span>, <span class="attr">age</span>: <span class="number">18</span>, <span class="attr">car</span>: &#123; <span class="attr">color</span>: <span class="string">"white"</span> &#125; &#125;;</span><br><span class="line">observer(o);</span><br><span class="line">o.age = <span class="number">100</span>;</span><br><span class="line"><span class="built_in">console</span>.log(o.age);</span><br><span class="line">o.car.color = <span class="string">"black"</span>;</span><br><span class="line"><span class="built_in">console</span>.log(o.car.color);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 执行情况 */</span></span><br><span class="line"><span class="comment">// 监听到setter</span></span><br><span class="line"><span class="comment">// 监听到getter</span></span><br><span class="line"><span class="comment">// 100</span></span><br><span class="line"><span class="comment">// 监听到getter</span></span><br><span class="line"><span class="comment">// 监听到setter</span></span><br><span class="line"><span class="comment">// 监听到getter</span></span><br><span class="line"><span class="comment">// 监听到getter</span></span><br><span class="line"><span class="comment">// black</span></span><br></pre></td></tr></table></figure></p><ul><li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="noopener">花田半亩</a></li><li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="noopener">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li><li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;tip&quot;&gt;本文介绍&lt;code&gt;Object.defineProperty()&lt;/code&gt;方法，并基于此简单讨论数据劫持的实现方案。&lt;/div&gt;

&lt;h3 id=&quot;defineProperty&quot;&gt;&lt;a href=&quot;#defineProperty&quot; clas
      
    
    </summary>
    
    
      <category term="Gossip" scheme="https://weibo.com/u/3800117445/tags/Gossip/"/>
    
  </entry>
  
  <entry>
    <title>Gossip - Throttle and Debounce</title>
    <link href="https://weibo.com/u/3800117445/2019/05/24/Gossip%20-%20Throttle%20And%20Debounce%20/"/>
    <id>https://weibo.com/u/3800117445/2019/05/24/Gossip - Throttle And Debounce /</id>
    <published>2019-05-23T16:00:09.000Z</published>
    <updated>2020-04-27T08:11:39.653Z</updated>
    
    <content type="html"><![CDATA[<div class="tip">本文讨论前端开发中 函数防抖 和 函数节流，它们的应用、区别以及简单实现。</div><p>在前端开发中我们可能经常需要给(页面)标签绑定一些持续触发的事件，如 <code>resize</code>、<code>scroll</code>、<code>input</code>、<code>mousemove</code>、<code>keyup</code>和<code>keydown</code> 等，但有些时候我们并不希望在事件持续触发的过程中那么频繁地去执行函数。</p><p>譬如，如果用户有频繁的<code>resize</code> 和 <code>scroll</code> 行为，那么会导致页面不断的被重新渲染，如果在绑定的回调函数中存在大量的 DOM 操作，那么还会出现页面的卡顿，针对这种情况，常用的解决方式就是利用<strong>节流( <a href="">throttle</a> )</strong>和<strong>防抖( <a href="">debounce</a> )</strong>来优化高频事件，降低代码的执行频率。</p><p>若想对比默认情况、函数节流和函数防抖的情况，可以参考<a href="https://codepen.io/chriscoyier/embed/vOZNQV?height=736&amp;theme-id=1&amp;slug-hash=vOZNQV&amp;default-tab=result&amp;user=chriscoyier&amp;name=cp_embed_1" target="_blank" rel="noopener">演示效果-点击我</a>来直观感受它们的区别。</p><div class="titleX"><strong>函数节流</strong></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 原先： 1秒 执行 100次 --&gt;</span><br><span class="line">&lt;!-- 调节： 1秒 执行 1次--&gt;</span><br><span class="line">&lt;!-- 10秒钟执行1000次任务调整后10秒钟最多执行10次 --&gt;</span><br><span class="line">&lt;!-- 换个例子 --&gt;</span><br><span class="line">&lt;!-- 原先： 1秒中从池塘中流水100L --&gt;</span><br><span class="line">&lt;!-- 调节： 1秒钟从池塘中流水1L --&gt;</span><br><span class="line">&lt;!-- 10秒钟流出1000L水调整后10秒钟最多流出10L 水，这就是节流的操作。 --&gt;</span><br></pre></td></tr></table></figure><p><strong>函数节流</strong> 可以通过<code>时间戳</code>来实现。</p><p>下面，我们试着以代码的方式来探究函数节流的细节和具体实现。<br>我们在页面中提供一个按钮，给按钮绑定点击事件，那么正常情况是每当按钮点击一次的时候，对应的事件处理函数就会被触发执行一次。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 页面标签： &lt;button&gt;按钮&lt;/button&gt;  */</span></span><br><span class="line"><span class="keyword">let</span> task = <span class="function">(<span class="params">e</span>) =&gt;</span> <span class="built_in">console</span>.log(<span class="string">"click button"</span>, e);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> oBtn = <span class="built_in">document</span>.querySelector(<span class="string">"button"</span>);</span><br><span class="line">oBtn.addEventListener(<span class="string">"click"</span>, task);</span><br></pre></td></tr></table></figure></p><p>如果用户在短时间内快速连续多次的点击按钮，那么事件处理函数也会随之触发很多次。<span style="color:red"><strong>函数节流</strong>规定在一个单位时间内，只能触发一次函数。如果这个单位时间内触发多次函数，只有一次生效</span>。换言之，函数节流控制在固定的时间单位内，事件任务只会执行(生效)一次。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 事件处理函数 */</span></span><br><span class="line"><span class="keyword">let</span> task = <span class="function">(<span class="params">e</span>) =&gt;</span> <span class="built_in">console</span>.log(<span class="string">"click button"</span>, e);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 函数节流 */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">func, wait</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> previous = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        context = <span class="keyword">this</span>;</span><br><span class="line">        args = <span class="built_in">arguments</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> now = <span class="built_in">Date</span>.now();</span><br><span class="line">        <span class="keyword">if</span> (now - previous &gt; wait) &#123;</span><br><span class="line">            func.apply(context, args);</span><br><span class="line">            previous = now;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 绑定事件 */</span></span><br><span class="line"><span class="keyword">let</span> oBtn = <span class="built_in">document</span>.querySelector(<span class="string">"button"</span>);</span><br><span class="line">oBtn.addEventListener(<span class="string">"click"</span>, throttle(task, <span class="number">1000</span>));</span><br></pre></td></tr></table></figure><p>上面给出了函数节流的简单实现方式，代码中封装了<code>throttle 函数</code>，该函数接收任何(事件)函数和间隔时间两个参数，并返回一个新在函数中。<code>throttle 函数</code>的核心是，在返回的函数中通过获取当前<code>时间戳</code>并和间隔时间进行比较的方式来控制是否应该执行任务函数。</p><p>当事件处理函数第一次执行后，后续点击事件被触发的时候，如果<code>now - previous &gt; wait</code> 成立(距离上次事件触发的时间已经超过了指定间隔时间)，那么则执行任务函数，否则就忽略这次点击事件。注意<code>func.apply(context, args)</code>这行代码的作用是，把具体的标签绑定给事件处理函数中的<code>this</code>, 此外在事件处理函数中可能还会存在事件对象等参数的传递，需要考虑到这种情况。</p><div class="tip">关于函数节流的代码实现，我们还可以阅读和参考下知名框架<a href="https://github.com/jashkenas/underscore/blob/master/underscore.js" target="_blank" rel="noopener"> underscore </a>的写法，该框架对函数节流提供了更精确的控制，譬如可以通过传递参数的方式来控制 第一次点击事件是否生效，以及最后一次的点击是否要触发等，下面给出其函数节流代码的核心实现。</div><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">func, wait, options</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> timeout,args, context, previous = <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> throttled = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        context = <span class="keyword">this</span>;</span><br><span class="line">        args = <span class="built_in">arguments</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> now = <span class="built_in">Date</span>.now();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 该行代码设置第一次点击不生效 */</span></span><br><span class="line">        <span class="keyword">if</span> (!previous &amp;&amp; options.leading === <span class="literal">false</span>) previous = now;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> remaning = wait - (now - previous);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 如果：是第一次触发事件 */</span></span><br><span class="line">        <span class="comment">/* 那么：执行事件处理函数，并更新previous值，如果有定时器，那么就进行清理操作 */</span></span><br><span class="line">        <span class="keyword">if</span> (remaning &lt;= <span class="number">0</span>) &#123; </span><br><span class="line">            <span class="keyword">if</span> (timeout) &#123;</span><br><span class="line">                clearTimeout(timeout);</span><br><span class="line">                timeout = <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            func.apply(context, args);</span><br><span class="line">            previous = now;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!timeout &amp;&amp; options.trailing !== <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="comment">/* 如果：不是第一次触发事件 &amp;&amp; 定时器为空 &amp;&amp;  trailing == true */</span></span><br><span class="line">        <span class="comment">/* 那么：总是执行最后一次的事件触发的处理函数 */</span></span><br><span class="line">            timeout = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span>&#123;</span><br><span class="line">                previous = options.leading === <span class="literal">false</span> ? <span class="number">0</span> : <span class="built_in">Date</span>.now();</span><br><span class="line">                func.apply(context, args);</span><br><span class="line">                args = context = <span class="literal">null</span></span><br><span class="line">            &#125;, remaning);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> throttled;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 任何处理函数 */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">task</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'click'</span>, e);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">oBtn.addEventListener(<span class="string">'click'</span>, throttle(task, <span class="number">1000</span>, &#123;</span><br><span class="line">    leading: <span class="literal">false</span>,<span class="comment">/* 设置为 false的时候，第一次点击不生效 */</span></span><br><span class="line">    trailing: <span class="literal">true</span> <span class="comment">/* 设置最终一次点击总是触发 */</span></span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure><div class="titleX"><strong>函数防抖</strong></div><p>函数防抖（<a href="">debounce</a>）就是指<span style="color:red">触发事件后在 n 秒内函数只能执行一次，如果在 n 秒内又触发了事件，则会从头重新计算函数执行时间</span>。</p><p><strong>函数防抖</strong> 可以通过<code>定时器</code>来实现。</p><p>我们假设，当点击页面按钮的时候，在1秒的时间内事件处理函数只能执行一次，如果下次点击按钮的时候还没有超过1秒这个时间间隔，那么就重新开始计时。下面给出一份简单的代码实现供大家参考：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* &lt;button&gt;&lt;/button&gt; */</span></span><br><span class="line"><span class="comment">/* 任务执行函数 */</span></span><br><span class="line"><span class="keyword">let</span> task = <span class="function">(<span class="params">e</span>) =&gt;</span> <span class="built_in">console</span>.log(<span class="string">"task"</span>, e);  </span><br><span class="line"><span class="comment">/* 防抖函数 */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">func, wait</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> timer;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;    </span><br><span class="line">        clearTimeout(timer); <span class="comment">/* 先清理以前的定时器(延迟函数) */</span></span><br><span class="line">        <span class="keyword">let</span> context = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">let</span> args = <span class="built_in">arguments</span>;  </span><br><span class="line">        <span class="comment">/* 开启定时器，指定时间后执行任务函数 task */</span></span><br><span class="line">        timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            func.apply(context, args);</span><br><span class="line">            timer = <span class="literal">null</span>;</span><br><span class="line">        &#125;, wait);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;  </span><br><span class="line"><span class="comment">/* 获取标签 */</span></span><br><span class="line"><span class="keyword">let</span> oBtn = <span class="built_in">document</span>.querySelector(<span class="string">"button"</span>);</span><br><span class="line"><span class="comment">/* 注册事件 */</span></span><br><span class="line">oBtn.addEventListener(<span class="string">"click"</span>, debounce(task, <span class="number">1000</span>));</span><br></pre></td></tr></table></figure><p>稍微调整下上面的代码，假设我们想要通过一个参数来控制是否要在第一次触发事件的时候，执行任务函数，那么可以参考下面的写法:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* &lt;button&gt;&lt;/button&gt; */</span></span><br><span class="line"><span class="comment">/* 任务执行函数 */</span></span><br><span class="line"><span class="keyword">let</span> task = <span class="function">(<span class="params">e</span>) =&gt;</span> <span class="built_in">console</span>.log(<span class="string">"task"</span>, e);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">防抖函数</span></span><br><span class="line"><span class="comment">func:具体的事件处理函数(任务函数)</span></span><br><span class="line"><span class="comment">wait:规定的时间(单位毫秒)</span></span><br><span class="line"><span class="comment">immediate：布尔型参数，开始的时候是否先执行一次</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">func, wait, immediate</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> timer;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">        clearTimeout(timer); <span class="comment">/* 清理以前的定时器(延迟函数) */</span></span><br><span class="line">        <span class="keyword">let</span> context = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">let</span> args = <span class="built_in">arguments</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 是否要在最开始的时候，先执行一次 */</span></span><br><span class="line">        <span class="keyword">if</span> (immediate) &#123;</span><br><span class="line">            <span class="keyword">let</span> callNow = !timer;</span><br><span class="line">            <span class="keyword">if</span> (callNow) func.apply(context, args);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 开启定时器，指定时间后执行任务函数 task */</span></span><br><span class="line">        timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            func.apply(context, args);</span><br><span class="line">            timer = <span class="literal">null</span>;</span><br><span class="line">        &#125;, wait);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 获取标签 */</span></span><br><span class="line"><span class="keyword">let</span> oBtn = <span class="built_in">document</span>.querySelector(<span class="string">"button"</span>);</span><br><span class="line"><span class="comment">/* 注册事件 */</span></span><br><span class="line">oBtn.addEventListener(<span class="string">"click"</span>, debounce(task, <span class="number">1000</span>, <span class="literal">true</span>));</span><br></pre></td></tr></table></figure></p><p>总结下,<code>函数防抖</code> 和 <code>函数节流</code>都是防止某一事件的频繁触发，但原理却不一样：<strong>函数防抖是某一段时间内只执行一次，而函数节流是间隔时间执行</strong>。</p><div class="titleX"><strong>源码赏析</strong></div><p>最后，简单贴出著名框架 <a href="https://lodash.com/" target="_blank" rel="noopener">lodash</a> 中关于函数防抖和函数节流的部分演示代码，并附上 Github<a href="https://github.com/lodash/lodash/" target="_blank" rel="noopener">开源地址</a>。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* debounce.js 文件实现 */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">func, wait, opts = &#123;&#125;</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> maxWait;</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">'maxWait'</span> <span class="keyword">in</span> opts) &#123;</span><br><span class="line">        maxWait = opts.maxWait;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> leading = <span class="literal">true</span>; <span class="comment">// 第一次点击时触发</span></span><br><span class="line">    <span class="keyword">let</span> trailing = <span class="literal">true</span>; <span class="comment">// 最后一次也要触发</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> lastCallTime; <span class="comment">// 最后调用的时间 previous</span></span><br><span class="line">    <span class="keyword">let</span> timeout;</span><br><span class="line">    <span class="keyword">let</span> lastThis; <span class="comment">// 返回函数的this</span></span><br><span class="line">    <span class="keyword">let</span> lastArgs; <span class="comment">// 返回函数的参数</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// shouldInvoke 表示是否应该调用</span></span><br><span class="line">    <span class="keyword">let</span> lastInvokeTime;</span><br><span class="line">    <span class="keyword">let</span> shouldInvoke = <span class="function"><span class="keyword">function</span>(<span class="params">now</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> sinceLastTime = now - lastCallTime;</span><br><span class="line">        <span class="keyword">let</span> sinceLastInvoke = now - lastInvokeTime;</span><br><span class="line">        <span class="comment">// 第一次</span></span><br><span class="line">        <span class="keyword">return</span> lastCallTime === <span class="literal">undefined</span> </span><br><span class="line">        || sinceLastTime &gt; wait </span><br><span class="line">        || sinceLastInvoke &gt;= maxWait;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// leadingEdge 是否第一次执行</span></span><br><span class="line">    <span class="keyword">let</span> invokeFunc = <span class="function"><span class="keyword">function</span>(<span class="params">time</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 最终的调用函数的时间</span></span><br><span class="line">        lastInvokeTime = time;</span><br><span class="line">        func.apply(lastThis, lastArgs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// startTimer就是开启了一个定时器</span></span><br><span class="line">    <span class="keyword">let</span> startTimer = <span class="function"><span class="keyword">function</span>(<span class="params">timerExpired, wait</span>) </span>&#123;</span><br><span class="line">        timeout = setTimeout(timerExpired, wait);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> remainingWait = <span class="function"><span class="keyword">function</span>(<span class="params">now</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> wait - (now - lastCallTime);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> trailingEdge = <span class="function"><span class="keyword">function</span>(<span class="params">time</span>) </span>&#123;</span><br><span class="line">        timeout = <span class="literal">undefined</span>;</span><br><span class="line">        <span class="keyword">if</span> (trailing) &#123;</span><br><span class="line">            invokeFunc(time);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> timerExpired = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> now = <span class="built_in">Date</span>.now(); <span class="comment">// 当前定时器到时间了 看看是否需要执行这个函数</span></span><br><span class="line">        <span class="keyword">if</span> (shouldInvoke(now)) &#123; <span class="comment">// 如果需要调用，那么就触发结束的方法</span></span><br><span class="line">            <span class="keyword">return</span> trailingEdge(now);</span><br><span class="line">        &#125;</span><br><span class="line">        startTimer(timerExpired, remainingWait(now));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> leadingEdge = <span class="function"><span class="keyword">function</span>(<span class="params">time</span>) </span>&#123;</span><br><span class="line">        lastInvokeTime = time;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果需要执行那么就调用函数</span></span><br><span class="line">        <span class="keyword">if</span> (leading) &#123;</span><br><span class="line">            invokeFunc(time)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 开启一个定时器 看下一次定时器到了 是否需要执行func</span></span><br><span class="line">    startTimer(timerExpired, wait);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> debounced = <span class="function"><span class="keyword">function</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">        lastThis = <span class="keyword">this</span>;</span><br><span class="line">        lastArgs = args;</span><br><span class="line">        <span class="keyword">let</span> now = <span class="built_in">Date</span>.now();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 判断当前的debounce时是否需要执行</span></span><br><span class="line">        <span class="keyword">let</span> isInvoking = shouldInvoke(now);</span><br><span class="line">        lastCallTime = now;</span><br><span class="line">        <span class="keyword">if</span> (isInvoking) &#123;</span><br><span class="line">            <span class="keyword">if</span> (timeout === <span class="literal">undefined</span>) &#123;</span><br><span class="line">                leadingEdge(now);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> debounced;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* throttle.js 文件实现 */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">func, wait</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> debounce(func, wait, &#123;</span><br><span class="line">        <span class="comment">// maxWait最大的点击时间</span></span><br><span class="line">        maxWait: wait</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="noopener">花田半亩</a></li><li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="noopener">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li><li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;tip&quot;&gt;本文讨论前端开发中 函数防抖 和 函数节流，它们的应用、区别以及简单实现。&lt;/div&gt;

&lt;p&gt;在前端开发中我们可能经常需要给(页面)标签绑定一些持续触发的事件，如 &lt;code&gt;resize&lt;/code&gt;、&lt;code&gt;scroll&lt;/code&gt;、
      
    
    </summary>
    
    
      <category term="Gossip" scheme="https://weibo.com/u/3800117445/tags/Gossip/"/>
    
  </entry>
  
  <entry>
    <title>Gossip - deepClone</title>
    <link href="https://weibo.com/u/3800117445/2019/05/24/Gossip%20-%20deepClone/"/>
    <id>https://weibo.com/u/3800117445/2019/05/24/Gossip - deepClone/</id>
    <published>2019-05-23T16:00:08.000Z</published>
    <updated>2020-04-26T01:39:21.238Z</updated>
    
    <content type="html"><![CDATA[<div class="tip">本文讨论数据的拷贝，并给出深拷贝的实现代码。</div><p>拷贝即复制<code>( copy | clone )</code>，获取指定数据副本的一种行为，理论上我们可以对任意类型的数据进行拷贝，包括但不限于<code>null、undefined、字符串、数字、布尔值、对象、函数、数组、正则表达式等</code>。</p><p>数据的拷贝，可以具体的分为<a href=""> 浅拷贝 </a>和<a href=""> 深拷贝 </a>。浅拷贝拷贝一层，副本可能存在共享问题，而深拷贝会拷贝多层，拷贝得到的副本无共享问题。</p><p>数据拷贝的方案有很多，譬如可以使用循环遍历和<code>Object.assign()</code>等方法，但这些拷贝方式都是浅拷贝。深拷贝的常见实现方案一种是利用JSON内置对象来进行序列化和反序列化操作，请看下面的代码：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123; <span class="attr">name</span>: <span class="string">"MiTaoEr"</span>, <span class="attr">info</span>: &#123; <span class="attr">address</span>: <span class="string">"天津"</span>, <span class="attr">color</span>: <span class="string">"red"</span> &#125; &#125;;</span><br><span class="line"><span class="keyword">var</span> t = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(o));</span><br><span class="line">o.info.address = <span class="string">"北京"</span>;</span><br><span class="line"><span class="built_in">console</span>.log(t);</span><br><span class="line"><span class="comment">/* &#123; name: 'MiTaoEr', info: &#123; address: '天津', color: 'red' &#125; &#125; */</span></span><br></pre></td></tr></table></figure></p><p>我们先通过<code>JSON.stringify()</code>方法将对象序列化为JSON字符串，然后再进行反序列化的骚操作再转换回来，顺利完成任务。不得不说，这种拷贝对象的方式，手起刀落干净利落，但却有一点点小遗憾，遗憾的是<span style="color:#195">JSON数据中没有函数和 undefined 类型，因此在进行序列化的过程中，对象中的这部分数据会被直接过滤掉，此外正则类型的数据也会被处理为空对象。</span></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123; </span><br><span class="line">  name: <span class="string">"MiTaoEr"</span>, </span><br><span class="line">  ID: <span class="literal">undefined</span>, </span><br><span class="line">  showName: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;, </span><br><span class="line">  reg: <span class="regexp">/wen/</span>, </span><br><span class="line">  info: &#123; <span class="attr">address</span>: <span class="string">"天津"</span>,<span class="attr">color</span>: <span class="string">"red"</span> &#125; &#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(o)));</span><br><span class="line"><span class="comment">/* &#123; name: 'MiTaoEr',reg: &#123;&#125;,info: &#123; address: '天津', color: 'red' &#125; &#125; */</span></span><br></pre></td></tr></table></figure><p>利用JSON来实现深拷贝这种实现方式其实不够完美，下面给出通过递归来实现深拷贝的完美方案。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 深拷贝实现函数 */</span></span><br><span class="line"><span class="keyword">let</span> deepClone = <span class="function">(<span class="params">val, wm = <span class="keyword">new</span> <span class="built_in">WeakMap</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (val == <span class="literal">null</span>) <span class="keyword">return</span> val;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> val !== <span class="string">"object"</span>) <span class="keyword">return</span> val;</span><br><span class="line">    <span class="keyword">if</span> (val <span class="keyword">instanceof</span> <span class="built_in">Date</span>) <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>(val);</span><br><span class="line">    <span class="keyword">if</span> (val <span class="keyword">instanceof</span> <span class="built_in">RegExp</span>) <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">RegExp</span>(val);</span><br><span class="line">    <span class="keyword">if</span> (wm.has(val)) <span class="keyword">return</span> wm.get(val);</span><br><span class="line">    <span class="keyword">let</span> _instance = <span class="keyword">new</span> val.constructor;</span><br><span class="line">    wm.set(val, _instance);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> val) &#123;</span><br><span class="line">        <span class="keyword">if</span> (val.hasOwnProperty(key)) _instance[key] = deepClone(val[key], wm);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _instance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>因为<code>_instance</code>是引用类型的数据，后续for循环的执行会更新_instance的内容,考虑到循环引用的问题，在<code>deepClone</code>方法中用到<a href=""> WeakMap </a>类型，其中<code>wm.set</code>方法执行后<code>wm</code>中保存的数据 <code>key === value</code> ， 该对象用于数据的记忆。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 001-测试代码：正常情况 */</span></span><br><span class="line"><span class="comment">//var target = &#123;name: "wen-ding-ding", car:&#123;id: 666 &#125;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 002-测试代码：循环引用 */</span></span><br><span class="line"><span class="keyword">var</span> target = &#123;<span class="attr">name</span>: <span class="string">"wen-ding-ding"</span>, <span class="attr">car</span>:&#123;<span class="attr">id</span>: <span class="number">666</span> &#125;&#125;</span><br><span class="line">target.ref = target;</span><br><span class="line"><span class="keyword">var</span> result = deepClone(target);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(target, result);</span><br><span class="line"><span class="built_in">console</span>.log(target.ref === result.ref, target.ref === target); <span class="comment">/* false true */</span></span><br><span class="line">target.car.id = <span class="number">888</span>;</span><br><span class="line"><span class="built_in">console</span>.log(result.car.id); <span class="comment">/* 666 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 003-其它数据类型测试 */</span></span><br><span class="line"><span class="comment">/* (1) 数组 */</span></span><br><span class="line"><span class="keyword">var</span> arr1 = [<span class="number">100</span>,<span class="number">200</span>,<span class="number">300</span>];</span><br><span class="line"><span class="keyword">var</span> arr2 = deepClone(arr1);</span><br><span class="line">arr1.push(<span class="number">400</span>);</span><br><span class="line"><span class="built_in">console</span>.log(arr1,arr2);</span><br><span class="line"><span class="comment">/* [ 100, 200, 300, 400 ] [ 100, 200, 300 ] */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* (2) 日期 */</span></span><br><span class="line"><span class="keyword">var</span> date1 = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"><span class="keyword">var</span> date2 = deepClone(date1);</span><br><span class="line"><span class="built_in">console</span>.log(date1,date2,date1 == date2)</span><br><span class="line"><span class="comment">/* 2019-08-24T11:00:21.379Z 2019-08-24T11:00:21.379Z false*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* (3) null 和 undefined */</span></span><br><span class="line"><span class="built_in">console</span>.log(deepClone(<span class="literal">null</span>),deepClone(<span class="literal">undefined</span>))</span><br><span class="line"><span class="comment">/* null undefined */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* (4) 正则 */</span></span><br><span class="line"><span class="keyword">var</span> reg1 = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="regexp">/\&#123;\&#123;(.+?)\&#125;\&#125;/</span>);</span><br><span class="line"><span class="keyword">var</span> reg2 = deepClone(reg1);</span><br><span class="line"><span class="built_in">console</span>.log(reg1,reg2,reg1 == reg2)</span><br><span class="line"><span class="comment">/* /\&#123;\&#123;(.+?)\&#125;\&#125;/ /\&#123;\&#123;(.+?)\&#125;\&#125;/ false */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* (5) 基本值 */</span></span><br><span class="line"><span class="built_in">console</span>.log(deepClone(<span class="string">"wen-ding-ding"</span>),deepClone(<span class="number">2019</span>),deepClone(<span class="literal">true</span>))</span><br><span class="line"><span class="comment">/* wen-ding-ding 2019 true */</span></span><br></pre></td></tr></table></figure><ul><li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="noopener">花田半亩</a></li><li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="noopener">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li><li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;tip&quot;&gt;本文讨论数据的拷贝，并给出深拷贝的实现代码。&lt;/div&gt;

&lt;p&gt;拷贝即复制&lt;code&gt;( copy | clone )&lt;/code&gt;，获取指定数据副本的一种行为，理论上我们可以对任意类型的数据进行拷贝，包括但不限于&lt;code&gt;null、unde
      
    
    </summary>
    
    
      <category term="Gossip" scheme="https://weibo.com/u/3800117445/tags/Gossip/"/>
    
  </entry>
  
  <entry>
    <title>前端框架系列-动态响应</title>
    <link href="https://weibo.com/u/3800117445/2019/05/23/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97%20%E5%8A%A8%E6%80%81%E5%93%8D%E5%BA%94%E5%92%8C%E7%BB%91%E5%AE%9A/"/>
    <id>https://weibo.com/u/3800117445/2019/05/23/前端框架系列 动态响应和绑定/</id>
    <published>2019-05-22T16:00:00.000Z</published>
    <updated>2020-04-26T01:39:52.150Z</updated>
    
    <content type="html"><![CDATA[<div class="tip">本文将继续讨论 <code>前端框架\模板中</code> 文本插值的实现方案，主要关注当数据变化后页面标签也实时更新功能，需要指出的是本文面向的是初学者的入门级文章仅仅从<a href=""> ( 结果 )…( 实现<br>) </a>的角度来讨论解决问题的过程，侧重点并不在于技术的深度也不探讨框架的内部架构和实现原理。</div><p class="titleX"><strong>数据和标签的动态响应</strong></p><p>在<a href=""> 上文中..文本插值 </a>我们已经讨论过如何把数据映射到页面标签的问题，并且给出了简陋的Class结构，对于前端框架来说标签中插值部分能够跟随数据实时动态更新是标配的功能，现在我们来考虑下这个功能要如何来实现。下面是<a href=""> Vue官网 </a>对<strong>响应式</strong>渲染的说明。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">我们已经成功创建了第一个 Vue 应用！</span><br><span class="line">看起来这跟渲染一个字符串模板非常类似，但是 Vue 在背后做了大量工作。</span><br><span class="line">现在数据和 DOM 已经被建立了关联，所有东西都是响应式的。我们要怎么确认呢？</span><br><span class="line">打开你的浏览器的 JavaScript 控制台 (就在这个页面打开)，并修改app.message的值，你将看到上例相应地更新。</span><br></pre></td></tr></table></figure><p>简单点说，我们现在要考虑的是当数据(<code>data的成员</code>)发生变化的时候，页面挂载标签中对应的部分也要能够实时更新。如何实现呢？<span style="color:red">自然而然的我们能够想到 —— 监听数据的变化，当数据变化的时候通知更新UI ( 重新计算和渲染 ) 即可。</span> </p><p class="titleX"><strong>监听对象成员的读写操作</strong></p><p>如何监听数据的变化呢？要知道数据都作为实例对象的成员(属性)而存在的。监听对象(对象属性)的读写操作以利用Object的静态方法<code>Object.defineProperty</code>来实现，下面简单介绍其基本使用。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123;<span class="attr">name</span>: <span class="string">"wendingding"</span> &#125;;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(o, <span class="string">"name"</span>, &#123;</span><br><span class="line">    value: <span class="string">"文顶顶"</span>,</span><br><span class="line">    configurable: <span class="literal">true</span>,</span><br><span class="line">    enumerable: <span class="literal">true</span>,</span><br><span class="line">    writable: <span class="literal">true</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(o.name); <span class="comment">//"文顶顶"</span></span><br></pre></td></tr></table></figure><p><strong>❏</strong> <code>语法</code>：<code>Object.defineProperty(target,key,options)</code><br><strong>❏</strong> <code>参数</code>：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* target   目标对象</span><br><span class="line">* key      对象(成员)属性名称</span><br><span class="line">* options  对象属性描述对象</span><br></pre></td></tr></table></figure></p><p><strong>❏</strong> <code>用途</code>：更细粒度的定义对象以控制指定属性的值、是否可配置(删除)、是否可枚举以及是否可写。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.defineProperty(o, <span class="string">"name"</span>, &#123;</span><br><span class="line">    configurable: <span class="literal">true</span>,</span><br><span class="line">    enumerable: <span class="literal">true</span>,</span><br><span class="line">    get() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"监听到-执行读取操作"</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    set(newValue) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"监听到-执行写入操作"</span>, newValue);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(o.name); <span class="comment">//监听到-执行读取操作</span></span><br><span class="line">o.name = <span class="string">"夏"</span>; <span class="comment">//监听到-执行写入操作 夏</span></span><br></pre></td></tr></table></figure></p><p>当我们试图访问对象属性的时候可以在<code>get</code>方法中拦截，当尝试设置对象属性的时候能够在<code>set</code>方法中拦截，到这里我们已经掌握了一种可以监听对象中属性读写操作的方式。<code>Object.defineProperty</code>方法只能够对对象中的单个标签进行监听，而我们框架的响应模型中需要对对象中的多个数据(<code>构造函数参数对象中data的所有成员</code>)的写操作进行监听，怎么处理呢？且看下面的实现代码。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> o = &#123;<span class="attr">name</span>: <span class="string">"xx"</span>,<span class="attr">age</span>: <span class="number">18</span>, <span class="attr">sex</span>: <span class="string">"女"</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">definePropertyReact</span>(<span class="params">o, key, val</span>) </span>&#123;</span><br><span class="line">    <span class="comment">/* 定义目标对象的单个属性：(读 | 写) 监听 */</span></span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(o, key, &#123;</span><br><span class="line">        configurable: <span class="literal">true</span>,</span><br><span class="line">        enumerable: <span class="literal">true</span>,</span><br><span class="line">        get() &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"监听到读取操作"</span>, key);</span><br><span class="line">            <span class="keyword">return</span> val;</span><br><span class="line">        &#125;,</span><br><span class="line">        set(newVal) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"监听到设置操作"</span>, key, newVal);</span><br><span class="line">            val = newVal;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 迭代对象的成员，为每个数据属性都监听监听 */</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> o) &#123; definePropertyReact(o, key, o[key]) &#125;</span><br></pre></td></tr></table></figure></p><p>当程序运行后，我们可以在控制台通过o.name的方式访问和修改属性的值，下面是执行的结果。<br><img src="https://github.com/flowerField/Source/blob/master/Blog/vue003.png?raw=true" height="200px"></p><p class="titleX"><strong>动态响应的代码实现</strong></p><p>现在我们已经解决了对象属性<strong><code>写操作</code></strong>监听的问题，剩下的就是当对象中指定属性的<code>写操作</code>被触发时通知让UI更新即可，下面给出完整的Manager实现和演示代码。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h4</span>&gt;</span>&#123;&#123;title&#125;&#125;<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"font-size: 12px;color:#195;margin:10px 30px"</span>&gt;</span> &#123;&#123;author&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span> &#123;&#123;textA&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span> &#123;&#123;textB&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- JS代码部分 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">/* Class的写法 */</span></span></span><br><span class="line"><span class="javascript">    <span class="class"><span class="keyword">class</span> <span class="title">Manager</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">constructor</span>(o) &#123;</span></span><br><span class="line"><span class="javascript">            <span class="comment">/*  根据传入的el来获取页面中挂载的标签 */</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">this</span>.el = <span class="built_in">document</span>.querySelector(o.el);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">this</span>.rootInnerHTMLCopy = <span class="keyword">this</span>.el.innerHTML;</span></span><br><span class="line"><span class="undefined">            </span></span><br><span class="line"><span class="javascript">            <span class="comment">/* 存data属性中所有的属性名 */</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">/* 给data属性中所有数据添加读写操作监听 */</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">this</span>.keys = [];</span></span><br><span class="line"><span class="javascript">            <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> o.data) &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">this</span>.keys.push(key);</span></span><br><span class="line"><span class="javascript">                <span class="keyword">this</span>.definePropertyReact(<span class="keyword">this</span>, key, o.data[key])</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="javascript">            <span class="comment">/* 第一次渲染 */</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">this</span>.ObserverPropertyChange();</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">        definePropertyReact(o, key, val) &#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">let</span> self = <span class="keyword">this</span>;</span></span><br><span class="line"><span class="undefined">            </span></span><br><span class="line"><span class="javascript">            <span class="comment">/* 定义目标对象的单个属性：(读 | 写) 监听 */</span></span></span><br><span class="line"><span class="javascript">            <span class="built_in">Object</span>.defineProperty(o, key, &#123;</span></span><br><span class="line"><span class="javascript">                configurable: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">                enumerable: <span class="literal">true</span>,</span></span><br><span class="line"><span class="undefined">                get() &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">return</span> val;</span></span><br><span class="line"><span class="undefined">                &#125;,</span></span><br><span class="line"><span class="undefined">                set(newVal) &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="built_in">console</span>.log(<span class="string">"监听到设置操作"</span>, key, newVal);</span></span><br><span class="line"><span class="undefined">                    val = newVal;</span></span><br><span class="line"><span class="javascript">                    <span class="comment">/* 当修改数据的时候通知UI重新渲染 */</span></span></span><br><span class="line"><span class="undefined">                    self.ObserverPropertyChange();</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">            &#125;)</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">        ObserverPropertyChange() &#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">this</span>.el.innerHTML = <span class="keyword">this</span>.rootInnerHTMLCopy;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">this</span>.keys.forEach(<span class="function"><span class="params">ele</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">let</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">`&#123;&#123;2&#125;\\s*<span class="subst">$&#123;ele&#125;</span>\\s*&#125;&#123;2&#125;`</span>, <span class="string">"g"</span>);</span></span><br><span class="line"><span class="javascript">                <span class="keyword">this</span>.el.innerHTML = <span class="keyword">this</span>.el.innerHTML.replace(reg, <span class="keyword">this</span>[ele]);</span></span><br><span class="line"><span class="undefined">            &#125;);</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">/* 初始化：传入配置对象创建实例对象 */</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> app = <span class="keyword">new</span> Manager(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">"#app"</span>,</span></span><br><span class="line"><span class="undefined">        data: &#123;</span></span><br><span class="line"><span class="javascript">            title: <span class="string">"沐春风"</span>,</span></span><br><span class="line"><span class="javascript">            textA: <span class="string">"白马秋风塞上"</span>,</span></span><br><span class="line"><span class="javascript">            textB: <span class="string">"杏花烟雨江南"</span>,</span></span><br><span class="line"><span class="javascript">            author: <span class="string">"文顶顶"</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/xxxxx.gif?raw=true"></p><hr><ul><li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="noopener">花田半亩</a></li><li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="noopener">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li><li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;tip&quot;&gt;本文将继续讨论 &lt;code&gt;前端框架\模板中&lt;/code&gt; 文本插值的实现方案，主要关注当数据变化后页面标签也实时更新功能，需要指出的是本文面向的是初学者的入门级文章仅仅从&lt;a href=&quot;&quot;&gt; ( 结果 )…( 实现&lt;br&gt;) &lt;/a&gt;的角度来
      
    
    </summary>
    
    
      <category term="前端框架系列" scheme="https://weibo.com/u/3800117445/tags/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/"/>
    
  </entry>
  
  <entry>
    <title>前端框架系列-文本插值</title>
    <link href="https://weibo.com/u/3800117445/2019/05/22/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97%20%E6%96%87%E6%9C%AC%E6%8F%92%E5%80%BC/"/>
    <id>https://weibo.com/u/3800117445/2019/05/22/前端框架系列 文本插值/</id>
    <published>2019-05-21T16:00:00.000Z</published>
    <updated>2020-04-26T01:39:51.234Z</updated>
    
    <content type="html"><![CDATA[<div class="tip">本文讨论 <code>前端框架\模板中</code> 文本插值的实现方案，本文将会主要以<a href="">Vue</a>框架作为参考讨论文本插值语法的具体实现和推导方案，并补充相关的技术细节。</div><p class="titleX"><strong>文本插值</strong></p><p>在Vue官网文档的第一部分( <a href="https://cn.vuejs.org/v2/guide/index.html" target="_blank" rel="noopener">声明式渲染</a> )我们可以看到下面一段描述。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Vue.js 的核心是一个允许采用简洁的模板语法来声明式地将数据渲染进 DOM 的系统：</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">  &#123;&#123; message &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">var app = new Vue(&#123;</span><br><span class="line">  el: '#app',</span><br><span class="line">  data: &#123;</span><br><span class="line">    message: 'Hello Vue!'</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">我们已经成功创建了第一个 Vue 应用！</span><br><span class="line">看起来这跟渲染一个字符串模板非常类似，但是 Vue 在背后做了大量工作。</span><br><span class="line">现在数据和 DOM 已经被建立了关联，所有东西都是响应式的。我们要怎么确认呢？</span><br><span class="line">打开你的浏览器的JavaScript控制台，并修改 app.message 的值，你将看到上例相应地更新。</span><br></pre></td></tr></table></figure></p><p>在Vue官网的另一部分(<a href="https://cn.vuejs.org/v2/guide/syntax.html" target="_blank" rel="noopener">模板语法-插值</a>)说明了<span style="color:red">“ Vue.js 使用了基于 HTML 的模板语法，允许开发者声明式地将 DOM 绑定至底层 Vue 实例的数据。所有 Vue.js 的模板都是合法的 HTML ，所以能被遵循规范的浏览器和 HTML 解析器解析 ”。</span></p><p>我们知道，在Vue框架中数据绑定的插值语法使用的是<code>Mustache语法 (双大括号)</code> ，而这篇短小的文章将简单讨论其内部的实现机制。</p><p class="titleX"><strong>Class-实例的构建初步</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 标签部分</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">  &#123;&#123; message &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"># 引入框架文件</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/npm/vue/dist/vue.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"># 创建Vue实例</span><br><span class="line">var app = new Vue(&#123;</span><br><span class="line">  el: '#app',</span><br><span class="line">  data: &#123;</span><br><span class="line">    message: 'Hello Vue!'</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>在Vue框架中我们总是会通过上面的方式来创建并得到一个实例对象，在调用的时候我们传递了一个对象作为构造函数(class)的参数，在该对象中我们设置了<code>挂载的标签(el属性)</code>、<code>实例数据(data属性)</code>等信息。这里，我们先提供一个<a href=""> 构造函数 或者是 Class </a>来模拟这个整体的结构。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Class的写法 */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Manager</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(o) &#123;</span><br><span class="line">        <span class="comment">/*  根据传入的el来获取页面中挂载的标签 */</span></span><br><span class="line">        <span class="keyword">this</span>.el = <span class="built_in">document</span>.querySelector(o.el);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 把对象参数中的data成员(数据)添加到实例对象 */</span></span><br><span class="line">        <span class="comment">/* 在访问的时候可以直接通过(new Manager()).xx访问 */</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> o.data) &#123;</span><br><span class="line">            <span class="keyword">this</span>[key] = o.data[key];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 初始化：传入配置对象创建实例对象 */</span></span><br><span class="line"><span class="keyword">let</span> app = <span class="keyword">new</span> Manager(&#123;</span><br><span class="line">    el: <span class="string">"#app"</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        message: <span class="string">"Hello 文顶顶!"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p><p><img src="https://raw.githubusercontent.com/flowerField/Source/master/Blog/vue001.png" height="150px"></p><p>在开始的时候，[ 构造函数 \ Class ]的样子可能可能是像上面这样的，先尝试获取参数对象中<code>el</code>的值以获取实例在页面中挂载的标签，然后通过一个循环结构来把<code>data</code>中的数据都直接添加到实例对象，这种处理将允许我们直接以<code>app.message</code>的方式来操作数据。</p><p class="titleX"><strong>数据和标签的渲染关系</strong></p><p>设计出基本结构后，现在我们可以开始考虑如果需要把<code>data</code>中的数据渲染(绑定)到页面的标签，那该如何实现？ 简单思考一秒钟后，我们似乎可以尝试以下的实践策略：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(1) 在初始化的操作中先获取挂载标签的属性节点(这很容易办到，使用innerHTML就可以)。</span><br><span class="line">(2) 在innerHTML中寻找类类似于&#123;&#123;message&#125;&#125;的结构，如果找到那么抠出双括号中的字段-message</span><br><span class="line">(3) 在实例对象中获取-message字段对应的value值，使用该值来替换&#123;&#123;message&#125;&#125;部分。</span><br><span class="line">(!) 因为标签中可能存在多个插值代码，因此可能需要循环处理，在寻找插值代码的时候使用正则匹配或许会比较合适。</span><br></pre></td></tr></table></figure></p><p>下面试着给出用正则来匹配标签内容并进行替换的核心代码，正则表达式的结果可以参考下面的注释，用于匹配<a href="">  </a>的特定结构，<code>\s*</code>表示可以允许存在空格，<code>\\s</code>表示对<code>\</code>进行转义处理，参数<code>g</code>用以表示应用全局匹配。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">`&#123;&#123;2&#125;\\s*msg\\s*&#125;&#123;2&#125;`</span>, <span class="string">"g"</span>);</span><br><span class="line"><span class="comment">/* /&#123;&#123;2&#125;\s*msg\s*&#125;&#123;2&#125;/g  */</span></span><br><span class="line"><span class="keyword">this</span>.el.innerHTML = <span class="keyword">this</span>.el.innerHTML.replace(reg, <span class="string">"文顶顶"</span>);</span><br></pre></td></tr></table></figure><p>考虑到在参数对象的<code>data</code>中可能会有多个数据(<code>键值对</code>)，且执行文本插值的时候某个数据可能会出现在标签的多个位置，因此需要通过循环的方式来检查 <a href="">innerTTML</a> 字段中每个数据的情况。我们可以通过 <code>Object.keys()</code>方法来获取所有的属性名(<code>key的集合</code>)，然后遍历该数组并执行正则替换操作。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 标签部分 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span>&#123;&#123; message &#125;&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123;msg&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- JS代码部分 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="comment">/* Class的写法 */</span></span></span><br><span class="line"><span class="javascript">        <span class="class"><span class="keyword">class</span> <span class="title">Manager</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">constructor</span>(o) &#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">/*  根据传入的el来获取页面中挂载的标签 */</span></span></span><br><span class="line"><span class="javascript">                <span class="keyword">this</span>.el = <span class="built_in">document</span>.querySelector(o.el);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">                <span class="comment">/* 把对象参数中的data成员(数据)添加到实例对象 */</span></span></span><br><span class="line"><span class="javascript">                <span class="comment">/* 在访问的时候可以直接通过(new Manager()).xx访问 */</span></span></span><br><span class="line"><span class="javascript">                <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> o.data) &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">this</span>[key] = o.data[key];</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="javascript">                <span class="comment">/* 获取data数据中所有的key */</span></span></span><br><span class="line"><span class="javascript">                <span class="comment">/* 根据data中的属性集合来遍历渲染页面中指定的内容 */</span></span></span><br><span class="line"><span class="javascript">                <span class="built_in">Object</span>.keys(o.data).forEach(<span class="function"><span class="params">ele</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">let</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">`&#123;&#123;2&#125;\\s*<span class="subst">$&#123;ele&#125;</span>\\s*&#125;&#123;2&#125;`</span>, <span class="string">"g"</span>);</span></span><br><span class="line"><span class="javascript">                     <span class="comment">/*  /&#123;&#123;2&#125;\s*message\s*&#125;&#123;2&#125;/g */</span></span></span><br><span class="line"><span class="javascript">                     <span class="comment">/*  /&#123;&#123;2&#125;\s*msg\s*&#125;&#123;2&#125;/g     */</span></span></span><br><span class="line"><span class="javascript">                    <span class="built_in">console</span>.log(<span class="keyword">this</span>.el.innerHTML, reg);</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">this</span>.el.innerHTML = <span class="keyword">this</span>.el.innerHTML.replace(reg, <span class="keyword">this</span>[ele]);</span></span><br><span class="line"><span class="undefined">                &#125;)</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="comment">/* 初始化：传入配置对象创建实例对象 */</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> app = <span class="keyword">new</span> Manager(&#123;</span></span><br><span class="line"><span class="javascript">            el: <span class="string">"#app"</span>,</span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="javascript">                message: <span class="string">"文顶顶"</span>,</span></span><br><span class="line"><span class="javascript">                msg: <span class="string">"米桃儿"</span></span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>当代码执行的时候，可以看到下面的效果。</p><p><img src="https://raw.githubusercontent.com/flowerField/Source/master/Blog/vue002.png" height="300px"></p><p>至此，便简单了实现了数据-标签渲染的功能。如果数据发生变化后标签中对应的内容也要随之变化，这种数据驱动UI的结构最核心之处在于<code>监听数据的变化并通知给UI视图</code>，具体实现可以参考下一篇文章。</p><hr><ul><li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="noopener">花田半亩</a></li><li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="noopener">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li><li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;tip&quot;&gt;本文讨论 &lt;code&gt;前端框架\模板中&lt;/code&gt; 文本插值的实现方案，本文将会主要以&lt;a href=&quot;&quot;&gt;Vue&lt;/a&gt;框架作为参考讨论文本插值语法的具体实现和推导方案，并补充相关的技术细节。&lt;/div&gt;

&lt;p class=&quot;titleX&quot;
      
    
    </summary>
    
    
      <category term="前端框架系列" scheme="https://weibo.com/u/3800117445/tags/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97/"/>
    
  </entry>
  
  <entry>
    <title>javaScript系列 [29]-RegExp</title>
    <link href="https://weibo.com/u/3800117445/2019/05/11/javaScript%E7%B3%BB%E5%88%97%20%5B29%5D-RegExp/"/>
    <id>https://weibo.com/u/3800117445/2019/05/11/javaScript系列 [29]-RegExp/</id>
    <published>2019-05-10T16:23:18.000Z</published>
    <updated>2019-06-11T01:32:06.867Z</updated>
    
    <content type="html"><![CDATA[<div class="tip">本文介绍RegExp相关的知识点，包括正则表达式的创建、匹配规则等内容。</div><br><div class="titleX"><strong>RegExp简单介绍</strong></div><br><strong>正则表达式</strong><a href=""> Regular Expression </a>是描述字符模式的对象，在JavaScript语言中提供了内置的 RegExp 来处理正则。正则表达式能够进行强大的<code>模式匹配</code>和<code>文本检索与替换</code>功能，在前端开发中往往有大量的表单数据校验的工作，使用正则表达式可以减少数据校验的工作量。<br><br>在JavaScript语言中，除 RegExp 内置构造函数外，字符串操作中也有很多操作涉及到正则，包括字符串的<code>macth()</code>、<code>search()</code>、<code>split()</code>以及<code>replace()</code>等方法都接受正则表达式作为参数，而这也为我们操作字符串提供了更强大的功能。<br><br><div class="titleX"><strong>正则表达式的创建</strong></div><p>正则表达式的创建支持两种形式，一种是直接字面量方式创建，一种是使用 RegExp 构造函数方式创建，两种创建方式得到的正则实例是等价的。</p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#666">① 字面量</span></p><p>字面量创建正则的语法 <span style="color:#195;font-family:Georgia">var reg = / pattern / flags;</span> 其中 pattern(模式) 部分可以是任何简单或复杂的正则表达式，而 flags(参数) 部分支持三种匹配模式。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">g: global              表示全局匹配</span><br><span class="line">i: case-insensitive    表示忽略大小写</span><br><span class="line">m: multiline           表示多行匹配,影响^，$的匹配结果</span><br></pre></td></tr></table></figure></p><p>JavaScript语言在字面量创建正则的语法中，模式部分可以直接写特定的字符串文本，也可以使用正则元字符，需要注意的是因为这些元字符在正则表达式中都有一种或者多种特殊的用途，因此如果想要匹配字符串中包含的这些字符，那么就必须对它们进行转义操作。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*01-字面量的方式创建*/</span></span><br><span class="line"><span class="keyword">var</span> reg1 = <span class="regexp">/文顶顶/g</span>;                  <span class="comment">/*匹配文顶顶文本，全局匹配*/</span></span><br><span class="line"><span class="keyword">var</span> reg2 = <span class="regexp">/[a-zA-Z0-9]\d&#123;3&#125;/g</span>;       <span class="comment">/*匹配以字母和数字开头后面跟3个数字的文本，全局匹配*/</span></span><br><span class="line"><span class="keyword">var</span> reg3 = <span class="regexp">/^javaScript/g</span>;            <span class="comment">/*匹配以JavaScript开头的文本，全局匹配*/</span></span><br><span class="line"><span class="keyword">var</span> reg4 = <span class="regexp">/^javaScript/gm</span>;           <span class="comment">/*匹配以JavaScript开头或作为行首的文本，全局多行匹配*/</span></span><br><span class="line"><span class="keyword">var</span> reg5 = <span class="regexp">/[xm]xia/i</span>;                <span class="comment">/*匹配xxia或者mxia文本，不区分大小写*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*.是正则中的元字符,代表除了换行外的所有字符*/</span></span><br><span class="line"><span class="keyword">var</span> reg6 = <span class="regexp">/.com/gi</span>;                  <span class="comment">/*匹配所有以com结尾的4个字符，不区分大小写*/</span></span><br><span class="line"><span class="keyword">var</span> reg7 = <span class="regexp">/\.com/gi</span>;                 <span class="comment">/*匹配所有.com文本，不区分大小写*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*02-正则测试*/</span></span><br><span class="line"><span class="built_in">console</span>.log(reg1.test(<span class="string">"你好，文顶顶！"</span>));    <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(reg2.test(<span class="string">"a123"</span>));           <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(reg2.test(<span class="string">"5123"</span>));           <span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.log(reg2.test(<span class="string">"-123"</span>));           <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">"java\njavaScript"</span>;</span><br><span class="line"><span class="built_in">console</span>.log(reg3.test(str));              <span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.log(str.match(reg3));             <span class="comment">//null</span></span><br><span class="line"><span class="built_in">console</span>.log(str.match(reg4));             <span class="comment">//["javaScript"]</span></span><br><span class="line"><span class="built_in">console</span>.log(reg5.test(<span class="string">"xxiao"</span>));          <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(reg5.test(<span class="string">"MxiAo"</span>));          <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(reg5.test(<span class="string">"xiongXxiao"</span>));     <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(reg5.test(<span class="string">"xiaoxiao"</span>));       <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(reg6.test(<span class="string">"baiducom"</span>));       <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(reg7.test(<span class="string">"baiducom"</span>));       <span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.log(reg7.test(<span class="string">"wendingding.com"</span>));<span class="comment">//true</span></span><br></pre></td></tr></table></figure><p><span style="border:1px solid #ccc;padding:2px 10px;color:#666">② 构造函数</span></p><p>RegExp 构造函数创建正则实例的语法  <span style="color:#195;font-family:Georgia">var reg = new RegExp( pattern , flags ) ;</span>其中 pattern(模式) 部分可以是任何简单或复杂的正则表达式(直接写字符串规则即可)，而 flags(参数) 部分和字面量方式一样也支持三种匹配模式。</p> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*01-构造函数创建正则表达式*/</span></span><br><span class="line"><span class="keyword">var</span> reg1 = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"文顶顶"</span>,<span class="string">"g"</span>);            <span class="comment">/*匹配文顶顶文本，全局匹配*/</span></span><br><span class="line"><span class="keyword">var</span> reg2 = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"[a-zA-Z0-9]\\d&#123;3&#125;"</span>,<span class="string">"g"</span>) <span class="comment">/*匹配字母和数字开头后跟3个数字的文本全局匹配*/</span></span><br><span class="line"><span class="keyword">var</span> reg3 = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"^javaScript"</span>,<span class="string">"g"</span>);  <span class="comment">/*匹配以JavaScript开头的文本，全局匹配*/</span></span><br><span class="line"><span class="keyword">var</span> reg4 = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"^javaScript"</span>,<span class="string">"gm"</span>); <span class="comment">/*匹配以JavaScript开头或作为行首的文本全局多行匹配*/</span></span><br><span class="line"><span class="keyword">var</span> reg5 = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"[xm]xia"</span>,<span class="string">"i"</span>);      <span class="comment">/*匹配xxia或者mxia文本，不区分大小写*/</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/*.是正则中的元字符,代表除了换行外的所有字符*/</span></span><br><span class="line"><span class="keyword">var</span> reg6 = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">".com"</span>,<span class="string">"gi"</span>);        <span class="comment">/*匹配所有以com结尾的4个字符，不区分大小写*/</span></span><br><span class="line"><span class="keyword">var</span> reg7 = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"\\.com"</span>,<span class="string">"gi"</span>);      <span class="comment">/*匹配所有.com文本，不区分大小写*/</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">/*02-正则测试*/</span></span><br><span class="line"><span class="built_in">console</span>.log(reg1.test(<span class="string">"hello，文顶顶！"</span>));  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(reg2.test(<span class="string">"a123"</span>));           <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(reg2.test(<span class="string">"5123"</span>));           <span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.log(reg2.test(<span class="string">"-123"</span>));           <span class="comment">//false</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> str = <span class="string">"java\njavaScript"</span>;</span><br><span class="line"><span class="built_in">console</span>.log(reg3.test(str));              <span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.log(str.match(reg3));             <span class="comment">//null</span></span><br><span class="line"><span class="built_in">console</span>.log(str.match(reg4));             <span class="comment">//["javaScript"]</span></span><br><span class="line"><span class="built_in">console</span>.log(reg5.test(<span class="string">"xxiao"</span>));          <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(reg5.test(<span class="string">"MxiAo"</span>));          <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(reg5.test(<span class="string">"xiongXxiao"</span>));     <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(reg5.test(<span class="string">"xiaoxiao"</span>));       <span class="comment">//false</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">console</span>.log(reg6.test(<span class="string">"baiducom"</span>));       <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(reg7.test(<span class="string">"baiducom"</span>));       <span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.log(reg7.test(<span class="string">"wendingding.com"</span>));<span class="comment">//true</span></span><br></pre></td></tr></table></figure><div class="titleX"><strong>RegExp基本使用</strong></div><p><strong>字符串方法</strong><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">str.search()</span><br><span class="line">    返回第一次匹配时所在的索引值,如果匹配不到则返回-1</span><br><span class="line">str.match()</span><br><span class="line">    - 默认匹配字符串，返回一个数组</span><br><span class="line">        + 0:所匹配的字符</span><br><span class="line">        + index:匹配第一个字符所在的索引</span><br><span class="line">        + input:对字符串的引用</span><br><span class="line">    - 全局匹配(g)，返回一个匹配所有字符串数组</span><br><span class="line">    - 如果匹配不到则返回null</span><br><span class="line">str.replace()  利用正则匹配来替换字符串</span><br><span class="line">str.split()    利用正则匹配来切割字符串</span><br></pre></td></tr></table></figure></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*01-replace方法的基本使用*/</span></span><br><span class="line"><span class="comment">/*01-1 清空字符串前面和后面的N个空格(实现字符串trim方法功能)*/</span></span><br><span class="line"><span class="comment">//var reg1   = /^\s+|\s+$/g;</span></span><br><span class="line"><span class="keyword">var</span> reg1     = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"^\\s+|\\s+$"</span>,<span class="string">"g"</span>)</span><br><span class="line"><span class="keyword">var</span> result   = <span class="string">" trim test   "</span>.replace(reg1,<span class="string">""</span>);</span><br><span class="line"><span class="built_in">console</span>.log(result);                            <span class="comment">//trim test</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*01-2 处理字符串中的敏感词*/</span></span><br><span class="line"><span class="keyword">var</span>  world = <span class="string">"华为荣耀"</span>;</span><br><span class="line"><span class="keyword">var</span>  reg2  = <span class="keyword">new</span> <span class="built_in">RegExp</span>(world,<span class="string">"g"</span>);</span><br><span class="line"><span class="keyword">var</span>  str   = <span class="string">"华为公司今天宣布旗下手机华为荣耀正式上市，华为荣耀价格感人只卖998"</span>;</span><br><span class="line"><span class="built_in">console</span>.log(str.replace(reg2, <span class="string">"****"</span>));</span><br><span class="line"><span class="comment">/*华为公司今天宣布旗下手机****正式上市，****价格感人只卖998*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*02-match方法的基本使用*/</span></span><br><span class="line"><span class="comment">/*02-1 默认匹配*/</span></span><br><span class="line"><span class="built_in">console</span>.log(str.match(<span class="regexp">/华为荣耀/</span>));</span><br><span class="line"><span class="comment">//["华为荣耀", index: 13, input: "华为公司今天宣布旗下手机华为荣耀正式上市，华为荣耀价格感人只卖998"</span></span><br><span class="line"><span class="comment">//groups: undefined]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*02-2 全局匹配*/</span></span><br><span class="line"><span class="built_in">console</span>.log(str.match(<span class="regexp">/华为荣耀/g</span>));  <span class="comment">/*["华为荣耀", "华为荣耀"]*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*02-3 匹配失败*/</span></span><br><span class="line"><span class="built_in">console</span>.log(str.match(<span class="regexp">/苹果/</span>));      <span class="comment">/*null*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*03-search方法的基本使用*/</span></span><br><span class="line"><span class="built_in">console</span>.log(str.search(<span class="regexp">/华为荣耀/</span>));  <span class="comment">/*13*/</span></span><br><span class="line"><span class="built_in">console</span>.log(str.search(<span class="regexp">/苹果/</span>));     <span class="comment">/*-1*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*04-split方法的基本使用*/</span></span><br><span class="line"><span class="keyword">var</span> str1 = <span class="string">"2019-05-20"</span>;</span><br><span class="line"><span class="keyword">var</span> str2 = <span class="string">"熊大  ,熊二 ，光头强，  毛毛， 吉吉&gt;凯特"</span>;</span><br><span class="line"><span class="built_in">console</span>.log(str1.split(<span class="string">"-"</span>));        <span class="comment">//["2019", "05", "20"]</span></span><br><span class="line"><span class="built_in">console</span>.log(str2.split(<span class="string">","</span>));        <span class="comment">//["熊大", "熊二，光头强，  毛毛， 吉吉&gt;凯特"]</span></span><br><span class="line"><span class="built_in">console</span>.log(str2.split(<span class="regexp">/\s*[,，&gt;]\s*/g</span>));<span class="comment">//["熊大", "熊二", "光头强", "毛毛", "吉吉", "凯特"]</span></span><br></pre></td></tr></table></figure><p><strong>RegExp的核心成员</strong><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">regExp.test() 测试正则表达式用test方法,返回布尔值</span><br><span class="line">    - 格式：正则表达式.test(字符串)</span><br><span class="line">    - 用<span class="tag">&lt;<span class="name">正则表达式</span>&gt;</span>测试<span class="tag">&lt;<span class="name">字符串</span>&gt;</span>是否匹配,返回true/false</span><br><span class="line">regExp.exec() 测试正则表达式exec方法</span><br><span class="line">    - 格式：/xx/.exec(字符串)</span><br><span class="line">global        是否应用g</span><br><span class="line">ignoreCase    是否忽略大小写模式</span><br><span class="line">multiline     是否应用多行匹配模式</span><br><span class="line">source        包含正则表达式文本的字符串</span><br><span class="line">lastIndex     整数，如果正则中应用了g全局匹配，则保存下一次开始检索的位置，在exec和test方法中会被用到</span><br></pre></td></tr></table></figure></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/小青蛙/gi</span>;</span><br><span class="line"><span class="built_in">console</span>.log(reg.global);      <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(reg.ignoreCase);  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(reg.lastIndex);   <span class="comment">//0</span></span><br><span class="line"><span class="built_in">console</span>.log(reg.multiline);   <span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.log(reg.source);      <span class="comment">//小青蛙</span></span><br></pre></td></tr></table></figure><p><div class="titleX"><strong>RegExp匹配规则</strong></div><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">001 所有字母和数字都是按照字面量进行匹配,和字符串匹配等效 如/good/gi</span><br><span class="line">002 字符类（只记小写字母即可）</span><br><span class="line">    - `. ` : 除换行以外的字符</span><br><span class="line">    - \w : 代表数字或字母或下划线</span><br><span class="line">    - \W : 非数字字母和下划线字符</span><br><span class="line">    - \d : 数字</span><br><span class="line">    - \D : 非数字</span><br><span class="line">    - \s : 代表一个空格</span><br><span class="line">    - \S : 空格以外的字符</span><br><span class="line">    注意：以上所有字符类都只是匹配“一个”字符</span><br><span class="line">    </span><br><span class="line">003 边界处理</span><br><span class="line">    - \b : 匹配一个单词边界，也就是指单词和空格间的位置</span><br><span class="line">    - \B : 匹配非单词边界。</span><br><span class="line"></span><br><span class="line">004 特殊符号</span><br><span class="line">    &gt;^  $  .  *  +  ?  =  !  :  |  \  /  ()  []  &#123;&#125;</span><br><span class="line">    - []: 代表任意“单个字符” ,里面的内容表示“或”的关系</span><br><span class="line">        + -: 代表范围</span><br><span class="line">        + ^: 代表非</span><br><span class="line"></span><br><span class="line">    - (): 表示分组（n是以最左边括号出现的顺序排列）</span><br><span class="line">        + $1: 表示第一个分组</span><br><span class="line">        + $n: 表示第n个分组（不能写在正则表达式里）</span><br><span class="line">        + \n: 在正则分组后面使用，表示对第n个分组的引用(一定要写在正则表达式里)</span><br><span class="line">        建议：编写的正则分组数量越少越好</span><br><span class="line"></span><br><span class="line">    - |:  表示或者</span><br><span class="line"></span><br><span class="line">    - 锚点定位</span><br><span class="line">        + ^: 表示以什么开头</span><br><span class="line">        + $: 表示以什么结尾</span><br><span class="line"></span><br><span class="line">    - 表示数量，对前一个字符计数，</span><br><span class="line">        + *: 代表0个或0个以上  &#123;0,&#125;</span><br><span class="line">        + +: 代表1个或1个以上  &#123;1,&#125;</span><br><span class="line">        + ?: 代表0个或1个     &#123;0,1&#125;</span><br><span class="line">        + &#123;&#125;:</span><br><span class="line">            \d&#123;5&#125;: 匹配5个数字</span><br><span class="line">            \d&#123;5,10&#125;: 匹配5个到10个数字</span><br><span class="line">            \d&#123;5,&#125;: 匹配5个或5个以上的数字</span><br><span class="line">        说明:</span><br><span class="line">            1）数量词*,+,&#123;5,&#125;，会尽可能多的去匹配结果（贪婪）</span><br><span class="line">            2）在后面加一个?表示尽可能少的去匹配结果（非贪婪）</span><br><span class="line">                google,goooogle ==&gt; /go+/</span><br></pre></td></tr></table></figure></p><hr><ul><li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="noopener">花田半亩</a></li><li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="noopener">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li><li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;tip&quot;&gt;本文介绍RegExp相关的知识点，包括正则表达式的创建、匹配规则等内容。&lt;/div&gt;&lt;br&gt;&lt;div class=&quot;titleX&quot;&gt;&lt;strong&gt;RegExp简单介绍&lt;/strong&gt;&lt;/div&gt;&lt;br&gt;&lt;strong&gt;正则表达式&lt;/stron
      
    
    </summary>
    
    
      <category term="javaScript系列" scheme="https://weibo.com/u/3800117445/tags/javaScript%E7%B3%BB%E5%88%97/"/>
    
  </entry>
  
  <entry>
    <title>javaScript系列 [28]-Event</title>
    <link href="https://weibo.com/u/3800117445/2019/05/01/javaScript%E7%B3%BB%E5%88%97%20%5B28%5D-Event/"/>
    <id>https://weibo.com/u/3800117445/2019/05/01/javaScript系列 [28]-Event/</id>
    <published>2019-04-30T16:23:18.000Z</published>
    <updated>2019-06-11T01:32:06.883Z</updated>
    
    <content type="html"><![CDATA[<div class="tip">本文介绍JavaScript事件相关的知识点，主要包括事件流、事件处理程序、事件对象(event)以及常见事件类型和事件委托等相关内容。</div><p><img src="https://github.com/flowerField/Source/blob/master/Blog/js_base45.png?raw=true"></p><p>在网页开发涉及的三种基础技术(<a href=""> HTML \ CSS \ JavaScript </a>)中，JavaScript主要负责处理页面的<code>行为</code>，而所谓行为大多指的是<code>交互行为</code>。<strong>JavaScript和HTML间的交互通过事件来实现</strong>，换句话来说事件其实就是页面文档或浏览器窗口中发生的特定交互，譬如页面中的按钮标签被点击我们称之为按钮的点击(<code>click</code>)事件，类似的还有页面加载事件、鼠标的移入移除等等。</p><p>通常,我们在开发中对事件的操作(处理)主要由两部分组成，即<code>事件注册</code>和<code>事件函数</code>。我们总是需要先通过特定的方式来给标签添加(注册)事件监听，当事件发生时事件函数将得以调用执行。本文以<strong>能够清晰明确的把事件的传递过程、事件注册的方式、事件对象以及常见的事件类型讲解清楚</strong>为目标。</p><p class="titleX"><strong>事件流</strong></p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/js_base47.png?raw=true"></p><p><strong>事件流</strong> 描述的其实是事件内在的传递过程(顺序)。</p><p>我们的开发经验是，当我们给某些标签注册(绑定)了事件后，该事件被触发就会执行对应的事件处理函数。这似乎是一个顺理成章的经验，但事件到底是如何传递的呢 ？我们知道在网页中有很多的Node节点，而Node节点之间是复杂的树结构，事件在接收、传递和处理的时候，是按照<code>目标节点-&gt;上层节点-&gt;根节点</code>还是<code>根节点-&gt;下层节点-&gt;目标节点</code>的顺序传递的呢？ 不管它们是按照什么样的顺序来传递接收的，事件在传递的时候都会形成一个流式的传递结构，这就是所谓的事件流。</p><p>关于事件流的处理最早由<a href=""> IE4 </a>和 <a href=""> Netscape Communicator 4 </a>两个浏览器开发团队提出具体方案，有意思的是它们在处理这个相同问题的时候居然提出了两种完全相反的事件流方案。其中，<a href=""> IE </a>的事件流是<strong>事件冒泡流</strong>，而 <a href=""> Netscape Communicator 4 </a>的事件流是<strong>事件捕获流</strong>。如果再加上<code>DOM2级事件规定的事件流</code>，那么意味着我们将要学习<code>三种不同事件流</code>，感觉有些棘手但好在它们本身并不复杂。下面我们将从IE的冒泡事件流开始介绍。</p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/js_base48.png?raw=true"></p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#fff;background:#195">事件冒泡流</span></p><p><strong>事件冒泡<a href=""> event bubbling </a></strong> 指的是事件开始时由最具体的元素接收，然后逐级向上传递到文档。</p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#fff;background:#195">事件捕获流</span></p><p><strong>事件捕获<a href=""> event capturing </a></strong> 指的是由页面文档先接收事件，然后逐级向下传递到最具体的元素。</p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/js_base50.png?raw=true"></p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#fff;background:#195">DOM事件流</span></p><p><strong>DOM2级事件</strong> 规定的事件流包括三个阶段：<a href="">事件捕获阶段</a>、<a href="">处于目标阶段</a> 和 <a href="">事件冒泡阶段</a>。事件捕获会首先发生，其为截获事件提供了机会，然后是实际的目标接收到事件，最后会对事件进行冒泡，可以在事件冒泡阶段对事件作出响应。</p><p><strong>事件流的浏览器支持情况</strong><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(一)事件冒泡流</span><br><span class="line">所有现代浏览器都支持事件冒泡，在具体实现的时候存在差异。</span><br><span class="line">IE5-的事件冒泡会跳过html标签，而IE9+、Firefox、Chrome 和 Safari 则将事件一直冒泡到 window 对象。</span><br><span class="line"></span><br><span class="line">(二)事件捕获流</span><br><span class="line">IE9+、Firefox、Chrome、Safari 和 Opera等浏览器均支持事件捕获流，它们均从 window 对象开始捕获事件。</span><br><span class="line">因为老版本的浏览器不支持，因此很少有人使用事件捕获流(只在特殊需要的时候)。</span><br><span class="line"></span><br><span class="line">(三)DOM事件流</span><br><span class="line">IE9+、Firefox、Chrome、Safari 和 Opera等浏览器均支持DOM事件流，IE8-则不支持。</span><br></pre></td></tr></table></figure></p><p class="titleX"><strong>事件处理程序(函数)</strong></p><p>事件指的是用户或浏览器自身执行的某种动作，譬如点击、拖拽、滚动等都是事件，在JavaScript中每种事件都有自己对应的名字，我们需要先通过特定的形式来给标签注册(绑定)事件，等事件被触发后进行响应，这个用来响应某个具体事件的函数我们称之为<code>事件处理函数</code>。</p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/js_base52.png?raw=true"></p><p>在网页开发中，我们为标签事件指定事件处理函数的方式有多种，下面分别介绍。</p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#666">① 在html标签中添加事件处理函数</span></p><p>我们可以直接在标签身上以<code>属性节点</code>的形式来添加事件处理函数，这个属性节点的值要求是能够执行的JavaScript代码，可以是弹出框、函数调用等等形式。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--弹出消息--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"alert('点击了按钮')"</span>&gt;</span>按钮1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--控制台输出--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"showMsg()"</span>&gt;</span>按钮2<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--弹出消息(事件的类型-click)--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">onclick</span>=<span class="string">"alert(event.type)"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--弹出消息(输入框的值-文顶顶)--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">onclick</span>=<span class="string">"alert(this.value)"</span> <span class="attr">value</span>=<span class="string">"文顶顶"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--弹出消息(输入框的值-文顶顶)--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">onclick</span>=<span class="string">"alert(value)"</span> <span class="attr">value</span>=<span class="string">"文顶顶"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--弹出消息(引用了表单中user输入框元素并访问其值-文顶顶)--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"文顶顶"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"点击输出用户名"</span> <span class="attr">onclick</span>=<span class="string">"alert(user.value)"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--鼠标的移入事件演示--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"width:200px;height:50px;background:red"</span> <span class="attr">onmouseenter</span>=<span class="string">"showLog()"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="keyword">function</span> <span class="title">showMsg</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"我是按钮点击事件的响应函数"</span>);</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="keyword">function</span> <span class="title">showLog</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"鼠标移入div标签"</span>);</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>在以这种方式处理的事件函数中有权访问全局作用域中的任何代码，而且在执行的代码中可以直接(不用自己定义或者是从函数形参中读取)通过<code>event</code>变量来访问事件对象，在函数内部<code>this</code>的值则指向事件的目标元素。此外，还有一个比较特殊的地方是它内部扩展作用域的方式，简单说就是在事件函数内部可以像访问局部变量一样来访问document和该元素本身的成员。</p><p class="tip"><strong>注意</strong> 我们在开发中应该尽量避免使用直接以属性节点的方式来处理标签的事件，因为它内在的作用域扩展机制在不同的浏览器中可能会产生不同的结果，而且这种方式让<code>JavaScript</code>和<code>HTML</code>代码交织在一起，耦合太过紧密不便于维护且违背代码分离的原则。</p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#666">② 通过标签的事件属性添加事件处理函数</span></p><p>我们也可以先通过DOM操作获取页面中指定的标签，然后通过把事件处理函数赋值给标签事件属性的方式来绑定事件。这种事件处理方式，因为其简单和跨浏览器的优势从第四代浏览器开始一直沿用至今。DOM中所有的元素(<a href=""> window \ document \ body \ div 等</a>)都拥有自己的事件处理属性，这些属性通常均为<code>on + 事件类型</code>的形式，全部小写且<span style="color:f05">每个事件支持一个事件处理函数</span>。</p><p>我们为标签(元素)注册(绑定)事件只需要把事件处理函数赋值给元素的事件属性即可，标签常用的事件属性有<code>onclick</code>、<code>onmouseenter</code>和<code>onkeydown</code>等，使用时形如<code>oBtn.onclick = function(){...}</code> ，如果需要将标签上绑定的事件移除则只需要把事件属性赋值为<code>null</code>即可。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"btnID"</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"divID"</span> <span class="attr">style</span>=<span class="string">"width: 100px;height: 50px;background: #195"</span>&gt;</span>我是div标签<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"inputID"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">placeholder</span>=<span class="string">"请输入..."</span> <span class="attr">value</span>=<span class="string">"文顶顶"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*01-获取页面中指定的标签*/</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> oBtn = <span class="built_in">document</span>.getElementById(<span class="string">"btnID"</span>);</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> oDiv = <span class="built_in">document</span>.getElementById(<span class="string">"divID"</span>);</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> oIpt = <span class="built_in">document</span>.getElementById(<span class="string">"inputID"</span>);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*02-给按钮注册点击事件*/</span></span></span><br><span class="line"><span class="javascript">  oBtn.onclick = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"按钮被点击了"</span>,event.type);          <span class="comment">//按钮被点击了 click</span></span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*03-给div注册鼠标移入移出事件*/</span></span></span><br><span class="line"><span class="undefined">  oDiv.onmouseenter = enter;</span></span><br><span class="line"><span class="undefined">  oDiv.onmouseleave = leave;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="keyword">function</span> <span class="title">enter</span>(<span class="params">event</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"鼠标移入div标签"</span>, event.currentTarget);</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="keyword">function</span> <span class="title">leave</span>(<span class="params">event</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"鼠标移出div标签"</span>, event.currentTarget);</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*04-给input标签注册监听事件*/</span></span></span><br><span class="line"><span class="javascript">  oIpt.oninput = <span class="function"><span class="keyword">function</span> (<span class="params">ev</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"监听input事件"</span>,<span class="keyword">this</span>.value);      <span class="comment">//实时获取文本输入框的值并打印</span></span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*05-演示删除事件*/</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">//oBtn.onclick = null;    打开后按钮的点击事件将失效</span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p class="tip">因为在这种处理方式中，事件函数被认为是标签(元素)的方法，因此函数中的<code>this</code>引用当前的标签(元素)，可以在事件处理函数中直接通过<code>this</code>来访问当前标签(元素)的任何属性和方法。</p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#666">③ 在JavaScript代码中为标签注册事件监听</span></p><p>我们还可以直接调用<code>addEventListener()</code>方法来给标签注册事件监听，同时支持为标签注册(<code>addEventListener</code>)和移除(<code>removeEventListener</code>)事件监听。所有的DOM节点都包含这两个方法，功能强大，唯一需要考虑的就是IE9-的兼容性问题。</p><p><strong><code>语法</code></strong> <code>ele.addEventListener(type,handle,bool)</code>  | <code>ele.removeEventListener(type,handle,bool)</code><br><strong><code>参数</code></strong> <code>type</code>表示要处理的事件名(类型)，<code>handle</code>是事件处理函数，<code>bool</code>控制调用事件函数的阶段，如果值为false(默认)则表示在冒泡阶段调用，值为true则表示在捕获阶段调用。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*01-获取页面中指定的标签*/</span></span><br><span class="line"><span class="keyword">var</span> oBtn = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"button"</span>)[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">/*02-给按钮绑定(注册)点击事件*/</span></span><br><span class="line"><span class="comment">/*02-A  捕获阶段调用事件函数*/</span></span><br><span class="line">oBtn.addEventListener(<span class="string">"click"</span>,listener, <span class="literal">true</span>);</span><br><span class="line"><span class="comment">/*02-B1 冒泡阶段调用事件函数*/</span></span><br><span class="line">oBtn.addEventListener(<span class="string">"click"</span>,listener1, <span class="literal">false</span>);</span><br><span class="line"><span class="comment">/*02-B2 冒泡阶段调用事件函数*/</span></span><br><span class="line">oBtn.addEventListener(<span class="string">"click"</span>,listener2, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*具体的-事件处理函数*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">listener</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"点击了按钮-A-捕获阶段"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">listener1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"点击了按钮-B1-冒泡阶段"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">listener2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"点击了按钮-B2-冒泡阶段"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*点击按钮后的执行情况*/</span></span><br><span class="line"><span class="comment">// 点击了按钮-A-捕获阶段</span></span><br><span class="line"><span class="comment">// 点击了按钮-B1-冒泡阶段</span></span><br><span class="line"><span class="comment">// 点击了按钮-B2-冒泡阶段</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*03-删除按钮的点击事件*/</span></span><br><span class="line">oBtn.removeEventListener(<span class="string">"click"</span>,listener2, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure><p>区别于<code>onclick</code>的方式，<code>addEventListener()</code>支持为标签绑定多个同类型的事件处理函数而且不存在覆盖的问题，当标签的事件被触发时绑定的事件处理函数会按照添加的顺序依次触发，需要注意的是在使用<code>removeEventListener()</code>方法移除标签的某个事件监听时，要求传入的函数同注册事件监听时的函数一致。此外，在IE9-的版本中，这两个方法不可用需考虑兼容性，在IE中我们可以使用<code>attachEvent</code>和<code>detachEvent</code>这两个方法来替代。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*01-获取页面中指定的标签*/</span></span><br><span class="line"><span class="keyword">var</span> oBtn = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"button"</span>)[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">/*IE8以及更早版本中注册事件监听的方式*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*02-给按钮注册事件监听*/</span></span><br><span class="line">oBtn.attachEvent(<span class="string">"onclick"</span>,listener1);</span><br><span class="line">oBtn.attachEvent(<span class="string">"onclick"</span>,listener2);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">listener1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"点击了按钮-A-冒泡阶段"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">listener2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"点击了按钮-B-冒泡阶段"</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>);       <span class="comment">//事件处理函数在全局作用域中运行(this-&gt;window)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*备注：如果给标签注册了多个事件监听，那么会以相反的顺序触发*/</span></span><br><span class="line"><span class="comment">//点击了按钮-B-冒泡阶段</span></span><br><span class="line"><span class="comment">//点击了按钮-A-冒泡阶段</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*03-演示移除事件处理程序的情况*/</span></span><br><span class="line">oBtn.detachEvent(<span class="string">"onclick"</span>,listener2);</span><br></pre></td></tr></table></figure><p></p><p class="tip">因为IE8及更早的版本只支持事件冒泡，因为通过<code>attachEvent()</code>方法添加的事件处理程序都会被添加到事件冒泡阶段，且事件函数中的this指向的并非事件标签而是<code>window</code>。</p>`<div class="titleX"><strong>常用的事件类型</strong></div><p></p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/js_base46.png?raw=true"></p><p>Web浏览器中可能发生的事件有很多种类型，如果是按照<code>DOM3级事件</code>的规定那么大概可以划分为UI事件、焦点和鼠标事件、文本和键盘事件以及变动事件等几种类型。因为涉及到的事件众多且用法各异，因此本节将只会简单罗列它们。</p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#fff;background:#195">常用事件列表</span><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">UI事件</span><br><span class="line">load :  当页面完全加载后(包括页面中所有图像、JavaScript和CSS文件等资源)触发window上面的load事件。</span><br><span class="line">unload: 当页面被完全卸载后触发window上面的unload事件，常用于清除引用以避免内存泄露。</span><br><span class="line">resize: 当浏览器窗口被调整时会触发window上面的resize事件，该事件不同浏览器触发机制不同(FireFox)。</span><br><span class="line">scroll: 当页面文档滚动的时候会触发window上面的scroll方法。</span><br><span class="line">        我们可以通过scrollLeft和scrollTop来监控该变化，需要注意标准和混杂模式下的差别。</span><br><span class="line">        </span><br><span class="line">焦点事件</span><br><span class="line">blur:   当元素失去焦点的时候触发。</span><br><span class="line">focus:  当元素获得焦点的时候触发。</span><br><span class="line"></span><br><span class="line">鼠标和滚轮事件</span><br><span class="line">click:      当被点击(或者按下键盘回车键)的时候触发。</span><br><span class="line">dbclick:    当被双击的时候触发。</span><br><span class="line">mousedown:  当用户按下任意鼠标键的时候触发。</span><br><span class="line">mouseup:    当用户释放鼠标按钮的时候触发。</span><br><span class="line">mouseenter: 当鼠标移入到元素范围内的时候触发，该事件不冒泡且对后代元素没影响。</span><br><span class="line">mouseleave: 当鼠标移出到元素范围内的时候触发，该事件不冒泡且对后代元素没影响。</span><br><span class="line">mousemove:  当鼠标在元素内部移动时重复触发。</span><br><span class="line">mouseover:  当鼠标移入到元素范围内的时候触发，对后代元素有影响。</span><br><span class="line">mouseout:   当鼠标移出到元素范围内的时候触发，对后代元素有影响。</span><br><span class="line">mousewheel: 当用户通过鼠标滚轮与页面交互滚动页面的时候触发。</span><br><span class="line"></span><br><span class="line">说明1：在一个元素中相继触发mousedown和mouseup事件后会自动触发click事件</span><br><span class="line">说明2：在一个元素中相继触发两次click事件则会自动触发dbclick事件。</span><br><span class="line"></span><br><span class="line">键盘和文本事件</span><br><span class="line">keydown:    当用户按下键盘上的任意键时触发，按住不放则重复触发。</span><br><span class="line">keypress:   当用户按下键盘上的字符键的时候触发，按住不放则重复触发。</span><br><span class="line">keyup:      当用户释放键盘上按键的时候触发。</span><br><span class="line">input:      在文本插入文本框之前触发input事件，是对keypress的补充。</span><br><span class="line">change:     在文本框内容改变(敲击回车键)的时候触发。</span><br><span class="line">select:     在文本被选中的时候触发。</span><br><span class="line">reset:      当点击重置按钮的时候被触发。</span><br><span class="line">submit:     表单提交的时候被触发。</span><br><span class="line"></span><br><span class="line">说明1：键盘和文本事件常用于用户通过文本框输入文本的时候。</span><br><span class="line">说明2：当用户按下键盘上字符键的时候首先触发keydown事件，然后是keypress事件最后触发keyup(后)事件。</span><br><span class="line">说明3：当用户按下键盘上非字符键的时候首先触发keydown事件，然后keyup(后)事件。</span><br><span class="line">说明4：任何可以获得焦点的元素都能够触发keypress事件，而只有可编辑区域才能触发textInput事件。</span><br><span class="line"></span><br><span class="line">DOM节点事件</span><br><span class="line">DOMSubtreeModified:     DOM结构发生任何变化都会触发。</span><br><span class="line">DOMNodeInserted:        当某个节点被插入到另一个节点中时被触发。</span><br><span class="line">DOMNodeRemoved:         当某个节点被从其父节点中删除时会被触发。</span><br><span class="line">DOMNodeInsertedIntoDocument: 当某个节点被插入到文档后会被触发。</span><br><span class="line">DOMNodeRemovedFromDocument:  当某个节点被从文档中删除后被触发。</span><br><span class="line">DOMAttrModified:             当属性节点被修改后被触发。</span><br><span class="line">DOMCharacterDataModified:    当文本节点值发生变化时被触发。</span><br><span class="line"></span><br><span class="line">注意：IE8及更早版本不支持任何DOM事件。</span><br><span class="line"></span><br><span class="line">HTML5事件</span><br><span class="line">contextmenu:      该事件用于控制显示自定义的上下文菜单。</span><br><span class="line">beforeunload:     该事件在页面卸载前触发，通常表现为弹出对话框提示用户是否确认离开页面。</span><br><span class="line">DOMContentLoaded: 当DOM树构造完成后触发，先于load，我们可以通过document来监听。</span><br><span class="line">readystatechange: 当文档状态发生改变时触发，支持该事件的对象均拥有readyState属性来获取当前状态。</span><br><span class="line">    uninitialized(未初始化)：对象存在但尚未初始化。</span><br><span class="line">    loading(正在加载)：      对象正在加载数据。</span><br><span class="line">    loaded(加载完毕)：       对象加载数据完成。</span><br><span class="line">    interactive(交互)：     可以交互操作对象，但还没有完全加载完毕。</span><br><span class="line">    complete(完成)：        对象已经加载完毕。</span><br><span class="line">。</span><br></pre></td></tr></table></figure></p><p>通常，我们总是把JavaScript的代码写到<code>window.onload</code>函数中以保证在执行JavaScript代码的时候页面和所有资源均以加载完毕。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--&lt;body onload="alert('页面加载完毕')"&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">placeholder</span>=<span class="string">"请输入"</span> <span class="attr">id</span>=<span class="string">"inputID"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*01-演示常见的UI事件*/</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span> (<span class="params">ev</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"页面所有资源都加载完毕--onload"</span>);</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="built_in">window</span>.onunload = <span class="function"><span class="keyword">function</span> (<span class="params">ev</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    alert(<span class="string">"页面被卸载---onunload"</span>)</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="built_in">window</span>.onresize = <span class="function"><span class="keyword">function</span> (<span class="params">ev</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"浏览器窗口大小被调整--onresize"</span>);</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="built_in">window</span>.onscroll = <span class="function"><span class="keyword">function</span> (<span class="params">ev</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"监听到页面滚动----onscroll"</span>)</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*02-获取页面中对应的标签*/</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> oInput = <span class="built_in">document</span>.getElementById(<span class="string">"inputID"</span>);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*键盘回车执行一次*/</span></span></span><br><span class="line"><span class="javascript">  oInput.onchange = <span class="function"><span class="keyword">function</span> (<span class="params">ev</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"输入框的值发生了变化--change"</span>,<span class="keyword">this</span>.value);</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*只要输入框的值发生变化就会执行一次*/</span></span></span><br><span class="line"><span class="javascript">  oInput.oninput  = <span class="function"><span class="keyword">function</span> (<span class="params">ev</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"输入框的值发生了变化--oninput"</span>,<span class="keyword">this</span>.value);</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  oInput.onfocus = <span class="function"><span class="keyword">function</span> (<span class="params">ev</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"输入框获得焦点--onfocus"</span>);</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  oInput.onblur = <span class="function"><span class="keyword">function</span> (<span class="params">ev</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"输入框失去焦点--onblur"</span>);</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">// 页面所有资源都加载完毕--onload</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">// 输入框获得焦点--onfocus</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">// 输入框的值发生了变化--oninput w</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">// 输入框的值发生了变化--oninput we</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">// 输入框的值发生了变化--oninput wen</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">// 输入框的值发生了变化--change wen</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">// 输入框失去焦点--onblur</span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="titleX"><strong>事件对象</strong></div><p>事件对象记录着当事件发生时与该事件相关的所有必要信息，包括<code>事件的目标对象</code>、<code>事件的类型</code>等等，通常我们总是使用<code>event</code>或者<code>e</code>来表示事件对象。所有的浏览器都支持事件对象，但支持方式不同。兼容DOM的浏览器总是会将事件对象(<code>event</code>)作为第一个参数传入到事件处理函数中，而在IE8-版本的浏览器中事件对象作为window的属性存在，因此我们在具体写代码的时候需要考虑兼容问题。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*演示在事件处理函数中获取事件对象*/</span></span><br><span class="line">  <span class="keyword">var</span> oBtn = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"button"</span>)[<span class="number">0</span>];</span><br><span class="line">  oBtn.onclick = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> e = event || <span class="built_in">window</span>.event;</span><br><span class="line">    <span class="built_in">console</span>.dir(e);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p><p>我们可以通过上面这一小段代码的运行结果来讨论事件对象的核心成员，具体参考下面的结果以及给出的标准。需要说明的是，下面列出的是常用的<code>click事件</code>中事件对象的成员，并非所有事件的<code>event</code>对象都长这样。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">MouseEvent</span><br><span class="line">    altKey: false             //当事件被触发时，"ALT" 是否被按下</span><br><span class="line">    bubbles: true             //表明事件是否冒泡</span><br><span class="line">    button: 0                 //返回当事件被触发时，哪个鼠标按钮被点击。</span><br><span class="line">    buttons: 0</span><br><span class="line">    cancelBubble: false      //表明是否阻止事件冒泡     </span><br><span class="line">    cancelable: true         //表明是否可以取消事件的默认行为</span><br><span class="line">    clientX: 33              //事件发生位置的X坐标，参考页面的可视区域</span><br><span class="line">    clientY: 26              //事件发生位置的Y坐标</span><br><span class="line">    composed: true</span><br><span class="line">    ctrlKey: false           //当事件被触发时，"CTRL" 键是否被按下</span><br><span class="line">    currentTarget: null      //事件处理程序当前正在处理的那个元素</span><br><span class="line">    defaultPrevented: false  //表示是否已经调用了preventDefault()方法禁止默认行为</span><br><span class="line">    detail: 1                //与事件相关的细节信息</span><br><span class="line">    eventPhase: 0            //调用事件处理程序的阶段,1-捕获，2-目标，3-冒泡</span><br><span class="line">    fromElement: null</span><br><span class="line">    isTrusted: true</span><br><span class="line">    layerX: 33               //视图位置的X坐标</span><br><span class="line">    layerY: 26               //视图位置的Y坐标</span><br><span class="line">    metaKey: false           //返回当事件被触发时，"meta" 键是否被按下。</span><br><span class="line">    movementX: 0</span><br><span class="line">    movementY: 0</span><br><span class="line">    offsetX: 24              //发生事件的地点在事件源元素的坐标系统中的 x 坐标</span><br><span class="line">    offsetY: 15              //发生事件的地点在事件源元素的坐标系统中的 y 坐标</span><br><span class="line">    pageX: 33                //页面位置的X坐标,页面没有滚动情况下等价于clientX</span><br><span class="line">    pageY: 26                //页面位置的Y坐标,页面没有滚动情况下等价于clientY</span><br><span class="line">    path: (5) [button, body, html, document, Window]  //DOM数的路径</span><br><span class="line">    relatedTarget: null      //返回与事件的目标节点相关的节点</span><br><span class="line">    returnValue: true        //默认未true,设置未false表示取消事件的默认行为</span><br><span class="line">    screenX: 89              //事件的屏幕(相对于电脑屏幕)位置X坐标</span><br><span class="line">    screenY: 189             //事件的屏幕(相对于电脑屏幕)位置Y坐标</span><br><span class="line">    shiftKey: false          //当事件被触发时，"SHIFT" 键是否被按下。</span><br><span class="line">    sourceCapabilities: InputDeviceCapabilities &#123;firesTouchEvents: false&#125;</span><br><span class="line">    srcElement: button       //事件的目标，同target保持一致</span><br><span class="line">    target: button           //事件作用于哪个标签</span><br><span class="line">    timeStamp: 2490.9807     //从启动到事件发生间的时间戳</span><br><span class="line">    toElement: button        //对于鼠标移入和移出事件，该属性引用移入鼠标的元素</span><br><span class="line">    type: "click"            //事件的类型</span><br><span class="line">    view: Window &#123;postMessage: ƒ, blur: ƒ, focus: ƒ, close: ƒ, parent: Window, …&#125;</span><br><span class="line">    which: 1        //对于keypress事件，该属性声明被敲击的键生成的 Unicode 字符码。</span><br><span class="line">    x: 33                     //事件发生的位置的 x 坐标</span><br><span class="line">    y: 26                     //事件发生的位置的 y 坐标</span><br></pre></td></tr></table></figure><p><strong>位置说明</strong> 下图说明了事件对象中<code>offsetX/Y</code>和<code>ScreenX/Y</code>以及<code>clientX/Y</code>的关系。<br><img src="https://github.com/flowerField/Source/blob/master/Blog/js_base51.png?raw=true"></p><p><strong>事件对象的兼容性问题</strong> DOM和IE中的事件对象有很多不同之处，下面简单列出对比。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[1] event                    window.event               获取事件对象 </span><br><span class="line">[2] event.target             event.srcElement           获取事件目标对象</span><br><span class="line">[3] event.preventDefault();  event.returnValue = false; 禁止标签默认行为</span><br><span class="line">[4] event.stopPropagation(); event.cancelBubble = true; 禁止事件冒泡</span><br></pre></td></tr></table></figure></p><div class="titleX"><strong>事件冒泡 | 默认行为 | 事件委托</strong></div><p><strong>事件冒泡</strong> 当我们在某个标签节点上触发某类事件时(譬如<code>click点击事件</code>)，该事件会沿着DOM树向上层节点逐级传播直到最顶层，在向上传播的过程中如果该节点注册了同类型的事件，那么这些事件也会被触发。</p><p><strong><code>注意[1]</code></strong> 绝大部分的事件都能冒泡，除<a href=""> blur、focus、load、unload </a>几个特殊的事件外。<br><strong><code>注意[2]</code></strong> 事件冒泡到最顶层的目标不同，大部分浏览器到window对象，IE8-到document对象。<br><strong><code>注意[3]</code></strong> 开发中我们可以在事件函数中调用<code>event.stopPropagation()方法</code>来阻止事件冒泡，如果是<a href="">IE8-</a>浏览器则需要通过<code>event.cancelBubble = true</code>代码设置。</p><p><strong>默认行为</strong>  HTML页面中的很多标签都存在默认行为，譬如超连接点击的时候会自动跳转到目标页面，表单点击提交后会把内容提交到action指定的页面，还有右键菜单以及文本选择等等。在开发中，我们如果需要阻止这些标签的默认行为，那么可以使用<code>event.preventDefault()方法</code>，如果是<a href="">E8-</a>浏览器则需要通过<code>event.returnValue = false</code>代码设置。</p><p><strong>事件委托</strong> 事件委托是一种用来解决<code>页面中事件处理函数过多</code>问题的方案，它利用事件冒泡只指定一个事件处理函数就能够管理某一类型的所有事件，恰当的利用事件委托，可以节省内存空间，有效的提升程序的整体性能。 </p><hr><ul><li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="noopener">花田半亩</a></li><li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="noopener">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li><li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;tip&quot;&gt;本文介绍JavaScript事件相关的知识点，主要包括事件流、事件处理程序、事件对象(event)以及常见事件类型和事件委托等相关内容。&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;https://github.com/flowerField/Sou
      
    
    </summary>
    
    
      <category term="javaScript系列" scheme="https://weibo.com/u/3800117445/tags/javaScript%E7%B3%BB%E5%88%97/"/>
    
  </entry>
  
  <entry>
    <title>javaScript系列 [27]-DOM</title>
    <link href="https://weibo.com/u/3800117445/2019/04/18/javaScript%E7%B3%BB%E5%88%97%20%5B27%5D-DOM/"/>
    <id>https://weibo.com/u/3800117445/2019/04/18/javaScript系列 [27]-DOM/</id>
    <published>2019-04-17T16:23:18.000Z</published>
    <updated>2019-06-11T01:32:07.216Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://github.com/flowerField/Source/blob/master/Blog/tree_02.png?raw=true" height="250px"></p><div class="tip">本文将详细介绍DOM相关的知识点，包括但不限于Document文档结构、Node节点、Node节点的类型、Node节点的关系以及DOM的基本操作( <code>节点的获取</code>、<code>节点的创建</code>、<code>节点的插入</code>、<code>节点的克隆</code>和<code>删除</code>等 )等内容，在文章的最后还以附录的形式列出了DOM相关的所有属性和方法，需要指出的是本文不包含任何浏览器历史、内核以及页面渲染的内容，如有需要请参考 <a href="http://wendingding.com/2018/06/05/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%B3%BB%E5%88%97%20%E6%B5%8F%E8%A7%88%E5%99%A8%E3%80%81HTML%E5%92%8C%E5%86%85%E6%A0%B8(%E5%BC%95%E6%93%8E" target="_blank" rel="noopener"> 浏览器、内核和引擎 </a>和<a href="http://wendingding.com/2018/06/11/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E7%B3%BB%E5%88%97%20HTML%E9%A1%B5%E9%9D%A2%E6%B8%B2%E6%9F%93%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%BF%87%E7%A8%8B/" target="_blank" rel="noopener"> HTML页面渲染的基本过程 </a>这两篇文章。</div><h3 id="1-0-关于DOM"><a href="#1-0-关于DOM" class="headerlink" title="1.0  关于DOM"></a>1.0  关于DOM</h3><p><strong>简单介绍</strong></p><p>DOM（全称为Document Object Model）即<strong><code>文档对象模型</code></strong>，<span style="color:#195">是用于表示和操作HTML或XML文档内容的一套基础API( <code>Application Programming Interface</code>)。</span>DOM把整个页面映射为一个多层节点结构，HTML 或 XML页面中的每个组成部分都是某种类型的节点，这些节点又包含着不同类型的数据。当网页被加载时，浏览器会内部的引擎会根据DOM模型，将结构化文档（比如HTML和XML）解析成一系列的节点，再由这些节点构建出一种树状结构（DOM Tree）。</p><div class="tip"><br>✧ 有时候我们可能会看到DHTML这个专业术语：<span style="color:#195">DHTML是动画HTML的简称</span>，其并不是一项新的技术，而是描述HTML CSS JavaScript技术组合的术语。它曾被认为是HTML/XHTML CSS和JavaScript相结合的产物，像今天的HTML5，但真正凝聚它们的是DOM。<br></div><p>下面给出一段简单的HTML示例代码和对应的DOM树结构图。图示中的的方框代表着文档中的一个个节点，每个方框（节点）暨一个Node对象，所有这些节点组成了DOM树。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>DOM树演示代码<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"className"</span>&gt;</span>Hi! 文顶顶<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://www.wendingding.com"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/dom1.png?raw=true"></p><p><strong>节点的类型</strong></p><p>HTML页面中拥有众多类型的节点，不同类型的节点其表示和操作的方式有很大的差异，下面分别列出：</p><blockquote><p>❏ Text：标签之间或标签包含的文本内容<br>❏ Comment：HTML或XML中的注释<br>❏ Element：网页的各种HTML标签，如a标签 div标签等<br>❏ Document：整个DOM树的根，代表整个文档<br>❏ Attribute：网页元素的属性节点<br>❏ DocumentType：文档类型（doctype）标签<br>❏ DocumentFragment：文档的片段，如果感觉费解请移步<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/DocumentFragment" target="_blank" rel="noopener">MDN-DocumentFragment</a></p></blockquote><p>尽管在HTML页面中存在着如此众多类型的节点，但我们真正需要关注的主要还是：<strong><code>元素节点</code></strong>、<strong><code>属性节点</code></strong>和<strong><code>文本节点</code></strong>。在(HTML|XHTML)文档中，文本节点总是被包含在元素节点的内部，属性节点用来对元素做出更具体的描述。</p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/dom2.png?raw=true"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">在上面的图示中，我们提供了一个div标签，该标签拥有“上坡和下坡不就是同一条路吗”文本内容和两个属性节点。</span><br><span class="line">① 个div标签由开始标签和结尾标签组成，本身是Element类型的。</span><br><span class="line">② “上坡和下坡不就是同一条路吗”作为div标签的文本内容，本身是Text类型的。</span><br><span class="line">③ div标签中的class和title是属性节点(key-value)，本身是Attribute类型的。</span><br></pre></td></tr></table></figure><p><strong>节点关系</strong></p><p>DOM中节点的关系主要有<strong><code>子节点</code></strong> <strong><code>父节点</code></strong> <strong><code>后代节点(子孙节点)</code></strong> <strong><code>祖先节点</code></strong> <strong><code>兄弟节点</code></strong>这几种情况，我们可以通过下面的示意图先对DOM中的节点关系有一个简单的认识。</p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/js_base41.png?raw=true"></p><p><strong>DOM标准</strong></p><p>从 IE4 和 Netscape Navigator4 开始，它们开始分别支持不同形式的DHTML(<code>Dynamic HTML</code>)为Web技术的发展带来了很大的便利，但是也因为微软和 Netscape 在DHTML的技术发展方面各持己见，导致编写的网页如果要同时运行在它们的浏览器上面需要做大量的适配工作，它们甚至互不兼容。因此，负责制定Web通信标准的 W3C(<code>World Wide Web Consortium</code>)开始着手规划DOM规范，DOM规范有DOM0、DOM1、DOM2和DOM3等4个级别，具体范围可以参考下图。</p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/js_base44.png?raw=true"></p><p><strong>规范说明</strong> </p><p>目前DOM规范的0级、1级和2级基本上已经被主流浏览器全部支持，DOM3级被部分支持( <code>IE9+已经全部支持DOM1、2、3</code>)。此外需说明的是除DOM规范外还存在一些扩展性的规范，比如<code>HTML5</code>、<code>Selectors API</code>和<code>Element Traversal</code>以及<code>SVG ( Scalable Vector Graphic)</code>规范等，在支持(兼容)这些规范的浏览器中都可以使用它们提供的标准API。下面给出相关规范的文档地址，详情请自行查阅。</p><p><a href="https://www.w3.org/TR/REC-DOM-Level-1/" target="_blank" rel="noopener">DOM1 规范</a><br><a href="https://www.w3.org/TR/DOM-Level-2/" target="_blank" rel="noopener">DOM 2规范</a><br><a href="https://www.w3.org/TR/DOM-Level-3-Core/" target="_blank" rel="noopener"> DOM 3 规范 </a><br><a href="https://www.w3.org/TR/selectors-api/" target="_blank" rel="noopener"> Selectors API规范文档 </a><br><a href="https://www.w3.org/TR/html/" target="_blank" rel="noopener"> HTML5 规范文档</a><br><a href="">Element Traversal 规范文档</a><br><a href="https://www.w3.org/TR/SVG2/" target="_blank" rel="noopener">Scalable Vector Graphic规范</a><br><a href="http://www.ecma-international.org/ecma-262/9.0/index.html" target="_blank" rel="noopener">ECMAScript-262/2018/6</a></p><h3 id="2-0-Node-amp-amp-Element-amp-amp-nodeType"><a href="#2-0-Node-amp-amp-Element-amp-amp-nodeType" class="headerlink" title="2.0 Node &amp;&amp; Element &amp;&amp; nodeType"></a>2.0 Node &amp;&amp; Element &amp;&amp; nodeType</h3><p><span style="color:red">Node（节点）和 Element（元素节点）是严格区分的</span>。也就是说Node和Element不能简单的混为一谈，因为很多人都搞不清楚它们的关系，所以这里单独拿出来讨论。</p><p><strong><code>Node</code></strong> 节点，表示构成DOM树的最小组成部分。换句话来说，在页面中不论是元素节点、文本节点还是注释或者别的东西本质上都是Node节点。</p><p><strong><code>Element</code></strong>元素节点，是Node节点中的一种类型。</p><p>通俗的来讲，node节点就像人一样，是一种基本的类型。（大哲学家柏拉图对人的定义是：人是两腿无毛会直立行走的动物  <span style="color:#0b0">：）</span> 而人这种基本类型中，又存在着小孩、中年人、老年人、学生、教师、司机、男人、女人等种种具体的类型。</p><p>对应到这里的关系，那么Element其实是node的一种更具体的类型。不止Element，像Text、Comment以及Attribute等等这些其实都是特殊的Node，它们拥有自己的类型常量（<span style="color:#f88">TEXT_NODE、COMMENT_NODE以及ATTRIBUTE_NODE</span>）用于区分彼此。文档中所有的node节点都拥有nodeType属性，我们可以通过该属性的值来确定节点的具体类型，下面列出对应关系。</p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/js_base40.png?raw=true"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 可以直接在开发者工具的控制台中像下面这样检测和验证节点的类型</span><br><span class="line">document.body.nodeType     //输出结果为1</span><br><span class="line">document.body.ELEMENT_NODE                           //输出结果为1</span><br><span class="line">document.body.ELEMENT_NODE == document.body.nodeType //输出结果为true</span><br><span class="line"></span><br><span class="line"># 需要注意的是ELEMENT_NODE是常量</span><br></pre></td></tr></table></figure><p><strong>NodeList 和 HTMLCollection类型</strong></p><p>相信很多开发者都有这样的经验，<strong><span style="color:red">“我们通过节点的childNodes属性获取的结果和children属性获取的结果是不一样的”</span></strong>。下面我们通过一段简短的代码来说明它们的不同。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"demoID"</span>&gt;</span></span><br><span class="line">    我是测试的文字---A！！</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>div1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>div2<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"className"</span>&gt;</span>div3<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--注释的内容:后面跟span标签--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>我是span<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    我是测试的文字---B！！</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> oDiv = <span class="built_in">document</span>.getElementById(<span class="string">"demoID"</span>);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"元素节点的children属性 == HTMLCollection类型"</span>);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(oDiv.children);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(oDiv.children.length);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"元素节点的childNodes属性 ==  NodeList类型"</span>);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(oDiv.childNodes);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(oDiv.childNodes.length);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure><p><img src="https://github.com/flowerField/Source/blob/master/Blog/dom5.png?raw=true"></p><p>通过代码的执行情况可以发现，元素节点(这里为id为demoID的div元素)的children属性得到的是HTMLCollection类型的伪数组，而childNodes属性得到的是NodeList型的伪数组。[<code>注意：它们是伪数组的结构，可以遍历但非真正意义上的数组</code>]。</p><p><span style="color:#195">NodeList是Node集合，而HTMLCollection可以认为是Element的集合。NodeList、NameNodeMap和HTMLCollection它们的结构类似，保存的都是基于DOM结构动态查询的结果，而非快照，故而在执行遍历操作的时候需要注意无限循环的问题。</span></p><div class="tip">通常来说<span style="color:#195">Document和HTMLDocument</span>以及<span style="color:#195">Element类型与和HTMLElement类型</span>是严格区分的。Document类型代表一个HTML或XML文档，Element类型代表该文档中的一个元素。而HTMLDocument和HTMLElement通常只针对HTML文档和其元素。</div><h3 id="3-0-DOM操作基础"><a href="#3-0-DOM操作基础" class="headerlink" title="3.0 DOM操作基础"></a>3.0 DOM操作基础</h3><p></p><p class="titleX"><strong>节点基本操作</strong></p><span style="border:1px solid #ccc;padding:2px 10px;color:#666">节点的获取</span><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"box"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>测试1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>测试2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box1"</span> <span class="attr">name</span>=<span class="string">"test"</span>&gt;</span>box1-1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box1"</span>&gt;</span>box1-2<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span> <span class="attr">name</span>=<span class="string">"formTest"</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">  </span></span><br><span class="line"><span class="undefined">  /*获取元素节点的方法</span></span><br><span class="line"><span class="javascript">  * [<span class="number">1</span>] <span class="built_in">document</span>.getElementById(id)     通过id来获取标签(<span class="number">1</span>)</span></span><br><span class="line"><span class="undefined">  * [2] getElementsByTagName(tagname)   通过标签名称来获取标签(n)</span></span><br><span class="line"><span class="javascript">  * [<span class="number">3</span>] getElementsByClassName()        通过<span class="class"><span class="keyword">class</span>来获取标签(<span class="title">n</span>)</span></span></span><br><span class="line"><span class="javascript">  * [<span class="number">4</span>] <span class="built_in">document</span>.getElementsByName()    通过name属性节点来获取标签(n)</span></span><br><span class="line"><span class="undefined">  * */</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> oDiv  = <span class="built_in">document</span>.getElementById(<span class="string">"box"</span>);           <span class="comment">//div#box</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> oDivs = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"box1"</span>);  <span class="comment">//[box1,box1]</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*提示：直接在已有标签内部查找，速度更快*/</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> oLis  = oDiv.getElementsByTagName(<span class="string">"li"</span>);          <span class="comment">//[li,li]</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> oDivN = <span class="built_in">document</span>.getElementsByName(<span class="string">"test"</span>)        <span class="comment">//[div.box1]</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p><p><strong>说明</strong> 上面代码中展示了获取节点的常用方式，此外<a href="https://www.w3.org/TR/selectors-api/" target="_blank" rel="noopener"> Selectors API </a>标准还为我们提供了两个非常强大的基于CSS选择器查询DOM节点的方法。它们分别是<code>querySelector()</code>和<code>querySelectorAll()</code>方法，均接收一个CSS选择器作为参数，目前<code>IE8+\Firefox 3.5+\ Safari 3.1+\Chrome和Opera 10+</code>均支持它们。 </p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#666">节点的属性</span></p><p><code>nodeType</code> 获取节点的类型，元素为1，属性为2，文本为3<br><code>nodeName</code> 获取节点的名称，元素节点返回大写标签名，属性节点返回属性名，文本节点返回#text<br><code>nodeValue</code>获取节点的值，元素节点固定返回 <code>null</code>，属性节点返回属性值，文本节点直接返回内容</p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#666">节点的创建和插入</span><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*节点创建的相关方法</span></span><br><span class="line"><span class="comment"> * [1] document.createElement(type)          创建元素节点</span></span><br><span class="line"><span class="comment"> * [2] document.createTextNode(text)         创建文本节点</span></span><br><span class="line"><span class="comment"> * [3] document.createAttribute()            创建属性节点</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 节点插入的相关方法</span></span><br><span class="line"><span class="comment"> * [1]  ele.appendChild(node)              把node插入到ele子节点的末尾</span></span><br><span class="line"><span class="comment"> * [2]  ele.insertBefore(newNode,node)     在ele的子节点node前插入新的子节点newNode</span></span><br><span class="line"><span class="comment"> * [3]  ele.setAttributeNode(attrNode)     在指定元素中插入属性节点</span></span><br><span class="line"><span class="comment"> * */</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">/*01-创建div标签并插入到页面中*/</span></span><br><span class="line"> <span class="keyword">var</span> oDiv = <span class="built_in">document</span>.createElement(<span class="string">"div"</span>);</span><br><span class="line"></span><br><span class="line"> <span class="comment">/*02-给div创建文本节点*/</span></span><br><span class="line"> <span class="keyword">var</span> oText = <span class="built_in">document</span>.createTextNode(<span class="string">"滴答滴答~"</span>);</span><br><span class="line"> </span><br><span class="line"> <span class="comment">/*03-把文本节点插入到div中*/</span></span><br><span class="line"> oDiv.appendChild(oText);</span><br><span class="line"></span><br><span class="line"> <span class="comment">/*04-创建test属性节点*/</span></span><br><span class="line"> <span class="keyword">var</span> oAttr = <span class="built_in">document</span>.createAttribute(<span class="string">"test"</span>);</span><br><span class="line"> </span><br><span class="line"> <span class="comment">/*05-设置属性节点的值*/</span></span><br><span class="line"> oAttr.nodeValue = <span class="string">"test的value"</span>;</span><br><span class="line"> </span><br><span class="line"> <span class="comment">/*06-把属性节点设置到div标签中*/</span></span><br><span class="line"> oDiv.setAttributeNode(oAttr);</span><br><span class="line"></span><br><span class="line"> <span class="comment">/*07-创建span元素节点*/</span></span><br><span class="line"> <span class="keyword">var</span> oSpan = <span class="built_in">document</span>.createElement(<span class="string">"span"</span>);</span><br><span class="line"> </span><br><span class="line"> <span class="comment">/*08-把span标签插入到oDiv里文本节点的前面*/</span></span><br><span class="line"> oDiv.insertBefore(oSpan,oText);</span><br><span class="line"></span><br><span class="line"> <span class="comment">/*09-把div标签插入到body子节点的末尾*/</span></span><br><span class="line"> <span class="built_in">document</span>.body.appendChild(oDiv);</span><br><span class="line"> <span class="built_in">console</span>.log(oDiv);</span><br><span class="line"> </span><br><span class="line"> <span class="comment">/*备注：测试各种类型node的nodeType、nodeName和nodeValue属性*/</span></span><br><span class="line"> <span class="comment">/*备注：nodeName和tagName是等价的，均为全部大写的标签名(类型)*/</span></span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">"元素节点-oSpan.nodeType = "</span> +oSpan.nodeType);  <span class="comment">//oSpan.nodeType = 1</span></span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">"属性节点-oAttr.nodeType = "</span> +oAttr.nodeType);  <span class="comment">//oAttr.nodeType = 2</span></span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">"文本节点-oText.nodeType = "</span> +oText.nodeType);  <span class="comment">//oText.nodeType = 3</span></span><br><span class="line"> </span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">"元素节点-oSpan.nodeName = "</span> +oSpan.nodeName);  <span class="comment">//oSpan.nodeName = SPAN</span></span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">"属性节点-oAttr.nodeType = "</span> +oAttr.nodeName);  <span class="comment">//oAttr.nodeType = test</span></span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">"文本节点-oText.nodeName = "</span> +oText.nodeName);  <span class="comment">//oText.nodeName = #text</span></span><br><span class="line"> </span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">"元素节点-oSpan.nodeValue ="</span> +oSpan.nodeValue);<span class="comment">//oSpan.nodeValue = null</span></span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">"属性节点-oAttr.nodeValue ="</span> +oAttr.nodeValue);<span class="comment">//oAttr.nodeValue = test的value</span></span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">"文本节点-oText.nodeValue ="</span> +oText.nodeValue);<span class="comment">//oText.nodeValue = 滴答滴答~</span></span><br></pre></td></tr></table></figure></p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/js_base39.png?raw=true"></p><p><strong>说明</strong> 上面的代码中我分别演示了创建元素节点(<code>createElement</code>)、文本节点(<code>createTextNode</code>)以及属性节点(<code>createAttribute</code>)的相关方法，在创建节点后对它们执行了插入操作，主要用到了<code>appendChild</code>和<code>insertBefore</code>方法。这里需要说明的是，上面的代码仅供方法演示用，在实际的开发中用上面的这种方式来处理未免太过麻烦和复杂。通常我们会有更简单的方式来操作<code>文本节点</code>和<code>属性节点</code>，下面以渐进的方式给出两种更简单的实现方案。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*01-创建div标签并插入到页面中*/</span></span><br><span class="line"><span class="keyword">var</span> oDiv = <span class="built_in">document</span>.createElement(<span class="string">"div"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*02-创建文本节点并插入*/</span></span><br><span class="line">oDiv.innerText = <span class="string">"滴滴答答~"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*03-创建属性及节点并设置后插入*/</span></span><br><span class="line">oDiv.setAttribute(<span class="string">"test"</span>,<span class="string">"test的value值"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*04-创建span元素节点*/</span></span><br><span class="line"><span class="keyword">var</span> oSpen = <span class="built_in">document</span>.createElement(<span class="string">"span"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*05-把span标签插入到div中文本节点前*/</span></span><br><span class="line">oDiv.insertBefore(oSpen,oDiv.childNodes[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*06-把div标签插入到body子节点的末尾*/</span></span><br><span class="line"><span class="built_in">document</span>.body.appendChild(oDiv);</span><br><span class="line"><span class="built_in">console</span>.log(oDiv);</span><br></pre></td></tr></table></figure><p><strong>说明</strong> 上面的代码中我们通过 <code>innerText</code>属性来简化了创建文本节点并插入的操作，且使用了更方便直接的<code>setAttribute</code>方法来简化了<a href=""> 创建属性节点 - 设置 - 插入到标签 </a>的过程。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*01-创建div标签并插入到页面中*/</span></span><br><span class="line"><span class="keyword">var</span> oDiv = <span class="built_in">document</span>.createElement(<span class="string">"div"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*02-设置标签的节点和属性内容*/</span></span><br><span class="line">oDiv.innerHTML = <span class="string">"&lt;span&gt;&lt;/span&gt;滴滴答答~"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*03-设置div标签的属性节点*/</span></span><br><span class="line">oDiv.setAttribute(<span class="string">"test"</span>,<span class="string">"test的value值"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*04-把div标签插入到body子节点的末尾*/</span></span><br><span class="line"><span class="built_in">document</span>.body.appendChild(oDiv);</span><br><span class="line"><span class="built_in">console</span>.log(oDiv);</span><br></pre></td></tr></table></figure><p><strong>说明</strong> 上面的代码中我们使用<code>innerHTML</code>属性来完成了设置div标签子节点工作，该属性和<code>innerText</code>很相像，区别在于<code>innerHTML</code>在解析的时候会解析元素节点而<code>innerText</code>则解析为纯文本形态。</p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#666">基于节点关系的操作</span><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"box"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span>我是spanA<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"span-class"</span>&gt;</span>我是spanB<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  我是div标签的文本</span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span>我是spanC<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"> /* 父节点：parentNode</span></span><br><span class="line"><span class="undefined">  * 父元素：parentElement</span></span><br><span class="line"><span class="undefined">  *</span></span><br><span class="line"><span class="undefined">  * 子节点：childNodes firstChild          lastChild</span></span><br><span class="line"><span class="undefined">  * 子元素：children   firstElementChild   lastElementChild</span></span><br><span class="line"><span class="undefined">  *</span></span><br><span class="line"><span class="undefined">  * 兄弟节点：previousSibling           nextSibling</span></span><br><span class="line"><span class="undefined">  * 兄弟元素：previousElementSibling    nextElementSibling</span></span><br><span class="line"><span class="undefined">  */</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*01-获取外层的div标签*/</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> oDiv  = <span class="built_in">document</span>.getElementById(<span class="string">"box"</span>);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*02-对比子节点和子元素*/</span></span></span><br><span class="line"><span class="javascript"> <span class="built_in">console</span>.log(oDiv.childNodes);          <span class="comment">//NodeList(7)</span></span></span><br><span class="line"><span class="javascript"> <span class="built_in">console</span>.log(oDiv.children);            <span class="comment">//HTMLCollection(3)</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"> <span class="built_in">console</span>.log(oDiv.firstChild);          <span class="comment">//#text</span></span></span><br><span class="line"><span class="javascript"> <span class="built_in">console</span>.log(oDiv.firstElementChild);   <span class="comment">//&lt;span&gt;我是spanA&lt;/span&gt;</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"> <span class="built_in">console</span>.log(oDiv.lastChild);           <span class="comment">//#text</span></span></span><br><span class="line"><span class="javascript"> <span class="built_in">console</span>.log(oDiv.lastElementChild);    <span class="comment">//&lt;span&gt;我是spanC&lt;/span&gt;</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"> <span class="comment">/*03-对比兄弟节点和兄弟元素*/</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> oSpan = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"span-class"</span>)[<span class="number">0</span>];</span></span><br><span class="line"><span class="javascript"> <span class="built_in">console</span>.log(oSpan.previousSibling);          <span class="comment">//#text</span></span></span><br><span class="line"><span class="javascript"> <span class="built_in">console</span>.log(oSpan.previousElementSibling);   <span class="comment">//&lt;span&gt;我是spanA&lt;/span&gt;</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"> <span class="built_in">console</span>.log(oSpan.nextSibling);              <span class="comment">//我是div标签的文本</span></span></span><br><span class="line"><span class="javascript"> <span class="built_in">console</span>.log(oSpan.nextElementSibling);       <span class="comment">//&lt;span&gt;我是spanC&lt;/span&gt;</span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p><strong>说明</strong> 上面代码中简单介绍了基于节点关系来操作标签的代码，我们能看到的是DOM它为我们提供了两套方法，分别是基于<code>所有node类型</code>的方法和基于<code>ElementNode类型</code>的方法，在开发中具体使用的时候后者居多，且因为我们在操作的时候得到的返回值很多情况下都是<code>伪数组</code>结构，因此直接使用<code>[ ]</code>语法通过下标( <code>索引</code> )方式引用子元素( <code>节点</code> )会更方便些。</p><div class="tip">DOM提供两套节点关系API是因为在<code>IE9-的版本</code>中childNodes属性不会返回文本标签间的空格(文本节点)和其他的浏览器中则会返回，它们的实现存在较大的差异性。DOM标准为规范元素遍历故而新增了<code>firstElementChild</code>、<code>lastElementChild</code>、<code>previousElementSibling</code>、<code>nextElementSibling</code>以及<code>childElementCount</code>这5个API，<code>children</code>的情况类似。</div><p><span style="border:1px solid #ccc;padding:2px 10px;color:#666"> 复制 | 删除 | 检查 | 替换</span></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span>我是spanA<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span>我是spanB<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">  /*</span></span><br><span class="line"><span class="javascript">  * cloneNode()               克隆(复制)节点，接收布尔值参数，<span class="literal">true</span>表示深复制，默认为<span class="literal">false</span>。</span></span><br><span class="line"><span class="undefined">  * hasChildNodes()           判断当前节点是否拥有子节点,返回布尔值。</span></span><br><span class="line"><span class="undefined">  * removeChild(ele)          删除（并返回）当前节点指定子节点ele</span></span><br><span class="line"><span class="javascript">  * replaceChild(<span class="keyword">new</span>,old)     使用新的节点来替换旧的子节点   </span></span><br><span class="line"><span class="undefined">  */</span></span><br><span class="line"><span class="undefined">  </span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> oDiv  = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"box"</span>)[<span class="number">0</span>];</span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(oDiv.hasChildNodes());              <span class="comment">//true 检查div标签是否存在子节点</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> oSpanA = oDiv.children[<span class="number">0</span>];                  <span class="comment">//获取spanA标签</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> oSpanB = oDiv.children[<span class="number">1</span>];                  <span class="comment">//获取spanB标签</span></span></span><br><span class="line"><span class="javascript">  oDiv.appendChild(oSpanA.cloneNode(<span class="literal">true</span>));       <span class="comment">//复制spanA标签并插入到div标签末尾</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(oDiv.removeChild(oSpanB));          <span class="comment">//&lt;span&gt;我是spanB&lt;/span&gt;</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(oSpanA.hasChildNodes());            <span class="comment">//true  检查spanA是否存在子节点</span></span></span><br><span class="line"><span class="javascript">  oSpanA.replaceChild(oSpanB,oSpanA.firstChild);  <span class="comment">//替换操作</span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p><span style="border:1px solid #ccc;padding:2px 10px;color:#666"> CSS样式相关的操作 </span></p><p>如果要通过JavaScript代码来操作标签的样式，可以在获取指定的DOM标签后直接通过style属性来获取和设置。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.box</span>&#123;<span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#0f0f0f</span>;<span class="attribute">padding</span>: <span class="number">10px</span>&#125;</span></span><br><span class="line"><span class="undefined">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span> <span class="attr">style</span>=<span class="string">"background: #efefef"</span>&gt;</span>凉风有信，秋月无边<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> oDiv = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"box"</span>)[<span class="number">0</span>];</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*A 操作标签的内联样式*/</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*01-读取标签的样式*/</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(oDiv.style.background);                 <span class="comment">//rgb(239, 239, 239)</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(oDiv.style.border);                     <span class="comment">//" "</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*02-设置标签的样式*/</span></span></span><br><span class="line"><span class="javascript">  oDiv.style.color = <span class="string">"red"</span>;                           <span class="comment">//设置标签内文字颜色(前景色)</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*B 操作标签的样式(包括内联样式)*/</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(<span class="built_in">window</span>.getComputedStyle(oDiv).border);  <span class="comment">//1px solid rgb(15, 15, 15)</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(<span class="built_in">window</span>.getComputedStyle(oDiv).color);   <span class="comment">//rgb(255, 0, 0)</span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p><strong>说明</strong> 在上面代码中我们用到了<code>getComputedStyle(ele,pseudo)</code>方法来获取元素的样式，其中<code>ele</code>表示要获取样式的元素，而<code>pseudo</code>参数是一个可选的伪元素样式字符串。此外，该方法在<code>IE8-</code>中存在兼容性问题，可以使用<code>currentStyle</code>处理兼容处理。</p><div class="titleX"><strong>属性和属性节点</strong></div><blockquote><p>实话说<code>属性和属性节点</code>这是一对很难描述清楚的概念，因此我将在接下来章节花很多心思来重点讲解它们并对对比。需要明确的是它们完全是两个不同的概念，只是大多数人在大多数情况下总是把它们混为一谈，甚至搞不清楚所以然，所以就有了这么一个章节。</p></blockquote><p><strong>属性</strong> 我们把变量封装到对象中就成了属性。因此在讨论属性的时候，必须先把对象的问题搞清楚，因为<code>所谓属性只能是某个对象的属性</code>。那谁是对象呢？其实我们在讨论DOM的时候，DOM树的每个<code>node节点</code>都是对象。对象的特点是什么? 对象是键值对的集合，以<code>key-value</code>的特定形式展示，对象是有类型的，譬如Object类型的对象、Array类型的数组对象等。如何检测对象的类型？可以通过<code>typeof</code>关键字查看其返回值是否是<code>object</code>,也可以直接调用<code>Object.prototype.toString()</code>方法来认祖归宗，确认其真实类型。</p><p>那么，请看DOM节点的对象特征。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span> <span class="attr">title</span>=<span class="string">"我是标题"</span> <span class="attr">xxx</span>=<span class="string">"我是xxx"</span>&gt;</span>我是div<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> oDiv = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"box"</span>)[<span class="number">0</span>];</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> obj  = &#123;<span class="attr">name</span>:<span class="string">"文顶顶"</span>,<span class="attr">age</span>:<span class="number">18</span>&#125;,arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*01-检查对象类型-typeof*/</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(<span class="keyword">typeof</span> obj,<span class="keyword">typeof</span> arr, <span class="keyword">typeof</span> oDiv);  <span class="comment">//object object object</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*02-检查对象类型-toString()   返回值 [对象类型  构造函数]*/</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(&#123;&#125;.toString.call(obj));               <span class="comment">//[object Object]</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(&#123;&#125;.toString.call(arr));               <span class="comment">//[object Array]</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(&#123;&#125;.toString.call(oDiv));              <span class="comment">//[object HTMLDivElement]</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*03-对象的访问 增删改查操作*/</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(oDiv.wendingding);                    <span class="comment">//undefined</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*03-A 添加*/</span></span></span><br><span class="line"><span class="javascript">  oDiv.wendingding = <span class="string">"文顶顶"</span>;                       <span class="comment">//增加wendingding属性</span></span></span><br><span class="line"><span class="javascript">  oDiv.name     = <span class="string">"测试的名字"</span>;                       <span class="comment">//增加logName属性</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*03-B 查询*/</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(oDiv.wendingding);                    <span class="comment">//"文顶顶"</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*03-C 修改*/</span></span></span><br><span class="line"><span class="javascript">  oDiv.wendingding = <span class="string">"光头强"</span>;</span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(oDiv.wendingding);                    <span class="comment">//光头强</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*03-D 删除*/</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(<span class="keyword">delete</span> oDiv.wendingding);             <span class="comment">//true</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(oDiv.wendingding);                    <span class="comment">//undefined</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*03-E 在div对象身上添加并调用方法*/</span></span></span><br><span class="line"><span class="javascript">  oDiv.logName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(<span class="string">"logName() =&gt; "</span> + <span class="keyword">this</span>.name);</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="javascript">  oDiv.logName();                                   <span class="comment">//"logName() =&gt;测试的名字"</span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>看到这儿，我想你已经清楚了事实。<br>需要说明的是，通常我们在开发中很少会像上面这样来进行操作，而且上面代码中的<code>name</code>、<code>logName</code>以及<code>wendingding</code>均不会出现在div的标签结构中，而是作为对象的属性和方法直接保存。下面简单列出在DOM对象上常用的属性。<br> <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">tagName      获取元素元素的标签名</span><br><span class="line">id           设置/获取元素id属性</span><br><span class="line">name         设置/获取元素name属性</span><br><span class="line">style        设置/获取元素的内联样式</span><br><span class="line">className    设置/获取元素的class属性</span><br><span class="line">innerHTML    设置/获取元素的内容（包含html代码）</span><br><span class="line">outerHTML    设置或获取元素及其内容（包含html代码）</span><br><span class="line">innerText    设置或获取位于元素标签内的文本</span><br><span class="line">outerText    设置(包括标签)或获取(不包括标签)元素的文本</span><br><span class="line"></span><br><span class="line">offsetTop    当前元素离<span class="tag">&lt;<span class="name">定位父级</span>&gt;</span>元素顶部的距离(如果没定位的父级，则相对于根元素html的距离)</span><br><span class="line">offsetLeft   当前元素离<span class="tag">&lt;<span class="name">定位父级</span>&gt;</span>元素左边的距离(如果没定位的父级，则相对于根元素html的距离)</span><br><span class="line">offsetWidth  当前元素的宽度（border + padding + content）</span><br><span class="line">offsetHeight 当前元素的高度（border + padding + content）</span><br></pre></td></tr></table></figure></p><p><strong>属性节点</strong> 的内容和我上文介绍的概念保持一致，我们可以下面的示例图来进行区分。</p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/js_base43.png?raw=true"></p><div class="tip"><strong>属性节点</strong>区别于<strong>属性</strong>，它们被保存在元素节点( <code>标签</code> )对象的<code>attributes属性下</code>，该属性对应的是一个对象，里面保存着属性节点的键值对(<code>key-value</code>)信息。</div> <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span> <span class="attr">title</span>=<span class="string">"我是标题"</span> <span class="attr">xxx</span>=<span class="string">"我是xxx"</span>&gt;</span>我是div<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*属性节点的相关操作*/</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> oDiv = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"box"</span>)[<span class="number">0</span>];</span></span><br><span class="line"><span class="undefined">  </span></span><br><span class="line"><span class="javascript">  <span class="comment">/*01-获取所有的属性节点*/</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(oDiv.attributes);             <span class="comment">//NamedNodeMap["class","title","xxx"]</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*02-属性节点的访问*/</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*02-A 查询*/</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(oDiv.getAttribute(<span class="string">"class"</span>));  <span class="comment">//"box"</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(oDiv.getAttribute(<span class="string">"xxx"</span>));    <span class="comment">//"我是标题"</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(oDiv.getAttribute(<span class="string">"title"</span>));  <span class="comment">//"我是xxx"</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*02-B 添加*/</span></span></span><br><span class="line"><span class="javascript">  oDiv.setAttribute(<span class="string">"test"</span>,<span class="string">"test对应的值"</span>);</span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(oDiv.getAttribute(<span class="string">"test"</span>));   <span class="comment">// "test对应的值"</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*02-C 修改*/</span></span></span><br><span class="line"><span class="javascript">  oDiv.setAttribute(<span class="string">"xxx"</span>,<span class="string">"阿鲁巴"</span>);</span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(oDiv.getAttribute(<span class="string">"xxx"</span>));    <span class="comment">//"阿鲁巴"</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(oDiv[<span class="string">"xxx"</span>]);                 <span class="comment">//undefined 注意：自定义的属性节点不支持这样访问</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*02-D 删除*/</span></span></span><br><span class="line"><span class="javascript">  oDiv.removeAttribute(<span class="string">"xxx"</span>)               <span class="comment">//删除标签中的"xxx"属性节点</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(oDiv.getAttribute(<span class="string">"xxx"</span>));    <span class="comment">//null</span></span></span><br><span class="line"><span class="undefined">  </span></span><br><span class="line"><span class="undefined">  /*备注</span></span><br><span class="line"><span class="javascript">  * 创建属性节点 <span class="keyword">var</span> attr = createAttribute(attr-key); </span></span><br><span class="line"><span class="undefined">  * 设置属性节点 attr.value = attr-value; ele.setAttributeNode(attr)</span></span><br><span class="line"><span class="undefined">  * 获取属性节点 </span></span><br><span class="line"><span class="undefined">  * [1] ele.attributes[attr-key].value</span></span><br><span class="line"><span class="undefined">  * [2] ele.getAttributeNode[attr-key].value</span></span><br><span class="line"><span class="undefined">  * [3] ele.getAttribute(attr-key)</span></span><br><span class="line"><span class="undefined">  * */</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上面代码中展示了操作属性节点的相关方法，当然除了这些方法外，其实我们还可以通过<code>attributes</code>的方法来对它们进行操作，标签的<code>attributes</code>属性对应的是一个<code>NamesNodeMap</code>类型的对象，它本质上同 NodeList 和 HTMLCollection 类型一样，是一个动态的集合。需说明的是，虽然标签的attributes属性提供了<code>getNameItem( )</code>、<code>removeNameItem( )</code>、<code>setNameItem( )</code>以及<code>item( )</code>等方法也能操作属性节点，但是因为操作不是很方便因此很少使用。</p><div class="tip">关于属性和属性节点，在著名的<a href="http://jquery.com/" target="_blank" rel="noopener"> jQuery </a>框架中封装了两对方法来分别进行处理，其中<code>prop()和removeProp()</code>方法专门用于对属性进行操作，而<code>attr()和removeAttr()</code>方法则用于操作属性节点。此外，对DOM对象而言，有时候我们也可以直接通过属性来操作属性节点(如<code>id、value 和 className</code>等)，可以认为这是为方便操作而提供的<code>天桥</code>。虽然在写代码时能快速安全的完成功能即可，但有些时候能够正确的区分对象属性和属性节点是意义重大的。</div><p>通常，标签身上的标准属性节点都会有一个与之对应的属性，譬如<code>id</code>和<code>class</code>( 对应className )等，但非标准的属性节点则并非如此。另外，HTML5标准建议我们在给标签(<code>ElementNode</code>)添加非标准属性的时候总是添加<code>data-前缀</code>，用于说明这些这些非标准属性提供的是与渲染无关的信息。在使用<code>data-</code>前缀的方式给标签添加了自定义属性后，我们可以通过标签的<code>dataset</code>属性来访问它们，该属性是一个<code>DOMStringMap</code>的实例对象，维护着一个<code>key-value</code>的映射。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*&lt;idv id="myDiv" data-info="信息" data-index="2"&gt;&lt;/idv&gt;*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*00-获取页面中指定的div标签*/</span></span><br><span class="line"><span class="keyword">var</span> oDiv = <span class="built_in">document</span>.getElementById(<span class="string">"myDiv"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*01-读取自定义属性节点的值*/</span></span><br><span class="line"><span class="built_in">console</span>.log(oDiv.dataset);        <span class="comment">//DOMStringMap &#123;index: "2",info: "信息"&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(oDiv.dataset.index);  <span class="comment">//2</span></span><br><span class="line"><span class="built_in">console</span>.log(oDiv.dataset.info);   <span class="comment">//"信息"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*02-设置|修改自定义属性节点的值*/</span></span><br><span class="line">oDiv.dataset.index = <span class="number">10</span>;          <span class="comment">//修改</span></span><br><span class="line">oDiv.dataset.des   = <span class="string">"描述信息"</span>;</span><br><span class="line"><span class="comment">/*&lt;idv id="myDiv" data-info="信息" data-index="10" data-des='描述信息'&gt;&lt;/idv&gt;*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*03-其他操作属性节点的方式(对比)*/</span></span><br><span class="line"><span class="comment">/*03-A getAttribute()*/</span></span><br><span class="line"><span class="built_in">console</span>.log(oDiv.getAttribute(<span class="string">"info"</span>));         <span class="comment">//null  注意不能生了data-前缀</span></span><br><span class="line"><span class="built_in">console</span>.log(oDiv.getAttribute(<span class="string">"data-info"</span>));    <span class="comment">//"信息"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*03-B attributes*/</span></span><br><span class="line"><span class="comment">/*说明：使用nodeName和name可以访问属性名，使用nodeValue和value访问属性值*/</span></span><br><span class="line"><span class="built_in">console</span>.log(oDiv.attributes.getNamedItem(<span class="string">"data-info"</span>).nodeName); <span class="comment">//"data-info"</span></span><br><span class="line"><span class="built_in">console</span>.log(oDiv.attributes.getNamedItem(<span class="string">"data-info"</span>).nodeValue);<span class="comment">//"信息"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*03-C getAttributeNode()*/</span></span><br><span class="line"><span class="built_in">console</span>.log(oDiv.getAttributeNode(<span class="string">"data-info"</span>));                 <span class="comment">//data-info="信息"</span></span><br><span class="line"><span class="built_in">console</span>.log(oDiv.getAttributeNode(<span class="string">"data-info"</span>).name);            <span class="comment">//data-info</span></span><br><span class="line"><span class="built_in">console</span>.log(oDiv.getAttributeNode(<span class="string">"data-info"</span>).value);           <span class="comment">//信息</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*04-补充：获取元素所有属性节点名称数组*/</span></span><br><span class="line"><span class="built_in">console</span>.log(oDiv.getAttributeNames());  <span class="comment">//["id", "data-info", "data-index", "data-des"]</span></span><br></pre></td></tr></table></figure><p><strong>classList</strong> HTML5新增了一种操作元素类名的方式，即给每个标签都提供<code>classList属性</code>，该属性的值是<code>DOMTokenList</code>类型的实例，通过该属性来操作标签的类名更简单也更安全。<code>classList</code>实例对象拥有<code>add()</code>、<code>contains()</code>、<code>remove()</code>和<code>toggle()</code>等方法来操作具体的class，如果要访问某个具体的class当然也可以通过<code>[ ]</code>语法或者是<code>item( index )</code>。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*&lt;div class="box test active" id="divDemo"&gt;&lt;/div&gt;*/</span></span><br><span class="line"><span class="comment">/*00-获取页面中指定的元素*/</span></span><br><span class="line"><span class="keyword">var</span> oDiv = <span class="built_in">document</span>.getElementById(<span class="string">"divDemo"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(oDiv.classList);            <span class="comment">//DOMTokenList(3) ["box", "test", "active"]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*01-读取元素的class*/</span></span><br><span class="line"><span class="comment">/*[ ]语法来读取指定的class*/</span></span><br><span class="line"><span class="built_in">console</span>.log(oDiv.classList[<span class="number">0</span>]);         <span class="comment">//"box"</span></span><br><span class="line"><span class="comment">/*item(index)方法来读取指定的class*/</span></span><br><span class="line"><span class="built_in">console</span>.log(oDiv.classList.item(<span class="number">1</span>));    <span class="comment">//"test"</span></span><br><span class="line"><span class="comment">/*使用className属性来读取元素的全部class*/</span></span><br><span class="line"><span class="built_in">console</span>.log(oDiv.className);            <span class="comment">//box test active</span></span><br><span class="line"><span class="built_in">console</span>.log(oDiv.className.split(<span class="string">" "</span>)); <span class="comment">//["box", "test", "active"]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*02-添加class*/</span></span><br><span class="line">oDiv.classList.add(<span class="string">"box"</span>);              <span class="comment">//如class已经存在则不做任何处理</span></span><br><span class="line">oDiv.classList.add(<span class="string">"test2"</span>);            <span class="comment">//若class尚不存在则添加</span></span><br><span class="line"><span class="comment">/*&lt;div class="box test active test2" id="divDemo"&gt;&lt;/div&gt;*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*03-检查是否存在指定的class,如果存在那么就返回true,否则返回false*/</span></span><br><span class="line"><span class="built_in">console</span>.log(oDiv.classList.contains(<span class="string">"box"</span>));    <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(oDiv.classList.contains(<span class="string">"haha"</span>));   <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*04-删除class*/</span></span><br><span class="line">oDiv.classList.remove(<span class="string">"test"</span>);</span><br><span class="line"><span class="comment">/*05-切换class 如果存在那么就删除，否则就添加*/</span></span><br><span class="line">oDiv.classList.toggle(<span class="string">"box"</span>);                   <span class="comment">//删除</span></span><br><span class="line">oDiv.classList.toggle(<span class="string">"box2"</span>);                  <span class="comment">//添加</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*&lt;div class="active test2 box2" id="divDemo"&gt;&lt;/div&gt;*/</span></span><br></pre></td></tr></table></figure><h3 id="4-0-案例"><a href="#4-0-案例" class="headerlink" title="4.0 案例"></a>4.0 案例</h3><p><strong>案例</strong> 动态创建表格并设置隔行变色<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">table&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">border</span><span class="selector-pseudo">:1px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ddd</span>;</span></span><br><span class="line"><span class="undefined">border-collapse: collapse;</span></span><br><span class="line"><span class="css"><span class="selector-tag">width</span><span class="selector-pseudo">:100</span>%;</span></span><br><span class="line"><span class="undefined">margin-top: 20px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">td&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">border</span><span class="selector-pseudo">:1px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ddd</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">padding</span><span class="selector-pseudo">:3px</span> 5<span class="selector-tag">px</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.odd</span>&#123;<span class="attribute">background-color</span>: <span class="number">#199</span>;&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"row"</span>&gt;</span>请输入行数：<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"col"</span>&gt;</span>请输入列数：<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"col"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn"</span>&gt;</span>动态生成表格<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"output"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*00-监听页面的加载*/</span></span></span><br><span class="line"><span class="javascript"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*01-获取页面中指定的元素*/</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> oRow   = <span class="built_in">document</span>.getElementById(<span class="string">'row'</span>);</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> oCol   = <span class="built_in">document</span>.getElementById(<span class="string">'col'</span>);</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> oOutput     = <span class="built_in">document</span>.getElementById(<span class="string">'output'</span>);</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> oBtn   = output.previousElementSibling;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*02-注册按钮的点击事件*/</span></span></span><br><span class="line"><span class="javascript">  oBtn.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript"><span class="comment">/*03-获取用户输入的行-列信息*/</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> _row = oRow.value,_col = oCol.value;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="comment">/*04-创建表格标签*/</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> table = <span class="built_in">document</span>.createElement(<span class="string">'table'</span>);</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> tbody = <span class="built_in">document</span>.createElement(<span class="string">'tbody'</span>);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="comment">/*05-根据行数来动态的创建tr标签并添加到tbody标签中*/</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;_row;i++)&#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> tr = <span class="built_in">document</span>.createElement(<span class="string">'tr'</span>);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*设置隔行换色*/</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">if</span>(i%<span class="number">2</span> === <span class="number">0</span>) tr.className = <span class="string">'odd'</span>;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">  tbody.appendChild(tr);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*06-根据列数来动态创建rd标签并添加到tr标签中*/</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">for</span>(<span class="keyword">var</span> j=<span class="number">0</span>;j&lt;_col;j++)&#123;</span></span><br><span class="line"><span class="javascript"> <span class="keyword">var</span> td = <span class="built_in">document</span>.createElement(<span class="string">'td'</span>);</span></span><br><span class="line"><span class="javascript"> td.innerHTML = <span class="string">'单元格 - '</span> + i + j;</span></span><br><span class="line"><span class="undefined"> tr.appendChild(td);</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="comment">/*07-把表格插入到页面中显示出来*/</span></span></span><br><span class="line"><span class="undefined">table.appendChild(tbody);</span></span><br><span class="line"><span class="javascript">oOutput.innerHTML = <span class="string">''</span>;       <span class="comment">// 添加前先清空#output</span></span></span><br><span class="line"><span class="undefined">oOutput.appendChild(table);</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/js_base42.png?raw=true"></p><h3 id="5-0-附录"><a href="#5-0-附录" class="headerlink" title="5.0 附录"></a>5.0 附录</h3><p><strong>Node（节点）的属性和方法</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">------------------------</span><br><span class="line">####  Node节点的主要属性</span><br><span class="line">------------------------</span><br><span class="line"></span><br><span class="line">baseURI    <span class="comment">// 当前网页的绝对路径</span></span><br><span class="line">children  <span class="comment">// 指定节点的所有Element子节点</span></span><br><span class="line">childNodes           <span class="comment">// 当前节点的所有子节点</span></span><br><span class="line">childElementCount          <span class="comment">// 当前节点所有Element子节点的数量</span></span><br><span class="line"></span><br><span class="line">nodeName   <span class="comment">// 节点名称[只读]</span></span><br><span class="line">nodeType   <span class="comment">// 节点类型的常数值[只读]</span></span><br><span class="line">nodeValue  <span class="comment">// Text或Comment节点的文本值[只读]</span></span><br><span class="line">innerText<span class="comment">// 节点的文本内容</span></span><br><span class="line">nextSibling          <span class="comment">// 紧跟在当前节点后面的第一个兄弟节点</span></span><br><span class="line">isConnected<span class="comment">// 布尔类型的值，用于检查当前节点与DOM树是否连接[只读]</span></span><br><span class="line">textContent          <span class="comment">// 当前节点和它的所有后代节点的文本内容</span></span><br><span class="line">ownerDocument          <span class="comment">// 当前节点所在的顶层文档对象，即Document</span></span><br><span class="line"></span><br><span class="line">previousSibling          <span class="comment">// 当前节点的前一个兄弟节点</span></span><br><span class="line">parentNode           <span class="comment">// 当前节点的父节点</span></span><br><span class="line">parentElement          <span class="comment">// 当前节点的父Element节点</span></span><br><span class="line">firstChild          <span class="comment">// 当前节点的第一个子节点</span></span><br><span class="line">firstElementChild          <span class="comment">// 当前节点的第一个Element子节点</span></span><br><span class="line">lastChild           <span class="comment">// 当前节点的最后一个子节点</span></span><br><span class="line">lastElementChild           <span class="comment">// 当前节点的最后一个Element子节点</span></span><br><span class="line"></span><br><span class="line">------------------------</span><br><span class="line">####  Node节点的主要方法</span><br><span class="line">------------------------</span><br><span class="line"></span><br><span class="line">cloneNode(<span class="keyword">true</span>);  <span class="comment">// 克隆节点，参数传递布尔类型的值（默认为false）</span></span><br><span class="line">hasChildNodes()   <span class="comment">// 布尔类型的值，表示当前节点是否有子节点</span></span><br><span class="line">appendChild(node)           <span class="comment">// 追加新的节点到当前节点中（插入后作为最后一个节点）</span></span><br><span class="line">removeChild(node)  <span class="comment">// 删除指定的子节点</span></span><br><span class="line">isEqualNode(noe)  <span class="comment">// 布尔类型的值，用于检查两个节点是否（完全）相等</span></span><br><span class="line">contains(node)  <span class="comment">// 布尔类型的值，用于判断参数节点是否为当前节点的后代节点</span></span><br><span class="line">normalize()   <span class="comment">// 清理当前节点内的所有Text节点，将去除空的文本节点并合并文本。</span></span><br><span class="line"></span><br><span class="line">insertBefore(newNode,oldNode)  <span class="comment">// 在指定子节点之前插入新的子节点</span></span><br><span class="line">replaceChild(newChild,oldChild) <span class="comment">// 替换节点</span></span><br><span class="line">compareDocumentPosition(node)   <span class="comment">// 比较当前节点与指定节点的位置关系，返回不同的掩码。</span></span><br><span class="line"></span><br><span class="line">------------------------</span><br><span class="line">####  ChildNode相关的方法</span><br><span class="line">------------------------</span><br><span class="line"></span><br><span class="line">ChildNode.replace()         <span class="comment">// 替换节点</span></span><br><span class="line">ChildNode.remove()          <span class="comment">// 将ChildNode从其父节点的子节点列表中移除</span></span><br><span class="line">ChildNode.before()          <span class="comment">// 在当前标签(节点)的前面插入新的节点</span></span><br><span class="line">ChildNode.after()           <span class="comment">// 在当前标签(节点)的后面插入新的节点</span></span><br></pre></td></tr></table></figure></p><p><strong>Element（元素节点）的属性和方法</strong></p><p><div class="tip">元素节点继承了Node的所有属性和方法，Element本身也作为通用的基类来使用。</div>下面列出元素节点的主要属性和方法，如果没有特别标注为[读写]的，那么默认为只读。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">------------------------</span><br><span class="line">####  Element主要的属性</span><br><span class="line">------------------------</span><br><span class="line"></span><br><span class="line">id  <span class="comment">// 指定元素的id属性[读写]</span></span><br><span class="line">attributes          <span class="comment">// 指定元素节点相关的所有属性集合(映射)</span></span><br><span class="line">tagName  <span class="comment">// 指定元素节点的标签名（大写）</span></span><br><span class="line">innerHTML           <span class="comment">// 指定元素节点包含的节点内容[读写]，区别于innerText</span></span><br><span class="line">outerHTML  <span class="comment">// 指定元素节点的所有HTML代码，包括它自身和包含的的所有子元素[读写]</span></span><br><span class="line">className  <span class="comment">// 元素节点的class属性值[读写]</span></span><br><span class="line">classList  <span class="comment">// 元素节点所有的class属性。</span></span><br><span class="line">dataset   <span class="comment">// 元素节点中所有的data-*属性。</span></span><br><span class="line">localName<span class="comment">// 元素名称本地化的结果</span></span><br><span class="line">clientTop           <span class="comment">// 元素节点距离它顶部边界的高度</span></span><br><span class="line">clientLeft           <span class="comment">// 元素节点距离它左边界的宽度</span></span><br><span class="line">clientHeight           <span class="comment">// 元素节点内部(相对于外层元素)的高度</span></span><br><span class="line">clientWidth           <span class="comment">// 元素节点内部(相对于外层元素)的宽度</span></span><br><span class="line"></span><br><span class="line">style  <span class="comment">// 元素节点的行内样式</span></span><br><span class="line">scrollHeight          <span class="comment">// 元素节点滚动视图的高度</span></span><br><span class="line">scrollWidth          <span class="comment">// 元素节点滚动视图的宽度</span></span><br><span class="line">scrollLeft           <span class="comment">// 元素节点横向滚动条距离左端的位移[读写]</span></span><br><span class="line">scrollTop           <span class="comment">// 元素节点纵向滚动条距离顶部的位移[读写]</span></span><br><span class="line">offsetHeight           <span class="comment">// 元素节点相对于版面或由父坐标 offsetParent 指定的父坐标的高度</span></span><br><span class="line">offsetWidth            <span class="comment">// 元素节点相对于版面或由父坐标 offsetParent指定的父坐标的宽度</span></span><br><span class="line">offsetLeft            <span class="comment">// 元素节点相对于版面或由父坐标 offsetParent指定的父坐标的左侧位移</span></span><br><span class="line">offsetTop           <span class="comment">// 元素节点相对于版面或由父坐标 offsetParent指定的父坐标的顶部位移</span></span><br><span class="line"></span><br><span class="line">firstElementChild<span class="comment">// 获取元素节点的第一个子元素</span></span><br><span class="line">lastElementChild <span class="comment">// 获取元素节点的最后一个子元素</span></span><br><span class="line">nextElementSibling <span class="comment">// 获取元素节点的下一个兄弟节点</span></span><br><span class="line">previousElementSibling        <span class="comment">// 获取元素节点的上一个兄弟节点</span></span><br><span class="line"></span><br><span class="line">------------------------</span><br><span class="line">####  Element主要的方法</span><br><span class="line">------------------------</span><br><span class="line"></span><br><span class="line">[⦿] 操作属性节点相关的方法</span><br><span class="line">getAttribute()<span class="comment">// 读取指定属性</span></span><br><span class="line">setAttribute()<span class="comment">// 设置指定属性</span></span><br><span class="line">hasAttribute()<span class="comment">// 返回布尔类型的值，检查当前元素节点中是否有指定的属性</span></span><br><span class="line">removeAttribute()<span class="comment">// 移除指定属性</span></span><br><span class="line"></span><br><span class="line">[⦿] 选择器相关方法</span><br><span class="line">querySelector()  <span class="comment">// 根据参数获取选中的所有标签中的第一个返回</span></span><br><span class="line">querySelectorAll()          <span class="comment">// 根据参数获取选中的所有标签返回</span></span><br><span class="line">getElementsByTagName()          <span class="comment">// 根据标签名来获取指定的标签返回</span></span><br><span class="line">getElementsByClassName()        <span class="comment">// 根据class的名称来获取指定的标签返回</span></span><br><span class="line"></span><br><span class="line">[⦿] 事件相关方法</span><br><span class="line">addEventListener()<span class="comment">// 添加事件监听的回调函数</span></span><br><span class="line">removeEventListener()        <span class="comment">// 移除事件监听函数</span></span><br><span class="line">dispatchEvent()<span class="comment">// 触发事件</span></span><br><span class="line">attachEvent()<span class="comment">// 添加事件监听的回调函数(IE 9-)</span></span><br><span class="line">detachEvent()                   <span class="comment">// 移除事件监听函数（IE 9-）</span></span><br><span class="line">insertAdjacentHTML()        <span class="comment">// 指定的文本解析为HTML或XML，并将结果节点插入到DOM树中的指定位置</span></span><br></pre></td></tr></table></figure><p><strong>Document（文档）的属性和方法</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">------------------------</span><br><span class="line">####  Document的主要属性</span><br><span class="line">------------------------</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.body   <span class="comment">// 当前文档的&lt;body&gt;节点</span></span><br><span class="line"><span class="built_in">document</span>.head   <span class="comment">// 当前文档的&lt;head&gt;节点</span></span><br><span class="line"><span class="built_in">document</span>.defaultView           <span class="comment">// 当前文档对象所在的window对象</span></span><br><span class="line"><span class="built_in">document</span>.doctype   <span class="comment">// 当前文档关联的文档类型定义(DTD)</span></span><br><span class="line"><span class="built_in">document</span>.documentElement                <span class="comment">// 当前文档的根节点</span></span><br><span class="line"><span class="built_in">document</span>.activeElement          <span class="comment">// 当前文档中获得焦点的那个元素。</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.links  <span class="comment">// 当前文档的所有连接集合</span></span><br><span class="line"><span class="built_in">document</span>.forms  <span class="comment">// 页面中所有表单元素的集合</span></span><br><span class="line"><span class="built_in">document</span>.images  <span class="comment">// 页面中所有图片元素的集合</span></span><br><span class="line"><span class="built_in">document</span>.embeds  <span class="comment">// 网页中所有嵌入对象的集合</span></span><br><span class="line"><span class="built_in">document</span>.scripts  <span class="comment">// 当前文档的所有脚本的集合</span></span><br><span class="line"><span class="built_in">document</span>.styleSheets          <span class="comment">// 当前网页的所有样式表的集合</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.URL  <span class="comment">// 当前文档的URL地址</span></span><br><span class="line"><span class="built_in">document</span>.cookie   <span class="comment">// 用来操作Cookie[读写]</span></span><br><span class="line"><span class="built_in">document</span>.title    <span class="comment">// 当前文档的标题</span></span><br><span class="line"><span class="built_in">document</span>.domain  <span class="comment">// 当前文档的域名</span></span><br><span class="line"><span class="built_in">document</span>.referrer  <span class="comment">// 当前文档的访问来源</span></span><br><span class="line"><span class="built_in">document</span>.location  <span class="comment">// 获取location对象，提供与URL相关的信息</span></span><br><span class="line"><span class="built_in">document</span>.readyState          <span class="comment">// 当前文档的状态</span></span><br><span class="line"><span class="built_in">document</span>.designMode          <span class="comment">// 控制当前文档是否可编辑[读写]</span></span><br><span class="line"><span class="built_in">document</span>.compatMode          <span class="comment">// 返回浏览器处理文档的模式</span></span><br><span class="line"><span class="built_in">document</span>.documentURI          <span class="comment">// 当前文档的URI地址</span></span><br><span class="line"><span class="built_in">document</span>.lastModified          <span class="comment">// 当前文档最后修改的时间戳</span></span><br><span class="line"><span class="built_in">document</span>.characterSet                   <span class="comment">// 当前文档的字符集，比如UTF-8等</span></span><br><span class="line"></span><br><span class="line">------------------------</span><br><span class="line">####  Document的主要方法</span><br><span class="line">------------------------</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.open()           <span class="comment">// 用于新建并打开一个文档</span></span><br><span class="line"><span class="built_in">document</span>.close()           <span class="comment">// 不安比open方法所新建的文档</span></span><br><span class="line"><span class="built_in">document</span>.write()           <span class="comment">// 用于向当前文档写入内容</span></span><br><span class="line"><span class="built_in">document</span>.writeIn()                  <span class="comment">// 用于向当前文档写入内容，尾部添加换行符</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.createEvent(type)   <span class="comment">// 创建事件对象</span></span><br><span class="line"><span class="built_in">document</span>.addEventListener()  <span class="comment">// 注册事件监听</span></span><br><span class="line"><span class="built_in">document</span>.removeEventListener()  <span class="comment">// 注销事件</span></span><br><span class="line"><span class="built_in">document</span>.dispatchEvent(event)  <span class="comment">// 触发事件</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.createElement(tagName)   <span class="comment">// 创建元素节点</span></span><br><span class="line"><span class="built_in">document</span>.createTextNode(text)     <span class="comment">// 创建文本节点</span></span><br><span class="line"><span class="built_in">document</span>.createAttribute(name)    <span class="comment">// 创建属性节点</span></span><br><span class="line"><span class="built_in">document</span>.createDocumentFragment()       <span class="comment">// 生成一个DocumentFragment对象</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.getElementById(id)           <span class="comment">// 根据id值获取指定ID的元素节点返回</span></span><br><span class="line"><span class="built_in">document</span>.querySelector(selectors)   <span class="comment">// 根据选择器参数获取指定的所有标签中的第一个返回</span></span><br><span class="line"><span class="built_in">document</span>.querySelectorAll(selectors)    <span class="comment">// 根据选择器参数获取指定的所有标签返回</span></span><br><span class="line"><span class="built_in">document</span>.getElementsByTagName(tagName)  <span class="comment">// 根据标签名称获取指定的所有标签返回</span></span><br><span class="line"><span class="built_in">document</span>.getElementsByClassName(className)      <span class="comment">// 根据class名称获取指定的所有标签返回</span></span><br><span class="line"><span class="built_in">document</span>.getElementsByName(name)           <span class="comment">// 根据name获取拥有指定name属性的元素节点返回</span></span><br><span class="line"><span class="built_in">document</span>.elementFromPoint(x,y)         <span class="comment">// 返回位于页面指定位置最上层的Element子节点</span></span><br></pre></td></tr></table></figure></p><hr><ul><li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="noopener">花田半亩</a></li><li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="noopener">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li><li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://github.com/flowerField/Source/blob/master/Blog/tree_02.png?raw=true&quot; height=&quot;250px&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;tip&quot;&gt;本文将详细介绍DOM相关的
      
    
    </summary>
    
    
      <category term="javaScript系列" scheme="https://weibo.com/u/3800117445/tags/javaScript%E7%B3%BB%E5%88%97/"/>
    
  </entry>
  
  <entry>
    <title>javaScript系列 [26]-BOM</title>
    <link href="https://weibo.com/u/3800117445/2019/04/18/javaScript%E7%B3%BB%E5%88%97%20%5B26%5D-BOM/"/>
    <id>https://weibo.com/u/3800117445/2019/04/18/javaScript系列 [26]-BOM/</id>
    <published>2019-04-17T16:22:18.000Z</published>
    <updated>2019-06-11T01:32:07.079Z</updated>
    
    <content type="html"><![CDATA[<div class="tip">本文介绍BOM相关的知识点，介绍的重点在于BOM核心Window对象的成员细节。</div><p class="titleX"><strong>BOM简单介绍</strong></p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/js_base36.png?raw=true" height="100px"></p><p>我们已经知道JavaScript的范围包括<code>ECMAScript(语言核心) + DOM(文档对象模型) + BOM(浏览器对象模型)</code>。</p><p>BOM 是 <a href=""> Browser Object Model（浏览器对象模型）</a>的缩写，它提供了独立于内容 而与浏览器窗口进行交互的对象。由于BOM主要用于管理窗口与窗口之间的通讯，因此其核心对象是window，它表示流浏览器的一个实例。BOM由一系列相关的对象构成，并且每个对象都提供了很多方法与属性，window作为最顶层的对象，BOM中所有的对象都是通过它延伸出来的。</p><p><strong>标准化</strong> JavaScript语法的标准化组织是ECMA，DOM的标准化组织是W3C, 而BOM因为缺乏标准，BOM最初其实是Netscape浏览器标准的一部分，而这也正是各种浏览器不兼容的根源所在。此外需要指出的是，W3C为了把浏览器中JavaScript最基本的部分标准化，已经将BOM的主要方面纳入了HTML5的规范中。</p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/js_base37.png?raw=true"></p><p class="titleX"><strong>window和全局作用域</strong></p><p> 在浏览器中，window对象拥有着双重的角色，它既是通过JavaScript访问浏览器窗口的接口，也是ECMAScript规定中的Global全局对象。因此，所有在全局作用域中声明的变量、函数都会自动成为window对象的属性和方法。</p><p> <span style="border:1px solid #ccc;padding:2px 10px;color:#666">全局作用域</span></p><blockquote><p>✧ 定义在全局环境下的变量和函数都会成为 <code>window</code> 对象的成员(属性和方法)<br>✧ 编码的时候应该尽可能少的使用全局变量，以避免污染全局环境<br>✧ 没有用var声明的变量会成为全局变量，即 <code>window</code> 对象的属性<br>✧ 在编码时<code>window</code> 前缀可以被省略，如 <code>window.console.log()</code> 通常写成 <code>console.log()</code>;</p></blockquote> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*01-全局作用域示例*/</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.age);        <span class="comment">//undefined</span></span><br><span class="line"><span class="keyword">var</span> age = <span class="number">12</span>;</span><br><span class="line"><span class="built_in">console</span>.log(age, <span class="built_in">window</span>.age);   <span class="comment">//12 12  age自动成为window的属性</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.arr);        <span class="comment">//undefined</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="string">"T"</span>];</span><br><span class="line"><span class="built_in">console</span>.log(arr == <span class="built_in">window</span>.arr); <span class="comment">//true</span></span><br><span class="line">arr.push(<span class="string">"V"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.arr);        <span class="comment">//[1,2,3,"T","V"];</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">a,b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(sum(<span class="number">1</span>, <span class="number">2</span>));         <span class="comment">//3</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.sum(<span class="number">1</span>, <span class="number">3</span>));  <span class="comment">//4</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/*02-没有使用var声明的变量默认成为全局变量*/</span></span><br><span class="line">address = <span class="string">"北京市海淀区"</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.address);   <span class="comment">//"北京市海淀区";</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="string">"我是a"</span>;</span><br><span class="line">      b = <span class="string">"我是b"</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">f();                          <span class="comment">/*调用函数f，执行函数体中的代码*/</span></span><br><span class="line"><span class="comment">//console.log(a);             //报错 无法访问变量a 因为a是f函数中的局部变量</span></span><br><span class="line"><span class="built_in">console</span>.log(b);               <span class="comment">//"我是b"  b默认成为全局变量</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.a);        <span class="comment">//undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.b);        <span class="comment">//"我是b"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*03-省略window前缀*/</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.console == <span class="built_in">console</span>);  <span class="comment">//true</span></span><br></pre></td></tr></table></figure><p> 因为全局作用域中声明的所有变量都会自动成为window的属性，而实际的开发中代码量可能是巨大的，且项目可能是由很N多人一起维护的，因此应该尽可能的减少全局变量的数量，以防止污染全局环境。</p><p> 关于这个问题的解决方案可以有两种，一种是根据具体的业务和功能将部分代码<code>封装到匿名函数(闭包)中</code>保持独立性，一种是把很多变量和函数<code>封装到特定的对象中</code>处理。当然，更成熟的方案是使用 <a href="">模块化</a> 的方式来组织项目和代码结构，其实模块化的开发方式也是使用匿名函数封装的一种变形，在这里我们暂不作具体的展开。</p><p><strong>注意</strong> <code>delete</code> 用于删除对象的属性，需注意虽然使用<code>delete</code>关键字可以删除直接定义在 <code>window</code> 上面的属性，但却无法直接删除用 <code>var</code> 声明的全局变量(在严格模式下不能禁止使用 <code>delete</code> 来删除遍历，错误信息为 <span style="color:red"> Uncaught SyntaxError: Delete of an unqualified identifier in strict mode. </span>)。</p> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*测试1：使用delete删除对象的属性*/</span></span><br><span class="line"> <span class="keyword">var</span> obj = &#123;<span class="attr">id</span>:<span class="string">"1001"</span>&#125;;</span><br><span class="line"> <span class="built_in">console</span>.log(<span class="keyword">delete</span> obj.id);           <span class="comment">//true</span></span><br><span class="line"> <span class="built_in">console</span>.log(obj.id);                  <span class="comment">//undefined</span></span><br><span class="line"> </span><br><span class="line"> <span class="comment">/*测试2：使用delete删除全局变量的属性*/</span></span><br><span class="line"> <span class="keyword">var</span> className = <span class="string">'H5-1904'</span>;</span><br><span class="line"> <span class="built_in">console</span>.log(<span class="keyword">delete</span> className);        <span class="comment">//false</span></span><br><span class="line"> <span class="built_in">console</span>.log(className);               <span class="comment">//"H5-1904"</span></span><br><span class="line"> <span class="built_in">console</span>.log(<span class="keyword">delete</span> <span class="built_in">window</span>.className); <span class="comment">//false</span></span><br><span class="line"> <span class="built_in">console</span>.log(<span class="built_in">window</span>.className);        <span class="comment">//"H5-1904"</span></span><br><span class="line"> </span><br><span class="line"> <span class="comment">/*测试3：使用delete删除直接定义在window对象上面的属性*/</span></span><br><span class="line"> <span class="built_in">window</span>.test = <span class="string">"测试的属性"</span>;</span><br><span class="line"> <span class="built_in">console</span>.log(<span class="keyword">delete</span> <span class="built_in">window</span>.test);      <span class="comment">//true</span></span><br><span class="line"> <span class="built_in">console</span>.log(<span class="built_in">window</span>.test);             <span class="comment">//undefined</span></span><br></pre></td></tr></table></figure><p class="titleX"><strong>window核心成员详解</strong></p><p>接下来，我将分门别类的讲解浏览器窗口的大小、滚动、导航、打开、弹窗、位置操作、历史记录以及事件处理等内容，所以这些功能都通过 <code>window</code>的核心成员来提供和实现。</p><p> <img src="https://github.com/flowerField/Source/blob/master/Blog/js_base38.png?raw=true"></p><p> <span style="border:1px solid #ccc;padding:2px 10px;color:#666">window的 location 对象</span></p><p> <code>location</code>对象是window中最有用最重要的对象之一，它提供了与当前窗口中加载的文档有关的信息，而且它非常特殊，它既是<code>window</code>的属性也是<code>document</code>的属性。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">location 对象的主要属性</span><br><span class="line"></span><br><span class="line">hash     设置/返回从井号 (#) 开始的 URL（锚点）==&gt;哈希值。</span><br><span class="line">href     设置/返回完整的 URL。</span><br><span class="line">search   设置/返回从问号 (?) 开始的 URL（参数部分）。</span><br><span class="line">host     服务器名称和端口号</span><br><span class="line">hostname 服务器名称</span><br><span class="line">pathname URL中的目录和文件名</span><br><span class="line">port     返回指定的端口号，如果没有指定则返回空字符串</span><br><span class="line">protocol 返回网络协议</span><br><span class="line"></span><br><span class="line">location 对象的主要方法</span><br><span class="line">assign()            加载新的页面</span><br><span class="line">reload()            重新加载(刷新)</span><br><span class="line">replace(newurl)     使用新的页面来替换当前页面</span><br></pre></td></tr></table></figure></p><p><code>url</code>的组成<code>http://www.baidu.com:10086/api/reg.php?username=zs&amp;password=123&amp;age=18#123</code><br><strong><code>协议</code></strong>：http<br><strong><code>域名</code></strong>：baidu.com<br><strong><code>端口</code></strong>：10086 (默认:80)<br><strong><code>路径</code></strong>：/api/<br><strong><code>参数</code></strong>：username=zs&amp;password=123&amp;age=18<br><strong><code>哈希</code></strong>：#123</p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#666">窗口的主要属性</span></p><p>跨浏览器确定窗口的大小可以使用window的<code>innerWidth</code>、<code>innerHeight</code>、<code>outerWidth</code>和<code>outerHeight</code>四个属性，它们分别对应的是页面视图容器的宽高和浏览器窗口本身的尺寸。需要注意的是，这几个属性存在兼容性问题，在IE8-中需要通过DOM来获取大小信息。</p><blockquote><p><strong>页面视图容器</strong>也称为浏览器的视口(<code>viewport</code>),相比窗口本身来说它不包括工具栏和滚动条。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*01-获取页面可视区域的大小(宽 | 高)*/</span></span><br><span class="line">  <span class="keyword">var</span> w =<span class="built_in">window</span>.innerWidth</span><br><span class="line">      || <span class="built_in">document</span>.documentElement.clientWidth</span><br><span class="line">      || <span class="built_in">document</span>.body.clientWidth;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> h =<span class="built_in">window</span>.innerHeight</span><br><span class="line">      || <span class="built_in">document</span>.documentElement.clientHeight</span><br><span class="line">      || <span class="built_in">document</span>.body.clientHeight;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*兼容IE8-</span></span><br><span class="line"><span class="comment">  * 如果是标准模式则使用document.documentElement.clientWidth，</span></span><br><span class="line"><span class="comment">  * 如果是混杂模式则使用document.body.clientWidth</span></span><br><span class="line"><span class="comment">  * */</span></span><br><span class="line">  <span class="built_in">console</span>.log(w);                 <span class="comment">//877   可视区域的宽度</span></span><br><span class="line">  <span class="built_in">console</span>.log(h);                 <span class="comment">//410   可视区域的高度</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/*02-获取window窗口本身的大小*/</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">window</span>.outerWidth); <span class="comment">//877   窗口的宽度</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">window</span>.outerHeight);<span class="comment">//778   窗口的高度</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/*03-获取滚动条位置相关的信息*/</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">window</span>.scrollX);    <span class="comment">//水平滚动条滚动过的距离（只读）</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">window</span>.scrollY);    <span class="comment">//垂直滚动条滚动过的距离（只读）</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/*04-操作滚动的相关方法*/</span></span><br><span class="line">  <span class="built_in">window</span>.scrollTo(<span class="number">100</span>,<span class="number">100</span>);       <span class="comment">//指定滚动位置</span></span><br><span class="line">  <span class="built_in">window</span>.scrollBy(<span class="number">-100</span>,<span class="number">100</span>);      <span class="comment">//设置基于当前位置的滚动距离</span></span><br></pre></td></tr></table></figure><p><span style="border:1px solid #ccc;padding:2px 10px;color:#666">窗口的打开和关闭</span></p><p><strong><code>语法</code></strong> <code>window.open([ URL ],[ name ],[ features ],[ replace ])</code><br><strong><code>作用</code></strong> <code>open()</code>方法用于打开一个新的浏览器窗口或查找一个已命名的窗口。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 作用：打开新的窗口</span></span><br><span class="line"><span class="comment"> * 语法：window.open(URL,name,features,replace)</span></span><br><span class="line"><span class="comment"> * 参数：</span></span><br><span class="line"><span class="comment"> *   URL   打开指定页面的URL，没有指定则打开空白窗口。</span></span><br><span class="line"><span class="comment"> *   name  指定target属性或窗口的名称。</span></span><br><span class="line"><span class="comment"> *      _blank  - 在新的窗口加载页面(默认)</span></span><br><span class="line"><span class="comment">        _parent - 在窗口中加载页面</span></span><br><span class="line"><span class="comment">        _self   - 在当前窗口中加载页面(替换)</span></span><br><span class="line"><span class="comment">        _top    - URL替换任何可加载的框架集</span></span><br><span class="line"><span class="comment">        name    - 窗口名称</span></span><br><span class="line"><span class="comment">    features  可选的字符串，声明了新窗口要显示的标准浏览器的特征</span></span><br><span class="line"><span class="comment">    replace   可选的布尔值，设置浏览历史的处理(true表示替换当前条目，false表示新建条目)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="comment">/*01-打开空白窗口*/</span></span><br><span class="line"> <span class="built_in">window</span>.open();</span><br><span class="line"></span><br><span class="line"> <span class="comment">/*02-打开新的标签页，加载www.wendingding.com站点*/</span></span><br><span class="line"> <span class="built_in">window</span>.open(<span class="string">"http://www.wendingding.com"</span>);</span><br><span class="line"></span><br><span class="line"> <span class="comment">/*03-打开新的窗口并控制窗口的外观*/</span></span><br><span class="line"> <span class="comment">//toolbar     浏览器工具栏是否显示</span></span><br><span class="line"> <span class="comment">//location    是否显示地址字段</span></span><br><span class="line"> <span class="comment">//directories 是否添加目录按钮(IE)</span></span><br><span class="line"> <span class="comment">//status      是否添加状态栏</span></span><br><span class="line"> <span class="comment">//menubar     是否显示菜单栏</span></span><br><span class="line"> <span class="comment">//scrollbars  是否显示滚动条</span></span><br><span class="line"> <span class="comment">//resizable   窗口是否可调节尺寸</span></span><br><span class="line"> <span class="comment">//width       窗口的宽度</span></span><br><span class="line"> <span class="comment">//height      窗口的高度</span></span><br><span class="line"> <span class="built_in">window</span>.open(<span class="string">"http://www.wendingding.com"</span>,<span class="string">"_blank"</span>,<span class="string">"toolbar=yes, location=yes, "</span> +</span><br><span class="line">  <span class="string">"directories=no, status=no, menubar=yes, scrollbars=yes, "</span> +</span><br><span class="line">   <span class="string">"resizable=no,width=400, height=400"</span>);</span><br><span class="line"> </span><br><span class="line"> <span class="comment">/*04-关闭当前窗口*/</span></span><br><span class="line"> <span class="built_in">window</span>.close();</span><br><span class="line"> </span><br><span class="line"> <span class="comment">/*05-该方法用来调出打印窗口*/</span></span><br><span class="line"> <span class="built_in">window</span>.print();</span><br></pre></td></tr></table></figure></p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#666">系统弹框</span></p><p><span class="spaceX" style="width:100px">alert( ) </span>             弹出对话框(确定)<br><span class="spaceX" style="width:100px">confirm( )</span>           弹出警告框，返回布尔值（确定&amp;取消）<br><span class="spaceX" style="width:100px">prompt( ) </span>    弹出输入框，返回消息或 null<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//console.log(alert("确定"));             /*提示框 该方法没有返回值*/</span></span><br><span class="line"><span class="comment">//console.log(confirm("确定删除吗?"));;    /*警示窗 确定返回true,取消返回false*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> res = prompt(<span class="string">"好汉请留下尊姓大名"</span>,<span class="string">"座山雕"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//如果点击了取消那么就返回null</span></span><br><span class="line"><span class="comment">//如果点击了确定那么就返回输入框的内容</span></span><br><span class="line"><span class="built_in">console</span>.log(res);</span><br></pre></td></tr></table></figure></p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#666">window的 history 对象</span></p><p>window对象中有一个<code>history</code>属性，它本身也是一个对象保存着网页的历史记录(从窗口打开时计算)。出于安全方面的考虑，开发人员无法得知用户浏览过的URL详情，但却可以利用<code>history</code>对象来实现前进和后退的功能。</p><p><code>history</code>对象通过内部的<code>length</code>属性来记录浏览历史的数量，该数据包含了向前和向后的所有浏览记录，默认加载到窗口的第一个页面其<code>history.length</code>的值为0。</p><p><span class="spaceX" style="width:100px">go( ) </span>             跳转到任意的浏览历史记录，负数表示后退。<br><span class="spaceX" style="width:100px">back( )</span>           后退一页<br><span class="spaceX" style="width:100px">forward( ) </span>       前进一页<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*方法演示  下面代码中的window前缀可以省略*/</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.history.length);   <span class="comment">//获取历史记录长度</span></span><br><span class="line"><span class="built_in">window</span>.history.go(<span class="number">1</span>);                 <span class="comment">//前进1页</span></span><br><span class="line"><span class="built_in">window</span>.history.go(<span class="number">-1</span>);                <span class="comment">//后退1页</span></span><br><span class="line"><span class="built_in">window</span>.history.back();                <span class="comment">//回退</span></span><br><span class="line"><span class="built_in">window</span>.history.forward();            <span class="comment">//前进</span></span><br></pre></td></tr></table></figure></p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#666">window的事件补充</span></p><p><code>onresize</code> 事件会在窗口大小调整的时候被触发。<br><code>onscroll</code> 事件在页面滚动条滚动的时候会被触发。<br><code>onload</code> 事件会在页面加载完成(HTML+CSS+其它资源)后触发。</p><hr><ul><li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="noopener">花田半亩</a></li><li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="noopener">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li><li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;tip&quot;&gt;本文介绍BOM相关的知识点，介绍的重点在于BOM核心Window对象的成员细节。&lt;/div&gt;

&lt;p class=&quot;titleX&quot;&gt;&lt;strong&gt;BOM简单介绍&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://github
      
    
    </summary>
    
    
      <category term="javaScript系列" scheme="https://weibo.com/u/3800117445/tags/javaScript%E7%B3%BB%E5%88%97/"/>
    
  </entry>
  
  <entry>
    <title>javaScript系列 [25]-Date</title>
    <link href="https://weibo.com/u/3800117445/2019/04/17/javaScript%E7%B3%BB%E5%88%97%20%5B25%5D-JavaScript%E7%9A%84Date%E5%AF%B9%E8%B1%A1/"/>
    <id>https://weibo.com/u/3800117445/2019/04/17/javaScript系列 [25]-JavaScript的Date对象/</id>
    <published>2019-04-16T16:22:18.000Z</published>
    <updated>2019-06-11T01:32:07.269Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://github.com/flowerField/Source/blob/master/Blog/time_05.jpeg?raw=true" height="200px"></p><div class="tip">本文介绍JavaScript中的内置对象Date，时间相关的基本常识，以及Date的常用方法，此外还简单介绍了定时器的相关知识点。</div><p class="titleX"><strong>日期类型Date简单介绍</strong></p><p><a href="">Date对象</a>是JavaScript语言中内置的数据类型，日期实例对象通常都通过Date构造函数来创建。</p><p>[Date对象]相关的方法非常多，但总体来说这些方法大概可以分成两类，即对( 日期 )时间进行设置和读取操作，具体的操作则会涉及到时间的<code>年-月-日 时-分-秒-毫秒以及星期</code>等维度。因为在编码中操作的时间可能是本地时间或<a href="">UTC世界时间(GMT)</a>，因此Date对象几乎提供了两套相同用处的方法( <code>方法名中有UTC的表示操作的是世界时间，没有UTC的表示操作的是本地时间</code> )。</p><p>本文会先简单列出Date对象的相关方法，然后再具体讲解日期对象的创建、开发中常见的处理场景以及核心方法的使用。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.dir(<span class="built_in">Date</span>) </span><br><span class="line">ƒ <span class="built_in">Date</span>()</span><br><span class="line">    UTC: ƒ UTC()                  <span class="comment">/*将Date转换为毫秒格式 参照1970-01-01午夜(GMT)*/</span></span><br><span class="line">    <span class="built_in">arguments</span>: (...)</span><br><span class="line">    caller: (...)</span><br><span class="line">    length: <span class="number">7</span>                     <span class="comment">/*Date构造函数的形参个数*/</span></span><br><span class="line">    name: <span class="string">"Date"</span>                  <span class="comment">/*Date构造函数的名字*/</span></span><br><span class="line">    now: ƒ now()                  <span class="comment">/*以毫秒形式返回当前时间*/</span></span><br><span class="line">    parse: ƒ parse()              <span class="comment">/*解析一个日期/时间字符串*/</span></span><br><span class="line">    prototype:                    <span class="comment">/*Date构造函数原型对象的成员*/</span></span><br><span class="line">        <span class="keyword">constructor</span>: ƒ Date()</span><br><span class="line">        getDate: ƒ getDate()                      /*返回日期值*/</span><br><span class="line">        getDay: ƒ getDay()                        /*返回星期值*/</span><br><span class="line">        getFullYear: ƒ getFullYear()              /*返回年份值*/</span><br><span class="line">        getHours: ƒ getHours()                    /*返回小时值*/</span><br><span class="line">        getMilliseconds: ƒ getMilliseconds()      /*返回毫秒值*/</span><br><span class="line">        getMinutes: ƒ getMinutes()                /*返回分钟值*/</span><br><span class="line">        getMonth: ƒ getMonth()                    /*返回月份值*/</span><br><span class="line">        getSeconds: ƒ getSeconds()                /*返回秒钟值*/</span><br><span class="line">        getTime: ƒ getTime()                      /*返回时间戳(毫秒形式的时间)*/</span><br><span class="line">        getTimezoneOffset: ƒ getTimezoneOffset()  /*返回与GMT的时间差*/</span><br><span class="line">        getUTCDate: ƒ getUTCDate()                /*返回日期值(全球时间)*/</span><br><span class="line">        getUTCDay: ƒ getUTCDay()                  /*返回星期值(全球时间)*/</span><br><span class="line">        getUTCFullYear: ƒ getUTCFullYear()        /*返回年份值(全球时间)*/</span><br><span class="line">        getUTCHours: ƒ getUTCHours()              /*返回小时值(全球时间)*/</span><br><span class="line">        getUTCMilliseconds: ƒ getUTCMilliseconds()/*返回毫秒值(全球时间)*/</span><br><span class="line">        getUTCMinutes: ƒ getUTCMinutes()          /*返回分钟值(全球时间)*/</span><br><span class="line">        getUTCMonth: ƒ getUTCMonth()              /*返回月份值(全球时间)*/</span><br><span class="line">        getUTCSeconds: ƒ getUTCSeconds()          /*返回秒钟值(全球时间)*/</span><br><span class="line">        getYear: ƒ getYear()                      /*返回年份值 = 当前年份-1900*/</span><br><span class="line">        setDate: ƒ setDate()                      /*设置日期*/</span><br><span class="line">        setFullYear: ƒ setFullYear()              /*设置年份、可选的月份和日期*/</span><br><span class="line">        setHours: ƒ setHours()                    /*设置时间的小时，可选的分钟、秒以及毫秒*/</span><br><span class="line">        setMilliseconds: ƒ setMilliseconds()      /*设置时间的毫秒值*/</span><br><span class="line">        setMinutes: ƒ setMinutes()                /*设置时间的分钟、可选的秒钟以及毫秒*/</span><br><span class="line">        setMonth: ƒ setMonth()                    /*设置时间的月份和日期*/</span><br><span class="line">        setSeconds: ƒ setSeconds()                /*设置时间的秒钟和可选的毫秒*/</span><br><span class="line">        setTime: ƒ setTime()                      /*使用毫秒值来设置时间*/</span><br><span class="line">        setUTCDate: ƒ setUTCDate()                /*设置日期值(全球时间)*/</span><br><span class="line">        setUTCFullYear: ƒ setUTCFullYear()        /*设置年，可选的月份和日期(全球时间)*/</span><br><span class="line">        setUTCHours: ƒ setUTCHours()              /*设置小时，可选的分钟、秒钟和毫秒(全球时间)*/</span><br><span class="line">        setUTCMilliseconds: ƒ setUTCMilliseconds()/*设置毫秒值(全球时间)*/</span><br><span class="line">        setUTCMinutes: ƒ setUTCMinutes()          /*设置分钟、可选的秒钟和毫秒(全球时间)*/</span><br><span class="line">        setUTCMonth: ƒ setUTCMonth()              /*设置月份和日期(全球时间)*/</span><br><span class="line">        setUTCSeconds: ƒ setUTCSeconds()          /*设置秒钟和毫秒(全球时间)*/</span><br><span class="line">        setYear: ƒ setYear()                      /*设置年份*/</span><br><span class="line">        toDateString: ƒ toDateString()            /*以字符串的形式返回日期*/</span><br><span class="line">        toGMTString: ƒ toUTCString()              /*转换为全球时间表示的字符串*/</span><br><span class="line">        toISOString: ƒ toISOString()              /*转换为ISO-8601格式的字符串*/</span><br><span class="line">        toJSON: ƒ toJSON()                        /*JSON序列化日期对象*/</span><br><span class="line">        toLocaleDateString: ƒ toLocaleDateString()/*返回本地格式的日期字符*/</span><br><span class="line">        toLocaleString: ƒ toLocaleString()        /*转换为本地格式的字符串*/</span><br><span class="line">        toLocaleTimeString: ƒ toLocaleTimeString()/*转换为本地格式表示的Date时间部分*/</span><br><span class="line">        toString: ƒ toString()                    /*转换为字符串*/</span><br><span class="line">        toTimeString: ƒ toTimeString()            /*以字符串形式返回date的时间部分*/</span><br><span class="line">        toUTCString: ƒ toUTCString()              /*转换为字符串(全球时间)*/</span><br><span class="line">        valueOf: ƒ valueOf()                      /*获取日期的时间戳 等价于getTime()*/</span><br><span class="line">        Symbol(Symbol.toPrimitive): ƒ [Symbol.toPrimitive]()</span><br><span class="line">        __proto__: Object</span><br><span class="line">    __proto__: ƒ ()</span><br><span class="line">    [[Scopes]]: Scopes[0]</span><br></pre></td></tr></table></figure><p><div class="titleX"><strong>日期类型Date的基本使用</strong></div><br><span style="border:1px solid #ccc;padding:2px 10px;color:#fff;background:#F95">创建Date实例对象</span></p><p>通常我们使用构造函数Date来获取日期(时间)实例对象，在调用构造函数的时候有多种传参方式。</p><p><code>new Date()</code>             根据当前时间来创建Date实例。<br><code>new Date(milliseconds)</code> 根据 <a href="">时间戳</a> (毫秒计数的纯数字)来创建Date实例。<br><code>new Date(dateString)</code>   根据特殊格式的日期字符串也能创建Date实例。<br><code>new Date(year,month,[day],[hours],[minutes],[seconds],[ms])</code> 根据年月日时分秒来创建实例。 </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*日期Date实例的创建的N种方式*/</span></span><br><span class="line"><span class="comment">/*01-获取当前时间*/</span></span><br><span class="line"><span class="keyword">var</span> time1 = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/*02-根据时间戳来创建Date对象*/</span></span><br><span class="line"><span class="keyword">var</span> milliseconds = time1.getTime();</span><br><span class="line"><span class="keyword">var</span> time2 = <span class="keyword">new</span> <span class="built_in">Date</span>(milliseconds);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*03-传入7个参数(年月日时分秒和毫秒创建)*/</span></span><br><span class="line"><span class="keyword">var</span> time3 = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">2019</span>,<span class="number">5</span>,<span class="number">20</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*04-根据固定格式的日期字符串来创建*/</span></span><br><span class="line"><span class="keyword">var</span> dateString1 = <span class="string">"2019-09-01"</span>;</span><br><span class="line"><span class="keyword">var</span> dateString2 = <span class="string">"2019/09/02"</span>;</span><br><span class="line"><span class="keyword">var</span> dateString3 = <span class="string">"October 13, 1975 11:13:00"</span>;</span><br><span class="line"><span class="keyword">var</span> time4 = <span class="keyword">new</span> <span class="built_in">Date</span>(dateString1);</span><br><span class="line"><span class="keyword">var</span> time5 = <span class="keyword">new</span> <span class="built_in">Date</span>(dateString2);</span><br><span class="line"><span class="keyword">var</span> time6 = <span class="keyword">new</span> <span class="built_in">Date</span>(dateString3)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*05-Date在调用的时候可以缺省new关键字*/</span></span><br><span class="line"><span class="keyword">var</span> time7 = <span class="built_in">Date</span>();     <span class="comment">//获取的是当前的时间</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*日期对象中包含的信息主要有：年、月、日、时、分、秒、毫秒、星期和时区*/</span></span><br><span class="line"><span class="built_in">console</span>.log(time1);     <span class="comment">//Wed Apr 17 2019 10:54:24 GMT+0800 (中国标准时间)</span></span><br><span class="line"><span class="built_in">console</span>.log(time2);     <span class="comment">//Wed Apr 17 2019 10:54:24 GMT+0800 (中国标准时间)</span></span><br><span class="line"><span class="built_in">console</span>.log(time3);     <span class="comment">//Thu Jun 20 2019 01:03:01 GMT+0800 (中国标准时间)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(time4);     <span class="comment">//Sun Sep 01 2019 08:00:00 GMT+0800 (中国标准时间)</span></span><br><span class="line"><span class="built_in">console</span>.log(time5);     <span class="comment">//Mon Sep 02 2019 00:00:00 GMT+0800 (中国标准时间)</span></span><br><span class="line"><span class="built_in">console</span>.log(time6);     <span class="comment">//Mon Oct 13 1975 11:13:00 GMT+0800 (中国标准时间)</span></span><br><span class="line"><span class="built_in">console</span>.log(time7);     <span class="comment">//Wed Apr 17 2019 11:04:59 GMT+0800 (中国标准时间)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*把本地时间转换为GMT全球时间格式打印*/</span></span><br><span class="line">time5.toUTCString();    <span class="comment">//"Sun, 01 Sep 2019 16:00:00 GMT"</span></span><br></pre></td></tr></table></figure><p><span style="border:1px solid #ccc;padding:2px 10px;color:#fff;background:#F95">获取并格式化时间</span></p><p>在开发中我们经常需要以特定的格式来表示时间，譬如<code>2008-08-08 08：08：08</code> 或者是<code>2008/08/08</code>。其实参考上文的代码，我们发现Date对象为我们提供了一大堆方法来获取Date实例中具体的年月日时分秒等数值，通过调用这些方法我们可以把日期格式化成任何我们想要的形式。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*01-获取当前的Date时间对象*/</span></span><br><span class="line"><span class="keyword">var</span> date  = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/*02-获取具体的每个值*/</span></span><br><span class="line"><span class="keyword">var</span> year  = date.getFullYear();       <span class="comment">/*年*/</span></span><br><span class="line"><span class="keyword">var</span> month = date.getMonth()+<span class="number">1</span>;        <span class="comment">/*月*/</span></span><br><span class="line"><span class="keyword">var</span> day   = date.getDate();           <span class="comment">/*日*/</span></span><br><span class="line"><span class="keyword">var</span> hour  = date.getHours();          <span class="comment">/*时*/</span></span><br><span class="line"><span class="keyword">var</span> min   = date.getMinutes();        <span class="comment">/*分*/</span></span><br><span class="line"><span class="keyword">var</span> sec   = date.getSeconds();        <span class="comment">/*秒*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*03-按照固定的格式拼接*/</span></span><br><span class="line"><span class="keyword">var</span> res = year + <span class="string">'-'</span> + month + <span class="string">'-'</span> + day + <span class="string">' '</span> + hour + <span class="string">':'</span> + min + <span class="string">':'</span> + sec;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*2019-4-17 11:31:18*/</span></span><br><span class="line"><span class="built_in">console</span>.log(res);</span><br></pre></td></tr></table></figure><p> 在上面的代码中，我们把当前的日期对象转换成了固定格式的字符串<code>2019-4-17 11:31:18</code>，其实除了像上面那样拼接外我们还可以简单的通过数组的<code>join()</code>方法来执行格式化操作。此外，有时候我们可能需要保证年月日时分秒等占两位，即上面的时间应该表示为<code>2019-04-17 11:31:18</code>，那么可能还需要对某些数据执行 <a href="">补零操作</a>。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*00-封装补零的方法*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">prefixInteger</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (<span class="built_in">Array</span>(<span class="number">2</span>).join(<span class="string">'0'</span>) + num).slice(<span class="number">-2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*01-获取当前的Date时间对象*/</span></span><br><span class="line"><span class="keyword">var</span> date  = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/*02-获取具体的每个值*/</span></span><br><span class="line"><span class="keyword">var</span> year  = date.getFullYear();       <span class="comment">/*年*/</span></span><br><span class="line"><span class="keyword">var</span> month = prefixInteger(date.getMonth()+<span class="number">1</span>);        <span class="comment">/*月*/</span></span><br><span class="line"><span class="keyword">var</span> day   = prefixInteger(date.getDate());           <span class="comment">/*日*/</span></span><br><span class="line"><span class="keyword">var</span> hour  = prefixInteger(date.getHours());          <span class="comment">/*时*/</span></span><br><span class="line"><span class="keyword">var</span> min   = prefixInteger(date.getMinutes());        <span class="comment">/*分*/</span></span><br><span class="line"><span class="keyword">var</span> sec   = prefixInteger(date.getSeconds());        <span class="comment">/*秒*/</span></span><br><span class="line"><span class="keyword">var</span> week  = date.getDay();                            <span class="comment">/*星期 0~6*/</span></span><br><span class="line"><span class="keyword">var</span> weStr = <span class="string">'日一二三四五六'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*03-按照固定的格式拼接*/</span></span><br><span class="line"><span class="keyword">var</span> arr = [];</span><br><span class="line">arr.push(year + <span class="string">"-"</span>);</span><br><span class="line">arr.push(month + <span class="string">"-"</span>);</span><br><span class="line">arr.push(day + <span class="string">" "</span>);</span><br><span class="line">arr.push(hour + <span class="string">":"</span>);</span><br><span class="line">arr.push(min + <span class="string">":"</span>);</span><br><span class="line">arr.push(sec + <span class="string">" "</span>);</span><br><span class="line">arr.push(<span class="string">"星期"</span>+ weStr[week]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> res = arr.join(<span class="string">""</span>)</span><br><span class="line"><span class="built_in">console</span>.log(res);       <span class="comment">/*2019-04-17 11:56:12 星期三*/</span></span><br></pre></td></tr></table></figure><p><span style="border:1px solid #ccc;padding:2px 10px;color:#fff;background:#F95">Date对象的常用方法</span></p><p><code>toUTCString()</code> 方法把时间转换成UTC时间。</p><p><code>Date.now()</code> 方法返回执行这行代码时距 1970-01-01 0点的毫秒数。</p><p><code>Date.parse()</code> 返回指定日期距1970-01-01 0点的毫秒数，默认支持<code>年-月-日</code>或<code>年/月/日</code>格式。</p><p><code>toLocaleDateString()</code> 方法以特定的地区格式显示年、月、日。</p><p><code>getTime() | setTime()</code> 方法用来获取 | 修改某个日期自1970年1月1日0时以来的毫秒数(时间戳)。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*获取当前时间*/</span></span><br><span class="line"><span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/*傻傻分不清楚的时间字符串*/</span></span><br><span class="line"><span class="built_in">console</span>.log(date);                     <span class="comment">//Wed Apr 17 2019 15:19:03 GMT+0800 (中国标准时间)</span></span><br><span class="line"><span class="built_in">console</span>.log(date.toDateString());       <span class="comment">//Wed Apr 17 2019</span></span><br><span class="line"><span class="built_in">console</span>.log(date.toISOString());        <span class="comment">//2019-04-17T07:19:03.303Z</span></span><br><span class="line"><span class="built_in">console</span>.log(date.toLocaleTimeString()); <span class="comment">//下午3:19:03</span></span><br><span class="line"><span class="built_in">console</span>.log(date.toLocaleDateString()); <span class="comment">//2019/4/17</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*获取时间戳*/</span></span><br><span class="line"><span class="built_in">console</span>.log(date.getTime());            <span class="comment">//1555485543303</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Date</span>.parse(<span class="string">"2008-08-08"</span>));  <span class="comment">//1218153600000</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Date</span>.parse(<span class="string">"2008/08/08"</span>));  <span class="comment">//1218124800000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*把时间戳转换为时间字符串格式*/</span></span><br><span class="line"><span class="keyword">var</span> resDate = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">Date</span>.parse(<span class="string">"2008/08/08"</span>));</span><br><span class="line"><span class="built_in">console</span>.log(resDate);                   <span class="comment">//Fri Aug 08 2008 00:00:00 GMT+0800 (中国标准时间)</span></span><br></pre></td></tr></table></figure><p><strong><code>示例</code></strong> 给定两个日期，计算它们之间间隔的天数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*01-提供两个时间(注意格式)*/</span></span><br><span class="line"><span class="keyword">var</span> start = <span class="string">"2019-04-01"</span>;</span><br><span class="line"><span class="keyword">var</span> end   = <span class="string">"2019-04-22"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*02-计算两个时间见的差值 毫秒数据*/</span></span><br><span class="line"><span class="keyword">var</span> offset = <span class="built_in">Date</span>.parse(end) - <span class="built_in">Date</span>.parse(start);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*03-把差值转换为天数*/</span></span><br><span class="line"><span class="keyword">var</span> days = <span class="built_in">Math</span>.ceil(offset/<span class="number">1000</span>/<span class="number">60</span>/<span class="number">60</span>/<span class="number">24</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*04-拼接并输出*/</span></span><br><span class="line"><span class="keyword">var</span> res = start +<span class="string">' 至 '</span>+ end + <span class="string">' 还差：'</span> + days + <span class="string">"天"</span>;</span><br><span class="line"><span class="built_in">console</span>.log(res);   <span class="comment">//2019-04-01 至 2019-04-22 还差：21天</span></span><br></pre></td></tr></table></figure><p class="titleX"><strong>定时器和延迟执行</strong></p><p>JavaScript中提供了专门的定时器和延迟执行的方法，我们简单介绍下它们的基本语法。</p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#fff;background:#F95">延迟执行函数</span></p><p><strong><code>语法</code></strong> <code>setTimeout(code,millisec)</code><br><strong><code>作用</code></strong> <code>setTimeout()</code>方法用于在指定的毫秒数后调用函数或计算表达式<br><strong><code>说明</code></strong> <code>setTimeout()</code>方法只会执行 code 一次。<br><strong><code>取消</code></strong> 当延迟执行函数启动后可以通过调用对应的<code>clearTimeOut()</code>方法传入参数来关闭定时器。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*01-延迟执行函数的基本使用*/</span></span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">"start"</span>,<span class="keyword">new</span> <span class="built_in">Date</span>());</span><br><span class="line"> setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="comment">/*1秒钟后才执行回调函数中的代码*/</span></span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">"task"</span>,<span class="keyword">new</span> <span class="built_in">Date</span>());</span><br><span class="line"> &#125;,<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">"end"</span>,<span class="keyword">new</span> <span class="built_in">Date</span>());</span><br><span class="line"></span><br><span class="line"> <span class="comment">//start Wed Apr 17 2019 14:49:38 GMT+0800 (中国标准时间)</span></span><br><span class="line"> <span class="comment">//end   Wed Apr 17 2019 14:49:38 GMT+0800 (中国标准时间)</span></span><br><span class="line"> <span class="comment">//task  Wed Apr 17 2019 14:49:39 GMT+0800 (中国标准时间)</span></span><br></pre></td></tr></table></figure><p><strong><code>示例</code></strong> 演示如果使用<code>setTimeout()</code>延迟执行函数来实现时钟的功能。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span>=<span class="string">"startTime()"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"demo"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="keyword">function</span> <span class="title">startTime</span>(<span class="params"></span>)</span></span></span><br><span class="line"><span class="undefined">  &#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">/*01-获取当前的时间*/</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>()</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">/*02-获取时分秒等信息并格式化*/</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> h    = checkTime(date.getHours());</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> m    = checkTime(date.getMinutes());</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> s    = checkTime(date.getSeconds());</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">/*03-输出到页面中显示出来*/</span></span></span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.getElementById(<span class="string">'demo'</span>).innerHTML=h+<span class="string">":"</span>+m+<span class="string">":"</span>+s</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">/*04-延迟执行 设置500毫秒后重新调用startTime方法 */</span></span></span><br><span class="line"><span class="javascript">    setTimeout(<span class="string">'startTime()'</span>,<span class="number">500</span>)</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="comment">/*用来保证时分秒占2位，不足则补零 */</span></span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="keyword">function</span> <span class="title">checkTime</span>(<span class="params">i</span>)</span></span></span><br><span class="line"><span class="undefined">  &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">if</span> (i&lt;<span class="number">10</span>) i=<span class="string">"0"</span> + i</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> i</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#fff;background:#F95">定时器函数</span></p><p><strong><code>语法</code></strong> <code>setInterval(code,millisec[,&quot;lang&quot;])</code><br><strong><code>作用</code></strong> <code>setInterval()</code>方法会按照指定的周期（以毫秒计）来调用函数或计算表达式。<br><strong><code>说明</code></strong> <code>setInterval()</code>方法会不停地调用函数，直到 clearInterval() 被调用或窗口被关闭。<br><strong><code>取消</code></strong> 当定时器开启后可以通过调用对应的<code>clearInterval()</code>方法传入参数来关闭定时器。<br><strong><code>场景</code></strong> 定时器函数常被用来处理一些需要长时间执行的重复性工作，譬如轮播图。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*开启定时器*/</span></span><br><span class="line"><span class="keyword">var</span> timer = setInterval(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"--滴答--滴答--！"</span>);</span><br><span class="line">&#125;,<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*取消定时器*/</span></span><br><span class="line"><span class="comment">// clearInterval(timer);</span></span><br><span class="line"><span class="comment">// 说明 上面的代码执行后每隔1秒就打印一次 "--滴答--滴答--！"</span></span><br></pre></td></tr></table></figure><p class="titleX"><strong>附录：时间有关的常识</strong></p><p><span class="prop" style="width:80px;background:#298;color:#fff">纪元</span> 纪元时间(<code>UNIX TIME</code>)指的是 1970-01-01 00:00:00 </p><p><span class="prop" style="width:80px;background:#295;color:#fff">GMT</span>格林尼治标准时间 (<code>Greenwich Mean Time</code>)，俗称“天文学时间”</p><p> 它根据地球的自转和公转来计算时间，也就是太阳每天经过位于英国伦敦郊区的皇家格林尼治天文台的时间就是中午12点，而地球的自转正在缓速变慢，所以时间误差比较大。<br><span class="prop" style="width:80px;background:#795;color:#fff">UTC</span> 世界协调时间 (<code>Universal Time Coordinated</code>)，又称为“原子物理时间”。</p><p>世界协调时间更加精确，50亿年才误差1秒。</p><p><span class="prop" style="width:80px;background:#198;color:#fff">闰年</span> 四年一闰，百年不闰，四百年再闰 </p><p> 闰年的作用是为了修正计时的偏差，地球绕太阳一周的准确时间是365天5小时48分46秒，用小数表示即365.24219天，为了方便我们平时计算一年使用的是365天，这样实际每年就会多出0.24219天，四年就多了一天，如果按四年年一润的算法，100年总共有25个闰年，但实际100年只多出24.219天，所以就有了百年不润的说法；因此，我们在判断闰年的法则为 <span style="color:red">① 能被4整除且不能被100整除的为闰年 ② 能被400整除的是闰年。</span></p><p><span class="prop" style="width:80px;background:#595;color:#fff">时区</span> 全球共被划分为24个时区，我们使用的是北京时间(东八区) </p><p> 为了克服时间上的混乱，1884年在华盛顿召开的一次国际经度会议（<code>国际子午线会议</code>）上，规定将全球划分为24个时区（东西各12个时区）。规定英国（格林尼治天文台旧址）为中时区（零时区）、东1-12区，西1-12区。每个时区横跨经度15度，时间正好是1小时</p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/time_06.png?raw=true" height="400px"></p><hr><ul><li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="noopener">花田半亩</a></li><li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="noopener">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li><li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://github.com/flowerField/Source/blob/master/Blog/time_05.jpeg?raw=true&quot; height=&quot;200px&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;tip&quot;&gt;本文介绍JavaScri
      
    
    </summary>
    
    
      <category term="javaScript系列" scheme="https://weibo.com/u/3800117445/tags/javaScript%E7%B3%BB%E5%88%97/"/>
    
  </entry>
  
  <entry>
    <title>javaScript系列 [24]-Math</title>
    <link href="https://weibo.com/u/3800117445/2019/04/16/javaScript%E7%B3%BB%E5%88%97%20%5B24%5D-JavaScript%E5%86%85%E7%BD%AEMath/"/>
    <id>https://weibo.com/u/3800117445/2019/04/16/javaScript系列 [24]-JavaScript内置Math/</id>
    <published>2019-04-16T15:22:17.000Z</published>
    <updated>2019-06-11T01:32:07.086Z</updated>
    
    <content type="html"><![CDATA[<div class="tip">本文介绍JavaScript中的内置对象Math，以及Math的常用方法。</div><p><img src="https://github.com/flowerField/Source/blob/master/Blog/Rafael-Araujo.jpg?raw=true" height="300px"></p><p class="titleX"><strong>Math简单介绍</strong></p><p>ECMAScript为我们提供了一个专门处理数学计算的内置对象——<a href="">Math对象</a>。Math对象提供了很多数学专业计算中可能会用到的特殊值(譬如 <code>π</code>)常量，以及封装好的工具函数(<code>譬如 求N个数最大值、最小值、随机数、绝对值、平方根以及正玄和反余值等</code>)。</p><p>这里先通过<code>console.dir()</code>方法打印Math对象的所有成员，我们可以通过下面列出的打印信息对Math对象有一个简单的了解。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.dir(<span class="built_in">Math</span>);</span><br><span class="line"><span class="built_in">Math</span></span><br><span class="line">    E: <span class="number">2.718281828459045</span>            <span class="comment">//自然对数的底数，常量e的值</span></span><br><span class="line">    LN2: <span class="number">0.6931471805599453</span>         <span class="comment">//2的自然对数</span></span><br><span class="line">    LN10: <span class="number">2.302585092994046</span>         <span class="comment">//10的自然对数</span></span><br><span class="line">    LOG2E: <span class="number">1.4426950408889634</span>       <span class="comment">//以2为底e的对数</span></span><br><span class="line">    LOG10E: <span class="number">0.4342944819032518</span>      <span class="comment">//以10为底e的对数</span></span><br><span class="line">    PI: <span class="number">3.141592653589793</span>           <span class="comment">//π的值</span></span><br><span class="line">    SQRT1_2: <span class="number">0.7071067811865476</span>     <span class="comment">//1/2的平方根(2的平方根的倒数)</span></span><br><span class="line">    SQRT2: <span class="number">1.4142135623730951</span>       <span class="comment">//2的平方根</span></span><br><span class="line">    abs: ƒ abs()                    <span class="comment">//求参数的绝对值</span></span><br><span class="line">    acos: ƒ acos()                  <span class="comment">//返回参数的反余弦值</span></span><br><span class="line">    acosh: ƒ acosh()                </span><br><span class="line">    asin: ƒ asin()                  <span class="comment">//返回参数的反正玄值</span></span><br><span class="line">    asinh: ƒ asinh()          </span><br><span class="line">    atan: ƒ atan()                  <span class="comment">//返回参数的反正切值</span></span><br><span class="line">    atan2: ƒ atan2()                <span class="comment">//Math.atan2(y,x) 返回y/x的反正切值</span></span><br><span class="line">    atanh: ƒ atanh()          </span><br><span class="line">    cbrt: ƒ cbrt()                  </span><br><span class="line">    ceil: ƒ ceil()                  <span class="comment">//执行向上舍入(将数值向上舍入为最接近的整数)</span></span><br><span class="line">    clz32: ƒ clz32()</span><br><span class="line">    cos: ƒ cos()                    <span class="comment">//返回参数余弦值</span></span><br><span class="line">    cosh: ƒ cosh()    </span><br><span class="line">    exp: ƒ exp()                    <span class="comment">//返回Math.E的参数次幂</span></span><br><span class="line">    expm1: ƒ expm1()</span><br><span class="line">    floor: ƒ floor()                <span class="comment">//执行向下舍入(将数值向下舍入为最接近的整数)</span></span><br><span class="line">    fround: ƒ fround()</span><br><span class="line">    hypot: ƒ hypot()</span><br><span class="line">    imul: ƒ imul()</span><br><span class="line">    log: ƒ log()                    <span class="comment">//返回参数的自然对数</span></span><br><span class="line">    log1p: ƒ log1p()</span><br><span class="line">    log2: ƒ log2()</span><br><span class="line">    log10: ƒ log10()</span><br><span class="line">    max: ƒ max()                    <span class="comment">//返回参数列表中的最大值</span></span><br><span class="line">    min: ƒ min()                    <span class="comment">//返回参数列表中的最小值</span></span><br><span class="line">    pow: ƒ pow()                    <span class="comment">//Math.pow(n,p) 返回n的p次幂</span></span><br><span class="line">    random: ƒ random()              <span class="comment">//返回0~1之间的随机数</span></span><br><span class="line">    round: ƒ round()                <span class="comment">//执行标准的舍入(数学意义的舍入规则)</span></span><br><span class="line">    sign: ƒ sign()</span><br><span class="line">    sin: ƒ sin()                    <span class="comment">//返回参数的正弦值</span></span><br><span class="line">    sinh: ƒ sinh()                  </span><br><span class="line">    sqrt: ƒ sqrt()                  <span class="comment">//返回参数的平方根</span></span><br><span class="line">    tan: ƒ tan()                    <span class="comment">//返回参数的正切值</span></span><br><span class="line">    tanh: ƒ tanh()</span><br><span class="line">    trunc: ƒ trunc()</span><br><span class="line">    <span class="built_in">Symbol</span>(<span class="built_in">Symbol</span>.toStringTag): <span class="string">"Math"</span></span><br><span class="line">    __proto__: <span class="built_in">Object</span></span><br></pre></td></tr></table></figure><p class="titleX"><strong>Math常用方法</strong></p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/js_base34.png?raw=true"></p><p><code>Math.abs()</code>方法返回参数值的绝对值。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.abs(<span class="number">16</span>));              <span class="comment">//16</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.abs(<span class="number">-6</span>));              <span class="comment">//6</span></span><br></pre></td></tr></table></figure></p><p><code>Math.max()</code>方法返回参数之中最大的那个值，<code>Math.min()</code>返回参数列表中最小的那个值。如果参数为空, Math.min返回Infinity, Math.max返回-Infinity。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*01-求参数列表的最大值和最小值*/</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.max(<span class="number">2</span>, <span class="number">-1</span>, <span class="number">5</span>, <span class="number">18</span>));    <span class="comment">// 18</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.min(<span class="number">2</span>, <span class="number">-1</span>, <span class="number">5</span>, <span class="number">21</span>));    <span class="comment">// -1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*02-测试参数列表为空的情况*/</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.min());                <span class="comment">// Infinity</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.max());                <span class="comment">// -Infinity</span></span><br></pre></td></tr></table></figure></p><p><code>Math.pow(x,y)</code>方法返回以第一个参数为底数、第二个参数为幂的指数值，即求x的y次幂。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.pow(<span class="number">2</span>,<span class="number">3</span>));   <span class="comment">//8     2的3次幂</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.pow(<span class="number">2</span>,<span class="number">-1</span>));  <span class="comment">//0.5   2的-1次幂 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*计算 圆的面积 = πr的平方*/</span></span><br><span class="line"><span class="keyword">var</span> radius = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">var</span> area = <span class="built_in">Math</span>.PI * <span class="built_in">Math</span>.pow(radius, <span class="number">2</span>);</span><br></pre></td></tr></table></figure></p><p><code>Math.round</code>方法用于执行四舍五入操作。<br><code>Math.ceil()</code>方法用于返回大于参数值的最小整数（天花板值）。<br><code>Math.floor()</code>方法用于返回大于参数值的最大整数（地板值）。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*01-Math.round() 执行正常的四舍五入操作*/</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.round(<span class="number">0.1</span>));     <span class="comment">// 0</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.round(<span class="number">0.5</span>));     <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.round(<span class="number">0.6</span>));     <span class="comment">// 1</span></span><br><span class="line"><span class="comment">/*负值的处理*/</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.round(<span class="number">-1.1</span>));    <span class="comment">// -1</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.round(<span class="number">-1.5</span>));    <span class="comment">// -1 注意特殊情况</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.round(<span class="number">-1.7</span>));    <span class="comment">// -2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*02-Math.ceil() 大于参数值的最小整数*/</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.ceil(<span class="number">3.1</span>));      <span class="comment">// 4</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.ceil(<span class="number">3.5</span>));      <span class="comment">// 4</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.ceil(<span class="number">3.9</span>));      <span class="comment">// 4</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.ceil(<span class="number">-3.1</span>));     <span class="comment">//-3</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.ceil(<span class="number">-3.5</span>));     <span class="comment">//-3</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.ceil(<span class="number">-3.9</span>));     <span class="comment">//-3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*03-Math.floor() 小于参数值的最大整数*/</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.floor(<span class="number">3.1</span>));     <span class="comment">// 3</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.floor(<span class="number">3.5</span>));     <span class="comment">// 3</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.floor(<span class="number">3.9</span>));     <span class="comment">// 3</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.floor(<span class="number">-3.1</span>));    <span class="comment">//-4</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.floor(<span class="number">-3.5</span>));    <span class="comment">//-4</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.floor(<span class="number">-3.9</span>));    <span class="comment">//-4</span></span><br></pre></td></tr></table></figure><p><code>Math.sqrt()</code>方法返回参数值的平方根，如果参数是一个负值，则返回NaN。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.sqrt(<span class="number">4</span>));          <span class="comment">//2</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.sqrt(<span class="number">-4</span>));         <span class="comment">//NaN</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.sqrt(<span class="number">9</span>));          <span class="comment">//3</span></span><br></pre></td></tr></table></figure></p><p><code>Math.random()</code>方法返回0到1之间的一个伪随机数，取值区间为<code>[ 0 , 1 )</code> 。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.random());   <span class="comment">//0.6260459147033315</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.random());   <span class="comment">//0.5273094529873636</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*封装两个生成随机数的方法*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRandom</span>(<span class="params">min, max</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.random() * (max - min) + min;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRandomInt</span>(<span class="params">min, max</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * (max - min + <span class="number">1</span>)) + min;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">getRandom(<span class="number">1</span>, <span class="number">8</span>)         <span class="comment">// 6.919178146646834</span></span><br><span class="line">getRandomInt(<span class="number">1</span>, <span class="number">8</span>)      <span class="comment">// 5</span></span><br><span class="line"><span class="comment">/*如果需要对结果取整，那么使用Math.floor或者是parseInt函数处理*/</span></span><br></pre></td></tr></table></figure></p><p>Math对象除了上述工具函数外，还提供一系列的三角函数方法。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Math.sin()：返回参数的正弦      （参数为弧度值）</span></span><br><span class="line"><span class="comment">//Math.cos()：返回参数的余弦      （参数为弧度值）</span></span><br><span class="line"><span class="comment">//Math.tan()：返回参数的正切      （参数为弧度值）</span></span><br><span class="line"><span class="comment">//Math.asin()：返回参数的反正弦   （返回值为弧度值）</span></span><br><span class="line"><span class="comment">//Math.acos()：返回参数的反余弦   （返回值为弧度值）</span></span><br><span class="line"><span class="comment">//Math.atan()：返回参数的反正切   （返回值为弧度值）</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.sin(<span class="number">0</span>));              <span class="comment">// 0</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.cos(<span class="number">0</span>));              <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.tan(<span class="number">0</span>));              <span class="comment">// 0</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.sin(<span class="built_in">Math</span>.PI / <span class="number">2</span>));    <span class="comment">// 1</span></span><br></pre></td></tr></table></figure></p><hr><ul><li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="noopener">花田半亩</a></li><li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="noopener">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li><li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;tip&quot;&gt;本文介绍JavaScript中的内置对象Math，以及Math的常用方法。&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;https://github.com/flowerField/Source/blob/master/Blog/Rafael-Ara
      
    
    </summary>
    
    
      <category term="javaScript系列" scheme="https://weibo.com/u/3800117445/tags/javaScript%E7%B3%BB%E5%88%97/"/>
    
  </entry>
  
  <entry>
    <title>javaScript系列 [23]-基本包装类型</title>
    <link href="https://weibo.com/u/3800117445/2019/04/16/javaScript%E7%B3%BB%E5%88%97%20%5B23%5D-JavaScript%E5%8C%85%E8%A3%85%E7%B1%BB%E5%9E%8B/"/>
    <id>https://weibo.com/u/3800117445/2019/04/16/javaScript系列 [23]-JavaScript包装类型/</id>
    <published>2019-04-16T15:22:16.000Z</published>
    <updated>2019-06-11T01:32:07.331Z</updated>
    
    <content type="html"><![CDATA[<div class="tip">本文主要介绍JavaScript中的基本包装类型以及使用注意点。</div><p class="titleX"><strong>基本包装类型介绍</strong></p><blockquote><p><strong>基本(简单)数据类型</strong> <code>字符串 + 数值 + null + undefined + 布尔值</code></p></blockquote><p>为了便于操作基本类型，ECMAScript提供了三个特殊的引用类型：<code>Boolean</code>、<code>Number</code>以及<code>String</code>类型，它们的结构与其他的引用类型(<code>譬如 Array Object</code>)类似。它们具备与各自的基本类型相应的特殊行为，每当我们读取一个基本类型的值的时候，后台就会创建一个对应的基本包装类型对象，从而让我们能够调用一些方法来操作这些数据。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'测试字符串'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(str.length);            <span class="comment">//5</span></span><br><span class="line"><span class="built_in">console</span>.log(str.substring(<span class="number">2</span>));      <span class="comment">//字符串</span></span><br></pre></td></tr></table></figure></p><p>在这里我们需要思考一个非常严肃而重要的问题 ，那就是<span style="color:#f03">属性和方法本是对象的特征，字符串如何能够拥有 <code>length</code>属性以及其他类似 <code>subString</code>等方法，内部怎么实现的？</span> </p><p><img src="https://github.com/flowerField/Source/blob/master/Blog/wenhao.png?raw=true" height="150px" style="margin=20px"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> 我们知道基本类型值它们本身并不是对象，因此从逻辑上讨论他们不应该有属性和方法。</span><br><span class="line"> 它们能够访问属性和方法的原理是在执行相关代码的时候，内部会执行下面的操作：</span><br><span class="line"> </span><br><span class="line">（1）创建String类型的一个实例对象</span><br><span class="line">（2）在实例对象上面读取指定的属性（length）,调用指定的方法（subString）</span><br><span class="line">（3）销毁该对象</span><br></pre></td></tr></table></figure><p class="titleX"><strong>基本包装类型的成员</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*01-创建Number类型的对象*/</span> </span><br><span class="line"><span class="keyword">var</span> num = <span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*02-创建String类型的对象*/</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">'hello World'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*03-创建Boolean类型的对象*/</span></span><br><span class="line"><span class="keyword">var</span> bool = <span class="keyword">new</span> <span class="built_in">Boolean</span>(<span class="literal">true</span>);</span><br></pre></td></tr></table></figure><p><span class="prop" style="width:200px">String</span> String 是与字符串(<code>string</code>)相对应的对象类型。<br><span class="prop" style="width:200px">Number</span> Number 是与数字值(<code>number</code>)相对应的对象类型。<br><span class="prop" style="width:200px">Boolean</span> Boolean 是与布尔值(<code>boolean</code>)相对应的对象类型。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//001 String</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">'测试字符串'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(str.length);            <span class="comment">//5</span></span><br><span class="line"><span class="built_in">console</span>.log(str.substring(<span class="number">2</span>));      <span class="comment">//字符串</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//002 Number</span></span><br><span class="line"><span class="keyword">var</span> num = <span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">10</span>);</span><br><span class="line"><span class="built_in">console</span>.log(num);                   <span class="comment">//Number &#123;[[PrimitiveValue]]: 10&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> num);            <span class="comment">//object</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="number">10</span>);             <span class="comment">//number</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//003 Boolean</span></span><br><span class="line"><span class="keyword">var</span> bool = <span class="keyword">new</span> <span class="built_in">Boolean</span>(<span class="literal">true</span>);</span><br><span class="line"><span class="built_in">console</span>.log(bool);                  <span class="comment">//Boolean &#123;[[PrimitiveValue]]: true&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> bool);           <span class="comment">//object</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="literal">true</span>);           <span class="comment">//boolean</span></span><br></pre></td></tr></table></figure><p class="titleX"><strong>基本包装类型的注意点</strong></p><p><span style="border:1px solid #ccc;padding:2px 10px;color:#666">① 区分对象和基本值</span></p><p><strong><code>对象</code></strong> 通过 new 调用构造函数(String、Boolean和Number)创建出来的是对象。<br><strong><code>基本值</code></strong> 直接通过字面量方式赋值 或者 通过省略new关键字直接调用构造函数方式创建的基本值。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">var</span> str1 = <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">'hello'</span>);</span><br><span class="line"> <span class="keyword">var</span> str2 = <span class="string">'hello'</span>;</span><br><span class="line"> <span class="keyword">var</span> str3 = <span class="built_in">String</span>(<span class="string">'hello'</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*说明：str1是对象，而str2和str3是字符串（基本数据类型值）*/</span></span><br></pre></td></tr></table></figure><p><span style="border:1px solid #ccc;padding:2px 10px;color:#666">② 相等问题</span></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str1 = <span class="string">'这是一个字符串'</span>;               <span class="comment">//基本数据类型</span></span><br><span class="line"><span class="keyword">var</span> str2 = <span class="built_in">String</span>(<span class="string">'这是一个字符串'</span>);       <span class="comment">//基本数据类型</span></span><br><span class="line"><span class="built_in">console</span>.log(str1 == str2);              <span class="comment">//true 相等</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> str3 = <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">'这是一个字符串'</span>);   <span class="comment">//引用类型-对象</span></span><br><span class="line"><span class="built_in">console</span>.log(str1 == str3);    <span class="comment">//true    //值相等</span></span><br><span class="line"><span class="built_in">console</span>.log(str2 == str3);    <span class="comment">//true    //值相等</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(str1 === str3);    <span class="comment">//false  //值相等,但是引用不相等</span></span><br><span class="line"><span class="built_in">console</span>.log(str2 === str3);    <span class="comment">//false  //值相等,但是引用不相等</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*判断下面的变量是否相等*/</span></span><br><span class="line"><span class="keyword">var</span> num1 = <span class="number">10</span>;                          <span class="comment">//基本数据类型</span></span><br><span class="line"><span class="keyword">var</span> num2 = <span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">10</span>);              <span class="comment">//对象</span></span><br><span class="line"><span class="built_in">console</span>.log(num1 == num2);              <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(num1 ===  num2);            <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> bool1 = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">var</span> bool2 = <span class="keyword">new</span> <span class="built_in">Boolean</span>(<span class="literal">true</span>);</span><br><span class="line"><span class="built_in">console</span>.log(bool1 == bool2);            <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(bool1 === bool2);           <span class="comment">//false</span></span><br></pre></td></tr></table></figure><p><span class="prop" style="width:200px">基本类型值相等</span> =&gt; <strong><code>值相等</code></strong><br><span class="prop" style="width:200px">引用类型值相等</span>  =&gt; <strong><code>值相等且引用相等</code></strong></p><p class="tip">对象是引用类型，因此在判断相等的时候有诸多的注意点和容易出错的地方。</p><hr><ul><li>Posted by 博客园·<a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a> | <a href="http://wendingding.com" target="_blank" rel="noopener">花田半亩</a></li><li>联系作者 简书·<a href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles" target="_blank" rel="noopener">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&amp;mod=TAB#place">Coder_文顶顶</a></li><li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://www.cnblogs.com/wendingding/" target="_blank" rel="noopener">文顶顶</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;tip&quot;&gt;本文主要介绍JavaScript中的基本包装类型以及使用注意点。&lt;/div&gt;

&lt;p class=&quot;titleX&quot;&gt;&lt;strong&gt;基本包装类型介绍&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;基本(简单)数据类型
      
    
    </summary>
    
    
      <category term="javaScript系列" scheme="https://weibo.com/u/3800117445/tags/javaScript%E7%B3%BB%E5%88%97/"/>
    
  </entry>
  
</feed>
